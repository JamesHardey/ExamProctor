{"file_contents":{"client/src/pages/candidate/exam-wrapper.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useRoute } from \"wouter\";\nimport PreExamCheck from \"./pre-exam-check\";\nimport ExamSession from \"./exam-session\";\nimport ExamResults from \"./exam-results\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Candidate } from \"@shared/schema\";\n\ntype ExamStage = \"pre-check\" | \"session\" | \"results\";\n\nexport default function ExamWrapper() {\n  const [, params] = useRoute(\"/exam/:candidateId\");\n  const candidateId = params?.candidateId ? parseInt(params.candidateId) : 0;\n  const { toast } = useToast();\n  \n  const { data: candidate, isLoading: isCandidateLoading, error: candidateError } = useQuery<Candidate>({\n    queryKey: [\"/api/candidates\", candidateId],\n    enabled: !!candidateId,\n  });\n\n  // Determine initial stage based on candidate status\n  const [stage, setStage] = useState<ExamStage | null>(null);\n\n  useEffect(() => {\n    if (candidate) {\n      if (candidate.status === \"completed\" || candidate.status === \"auto_submitted\") {\n        setStage(\"results\");\n      } else if (candidate.status === \"in_progress\") {\n        setStage(\"session\");\n      } else {\n        setStage(\"pre-check\");\n      }\n    }\n  }, [candidate?.status]);\n\n  const { data: examData, error: examError, isError: isExamError } = useQuery({\n    queryKey: [`/api/exam-session/${candidateId}`],\n    enabled: !!candidateId && stage !== \"results\",\n    retry: false,\n  });\n\n  const startExamMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"POST\", `/api/candidates/${candidateId}/start`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/candidates\", candidateId] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/my-exams\"] });\n      setStage(\"session\");\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleStartExam = () => {\n    // Call backend to update status after pre-check passes\n    startExamMutation.mutate();\n  };\n\n  const handleExamComplete = () => {\n    setStage(\"results\");\n  };\n\n  if (!candidateId) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <p className=\"text-muted-foreground\">Invalid exam session</p>\n      </div>\n    );\n  }\n\n  // Show error state if candidate query fails\n  if (candidateError) {\n    const errorMessage = candidateError instanceof Error ? candidateError.message : \"Failed to load exam\";\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-6\">\n        <div className=\"max-w-md w-full text-center space-y-4\">\n          <h1 className=\"text-2xl font-semibold\" data-testid=\"text-candidate-error-title\">Unable to Load Exam</h1>\n          <p className=\"text-muted-foreground\" data-testid=\"text-candidate-error-message\">\n            {errorMessage}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  // Show loading state while determining candidate status\n  if (isCandidateLoading || stage === null) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"text-center space-y-4\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\n          <p className=\"text-muted-foreground\">Loading exam...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Show error message for draft or archived exams\n  if (isExamError && examError) {\n    const errorMessage = examError instanceof Error ? examError.message : \"Unable to access this exam\";\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-6\">\n        <div className=\"max-w-md w-full text-center space-y-4\">\n          <h1 className=\"text-2xl font-semibold\" data-testid=\"text-exam-error-title\">Exam Unavailable</h1>\n          <p className=\"text-muted-foreground\" data-testid=\"text-exam-error-message\">\n            {errorMessage}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (stage === \"results\") {\n    return <ExamResults candidateId={candidateId} />;\n  }\n\n  if (stage === \"session\") {\n    return <ExamSession candidateId={candidateId} onComplete={handleExamComplete} />;\n  }\n\n  return (\n    <PreExamCheck\n      examTitle={(examData as any)?.examTitle || \"Examination\"}\n      onStart={handleStartExam}\n      isStarting={startExamMutation.isPending}\n    />\n  );\n}\n","size_bytes":4543},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/pages/candidate/my-exams.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { FileText, Clock, Play, CheckCircle } from \"lucide-react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useLocation } from \"wouter\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Candidate, Exam } from \"@shared/schema\";\n\ninterface CandidateWithExam extends Candidate {\n  exam?: Exam;\n}\n\nexport default function MyExamsPage() {\n  const { user } = useAuth();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const { data: allExams, isLoading } = useQuery<CandidateWithExam[]>({\n    queryKey: [\"/api/my-exams\"],\n  });\n\n  // Filter out draft exams - candidates should never see them\n  const myExams = allExams?.filter(candidate => candidate.exam?.status !== \"draft\");\n\n  // Simply navigate to exam page, don't change status yet\n  const handleStartExam = (candidateId: number, exam?: Exam) => {\n    // Prevent starting archived exams\n    if (exam?.status === \"inactive\") {\n      toast({\n        title: \"Exam Archived\",\n        description: \"This exam has been archived and new attempts cannot be started.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    setLocation(`/exam/${candidateId}`);\n  };\n\n  const getStatusInfo = (candidate: CandidateWithExam) => {\n    switch (candidate.status) {\n      case \"completed\":\n        return {\n          label: \"Completed\",\n          color: \"bg-chart-2/10 text-chart-2\",\n          icon: CheckCircle,\n        };\n      case \"in_progress\":\n        return {\n          label: \"In Progress\",\n          color: \"bg-chart-3/10 text-chart-3\",\n          icon: Clock,\n        };\n      case \"auto_submitted\":\n        return {\n          label: \"Auto Submitted\",\n          color: \"bg-chart-4/10 text-chart-4\",\n          icon: Clock,\n        };\n      default:\n        return {\n          label: \"Not Started\",\n          color: \"bg-muted text-muted-foreground\",\n          icon: Play,\n        };\n    }\n  };\n\n  return (\n    <div className=\"p-4 sm:p-6 space-y-4 sm:space-y-6\">\n      <div>\n        <h1 className=\"text-2xl sm:text-3xl font-semibold mb-2\" data-testid=\"text-page-title\">My Exams</h1>\n        <p className=\"text-sm sm:text-base text-muted-foreground\" data-testid=\"text-page-description\">\n          View and take your assigned examinations\n        </p>\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {[1, 2, 3].map((i) => (\n            <Skeleton key={i} className=\"h-64\" />\n          ))}\n        </div>\n      ) : myExams && myExams.length > 0 ? (\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {myExams.map((candidate) => {\n            const exam = candidate.exam;\n            const statusInfo = getStatusInfo(candidate);\n            const StatusIcon = statusInfo.icon;\n\n            return (\n              <Card key={candidate.id} className=\"p-4 sm:p-6 hover-elevate\" data-testid={`exam-card-${candidate.id}`}>\n                <div className=\"space-y-3 sm:space-y-4\">\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <div className=\"flex-1 min-w-0\">\n                      <h3 className=\"font-semibold text-base sm:text-lg mb-2\" data-testid={`text-exam-title-${candidate.id}`}>\n                        {exam?.title || \"Unknown Exam\"}\n                      </h3>\n                      <p className=\"text-xs sm:text-sm text-muted-foreground line-clamp-2\">\n                        {exam?.description}\n                      </p>\n                    </div>\n                    <Badge className={statusInfo.color} data-testid={`badge-status-${candidate.id}`}>\n                      <StatusIcon className=\"h-3 w-3 mr-1\" />\n                      {statusInfo.label}\n                    </Badge>\n                  </div>\n\n                  <div className=\"space-y-2 text-sm\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Duration:</span>\n                      <span className=\"font-medium font-mono\">{exam?.duration} min</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Questions:</span>\n                      <span className=\"font-medium\">{exam?.questionCount}</span>\n                    </div>\n                    {candidate.score !== null && exam?.showResults === \"immediate\" && (\n                      <div className=\"flex justify-between pt-2 border-t\">\n                        <span className=\"text-muted-foreground\">Score:</span>\n                        <span className=\"font-bold text-lg\">{candidate.score}%</span>\n                      </div>\n                    )}\n                  </div>\n\n                  <div className=\"pt-2\">\n                    {candidate.status === \"assigned\" ? (\n                      exam?.status === \"inactive\" ? (\n                        <Button \n                          variant=\"outline\" \n                          className=\"w-full\" \n                          disabled \n                          data-testid={`button-archived-${candidate.id}`}\n                        >\n                          Exam Archived\n                        </Button>\n                      ) : (\n                        <Button \n                          className=\"w-full\" \n                          onClick={() => handleStartExam(candidate.id, exam)}\n                          data-testid={`button-start-exam-${candidate.id}`}\n                        >\n                          <Play className=\"h-4 w-4 mr-2\" />\n                          Start Exam\n                        </Button>\n                      )\n                    ) : candidate.status === \"in_progress\" ? (\n                      exam?.status === \"inactive\" ? (\n                        <Button \n                          variant=\"outline\" \n                          className=\"w-full\" \n                          disabled \n                          data-testid={`button-archived-${candidate.id}`}\n                        >\n                          Exam Archived\n                        </Button>\n                      ) : (\n                        <Button \n                          className=\"w-full\" \n                          onClick={() => setLocation(`/exam/${candidate.id}`)}\n                          data-testid={`button-continue-exam-${candidate.id}`}\n                        >\n                          Continue Exam\n                        </Button>\n                      )\n                    ) : candidate.status === \"completed\" && exam?.showResults === \"immediate\" ? (\n                      <Button \n                        variant=\"outline\" \n                        className=\"w-full\" \n                        onClick={() => setLocation(`/exam/${candidate.id}`)}\n                        data-testid={`button-view-results-${candidate.id}`}\n                      >\n                        View Results\n                      </Button>\n                    ) : (\n                      <Button variant=\"outline\" className=\"w-full\" disabled data-testid={`button-completed-${candidate.id}`}>\n                        {exam?.showResults === \"delayed\" ? \"Results Pending\" : \"Completed\"}\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              </Card>\n            );\n          })}\n        </div>\n      ) : (\n        <Card className=\"p-12\">\n          <div className=\"text-center\">\n            <FileText className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-semibold mb-2\" data-testid=\"text-no-exams\">No exams assigned yet</h3>\n            <p className=\"text-sm text-muted-foreground\">\n              Your assigned exams will appear here\n            </p>\n          </div>\n        </Card>\n      )}\n    </div>\n  );\n}\n","size_bytes":8132},"client/src/components/theme-toggle.tsx":{"content":"import { Moon, Sun } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useTheme } from \"@/components/theme-provider\";\n\nexport function ThemeToggle() {\n  const { theme, setTheme } = useTheme();\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={() => setTheme(theme === \"light\" ? \"dark\" : \"light\")}\n      data-testid=\"button-theme-toggle\"\n    >\n      <Sun className=\"h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0\" />\n      <Moon className=\"absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100\" />\n      <span className=\"sr-only\">Toggle theme</span>\n    </Button>\n  );\n}\n","size_bytes":677},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"replit.md":{"content":"# WokkahCBT\n\n### Overview\nWokkahCBT is an intelligent, secure online examination and proctoring system designed to facilitate the creation, management, and monitoring of online exams with AI-assisted supervision. It aims to ensure academic integrity through features like camera monitoring, tab-switch restrictions, question randomization, and advanced proctoring capabilities. The system supports both administrators, who manage exams and monitor candidates, and candidates, who take proctored exams.\n\n### User Preferences\nI prefer the AI agent to be concise and to the point. When suggesting code changes, provide the exact code snippets that can be directly applied. I appreciate it when the agent explains the 'why' behind its suggestions, especially for architectural decisions. Prioritize secure and scalable solutions. Do not make changes to files or folders without explicit confirmation, especially to core authentication or proctoring logic. I prefer detailed explanations for complex features.\n\n### System Architecture\nThe application is built with a **React + TypeScript** frontend utilizing **Tailwind CSS** and **Shadcn UI** for a modern, responsive design, and **WebRTC** for real-time video feeds. The backend is an **Express.js + TypeScript** server. **PostgreSQL** with **Drizzle ORM** serves as the database. Authentication is handled by a custom **password-based system** with **bcrypt** for password hashing and **express-session** for session management. **WebSockets** enable real-time monitoring. **TensorFlow.js with BlazeFace** is used for AI-powered face detection. **Nodemailer** handles email invitations.\n\n**UI/UX Decisions:**\n- **Color Palette:** Professional Blue for primary actions, Green for success, Amber for warnings, Red for danger, and Blue for informational messages.\n- **Typography:** Inter for body text and UI, JetBrains Mono for technical data and timers.\n- **Components:** Leverages Shadcn UI, custom sidebar navigation, data tables with sorting/filtering, camera feed displays, alert banners, and stats cards.\n\n**Technical Implementations:**\n- **Database Schema:** Includes tables for `users`, `sessions`, `domains`, `questions`, `exams`, `exam_questions`, `candidates`, `responses`, and `proctor_logs`, with defined relationships.\n  - **Exam Status Values:** `draft` (not accessible to candidates), `active` (full access), `inactive` (labeled as \"Archived\" - prevents new attempts but allows viewing completed results)\n- **Admin Features:** Dashboard, exam/question/candidate/domain management, live monitoring (global and per-exam), analytics, bulk import/export, exam results viewing with CSV/PDF export capabilities, and AI question generation from uploaded PDF/Word documents.\n- **Candidate Features:** My Exams view, pre-exam checks, proctored exam sessions (one question at a time, timer, webcam, microphone, fullscreen, tab switch detection, auto-save), and result viewing.\n  - **Exam Access Control:** Draft exams filtered on both frontend and backend, inactive (archived) exams prevent new attempts but allow result viewing\n- **Advanced Proctoring:**\n    - **AI Face Detection:** TensorFlow.js BlazeFace model detects no face or multiple faces, logging high-severity violations. **3-strike warning system**: Candidates receive visual warnings (1/3, 2/3, 3/3) when face is not detected for 10+ seconds; auto-logout after 3rd strike.\n    - **Microphone Audio Detection:** Monitors audio levels, logging prolonged silence (low severity) or high background noise (medium severity). **3-strike warning system**: Candidates receive visual warnings for excessive noise (>80 audio level for 3+ seconds); auto-logout after 3rd strike.\n    - **Fullscreen Enforcement:** Automatically enters fullscreen, detects exits, and re-enters.\n    - **Tab Switch Detection:** Logs window/tab changes. **10-second auto-logout**: When candidate leaves tab/minimizes window, a 10-second countdown begins with visual timer; auto-logout if not returned within 10 seconds. Countdown cancels if candidate returns to tab.\n    - **Warning Indicators:** Real-time visual badges in exam header display active warning counts (Noise: X/3, Focus: X/3) and tab switch countdown timer (Logout in: Xs) with AlertTriangle icons.\n    - **Event Logging:** Stores all proctoring events with timestamps and severity.\n    - **Question Randomization:** Uses a unique random seed per candidate to randomize question order and options.\n    - **Responsive UI:** Question navigation grid with flex-wrap for large question sets, mobile-optimized header and layout with responsive padding and text sizing.\n- **Authentication:** Password-based authentication with bcrypt, session management (secure cookies in production only), admin registration, candidate invitation workflow via email, and password reset functionality for administrators with email-based token validation (tokens are hashed before storage and expire after 1 hour).\n- **Bulk Operations:** CSV import for candidates and CSV/PDF export for exam results, proctoring logs, and analytics reports using `jsPDF` and `PapaParse`.\n  - **Results Export:** Administrators can view all completed candidate results in a table and export to CSV or PDF format with full candidate details (name, email, department, matric no, score, status, completion time).\n- **Per-Exam Monitoring:** Exam management page includes dedicated \"Live Monitoring\" and \"Logs\" tabs that display real-time sessions and proctoring events filtered specifically for that exam. These tabs auto-refresh every 5 seconds and use the `/api/monitoring/active?examId=X` and `/api/monitoring/logs?examId=X` endpoints to ensure proper exam-specific data isolation.\n  - **Automatic Session Cleanup:** Stale exam sessions (exceeding exam duration by >5 minutes) are automatically marked as \"auto_submitted\" and removed from live monitoring to prevent clutter from abandoned sessions.\n  - **Logs Export:** Administrators can download ALL proctoring logs for a specific exam as CSV format. The export includes timestamp, candidate name, email, event type, severity, and metadata. Uses `/api/monitoring/logs/export?examId=X` endpoint which returns the complete log set without pagination limits.\n  - **Live Camera Streaming:** Administrators can view live camera feeds from candidates during exams via WebSocket streaming. Video frames are captured at 2fps (320x240, JPEG 50% quality) and broadcast to all connected admin clients in real-time.\n- **AI Question Generation from Documents:**\n    - **Document Upload:** Administrators can upload PDF, Word, or PowerPoint documents to provide context for AI question generation\n    - **Text Extraction:** Automatically extracts text from PDF (using pdf-parse), Word documents (using mammoth), and PowerPoint presentations (using officeparser)\n    - **Context-Aware Generation:** AI generates questions based on document content when provided, ensuring relevance to specific course materials\n    - **File Restrictions:** Supports PDF (.pdf), Word (.doc, .docx), and PowerPoint (.ppt, .pptx) files up to 10MB\n    - **Optional Feature:** Documents can be uploaded during exam creation or when generating questions in exam management, but are not required\n    - **Integration Points:** Available in both exam creation form and exam management \"Generate with AI\" dialog\n- **Real-time Communication:** WebSockets for live monitoring and alerts.\n\n### External Dependencies\n- **Frontend Framework:** React\n- **Styling:** Tailwind CSS, Shadcn UI\n- **Real-time Communication:** WebRTC (for camera feeds), WebSockets\n- **Backend Framework:** Express.js\n- **Database:** PostgreSQL\n- **ORM:** Drizzle ORM\n- **Database Driver:** pg (node-postgres) for local/standard PostgreSQL deployments\n- **AI/ML:** TensorFlow.js with BlazeFace model (for face detection), OpenAI GPT-4 (for question generation)\n- **Email Service:** Nodemailer (requires SMTP configuration)\n- **PDF Generation:** jsPDF\n- **CSV Parsing/Generation:** PapaParse\n- **Document Processing:** pdf-parse (PDF text extraction), mammoth (Word document text extraction), officeparser (PowerPoint text extraction), multer (file upload handling)\n- **Authentication/Session Management:** bcrypt, express-session\n\n### Local Deployment Support\nThe codebase has been prepared for local deployment outside of Replit:\n\n**Database Configuration:**\n- Uses standard `pg` (node-postgres) driver for PostgreSQL connections\n- Compatible with any PostgreSQL database (local, AWS RDS, Azure Database, etc.)\n- Connection via `DATABASE_URL` environment variable\n\n**Environment Variables:**\n- `APP_URL` - Application base URL (replaces Replit-specific `REPLIT_DOMAINS`)\n- `DATABASE_URL` - PostgreSQL connection string\n- `SESSION_SECRET` - Session encryption key\n- `OPENAI_API_KEY` - OpenAI API key for AI features\n- `SMTP_*` - Optional email configuration\n- See `.env.example` for complete list\n\n**Replit-Specific Files (safe to ignore for local deployment):**\n- `.replit` - Replit environment configuration (only used in Replit)\n- `vite.config.ts` - Contains conditional Replit plugins that only load when `REPL_ID` environment variable exists\n- Replit Vite plugins in `devDependencies` - Only activate in Replit environment\n\n**Local Setup:**\nSee `LOCAL_DEPLOYMENT.md` for complete local deployment instructions including:\n- PostgreSQL setup\n- Environment configuration\n- Database initialization\n- Development and production builds","size_bytes":9421},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4050},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/App.tsx":{"content":"import { Switch, Route, Redirect } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"@/components/theme-provider\";\nimport { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { AppSidebar } from \"@/components/app-sidebar\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport NotFound from \"@/pages/not-found\";\nimport AdminLoginPage from \"@/pages/admin-login\";\nimport CandidateLoginPage from \"@/pages/candidate-login\";\nimport SetPasswordPage from \"@/pages/set-password\";\nimport ForgotPasswordPage from \"@/pages/admin/forgot-password\";\nimport ResetPasswordPage from \"@/pages/admin/reset-password\";\n\n// Admin pages\nimport AdminDashboard from \"@/pages/admin/dashboard\";\nimport ExamsPage from \"@/pages/admin/exams\";\nimport ExamManagePage from \"@/pages/admin/exam-manage\";\nimport CandidatesPage from \"@/pages/admin/candidates\";\nimport MonitoringPage from \"@/pages/admin/monitoring\";\nimport DomainsPage from \"@/pages/admin/domains\";\nimport AnalyticsPage from \"@/pages/admin/analytics\";\nimport AdministratorsPage from \"@/pages/admin/administrators\";\n\n// Candidate pages\nimport MyExamsPage from \"@/pages/candidate/my-exams\";\nimport ExamWrapper from \"@/pages/candidate/exam-wrapper\";\n\nfunction AdminRoute({ component: Component, ...rest }: any) {\n  const { isAdmin } = useAuth();\n  \n  if (!isAdmin) {\n    return <Redirect to=\"/\" />;\n  }\n  \n  return <Component {...rest} />;\n}\n\nfunction Router() {\n  const { isAuthenticated, isLoading, isAdmin } = useAuth();\n\n  // Show loading state while checking authentication\n  if (isLoading) {\n    return null;\n  }\n\n  // If not authenticated, show public routes only\n  if (!isAuthenticated) {\n    return (\n      <Switch>\n        <Route path=\"/\" component={CandidateLoginPage} />\n        <Route path=\"/admin\" component={AdminLoginPage} />\n        <Route path=\"/admin/forgot-password\" component={ForgotPasswordPage} />\n        <Route path=\"/admin/reset-password\" component={ResetPasswordPage} />\n        <Route path=\"/set-password\" component={SetPasswordPage} />\n        <Route component={NotFound} />\n      </Switch>\n    );\n  }\n\n  // Authenticated routes\n  return (\n    <Switch>\n      {isAdmin ? (\n        <>\n          <Route path=\"/\" component={AdminDashboard} />\n          <Route path=\"/exams\" component={ExamsPage} />\n          <Route path=\"/exams/:id/manage\" component={ExamManagePage} />\n          <Route path=\"/candidates\" component={CandidatesPage} />\n          <Route path=\"/monitoring\" component={MonitoringPage} />\n          <Route path=\"/analytics\" component={AnalyticsPage} />\n          <Route path=\"/domains\" component={DomainsPage} />\n          <Route path=\"/administrators\" component={AdministratorsPage} />\n        </>\n      ) : (\n        <>\n          <Route path=\"/\" component={MyExamsPage} />\n          <Route path=\"/exam/:candidateId\" component={ExamWrapper} />\n          <Route path=\"/exams\">{() => <Redirect to=\"/\" />}</Route>\n          <Route path=\"/candidates\">{() => <Redirect to=\"/\" />}</Route>\n          <Route path=\"/monitoring\">{() => <Redirect to=\"/\" />}</Route>\n          <Route path=\"/analytics\">{() => <Redirect to=\"/\" />}</Route>\n          <Route path=\"/domains\">{() => <Redirect to=\"/\" />}</Route>\n        </>\n      )}\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction AppContent() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  const sidebarStyle = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  };\n\n  // Show minimal layout while loading or not authenticated\n  if (isLoading || !isAuthenticated) {\n    return (\n      <>\n        <Router />\n        <Toaster />\n      </>\n    );\n  }\n\n  // Show full layout with sidebar for authenticated users\n  return (\n    <SidebarProvider style={sidebarStyle as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\">\n        <AppSidebar />\n        <div className=\"flex flex-col flex-1 overflow-hidden\">\n          <header className=\"flex items-center justify-between p-2 border-b border-border\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n            <ThemeToggle />\n          </header>\n          <main className=\"flex-1 overflow-y-auto\">\n            <Router />\n          </main>\n        </div>\n      </div>\n      <Toaster />\n    </SidebarProvider>\n  );\n}\n\nexport default function App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider>\n        <TooltipProvider>\n          <AppContent />\n        </TooltipProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  );\n}\n","size_bytes":4781},"client/src/pages/admin/monitoring.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { AlertTriangle, Eye, Camera, FileDown } from \"lucide-react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport type { ProctorLog, Candidate, User } from \"@shared/schema\";\nimport { exportProctorLogsCSV, exportProctorLogsPDF } from \"@/lib/exportReports\";\n\ninterface ProctorLogWithDetails extends ProctorLog {\n  candidate?: Candidate & { user?: User };\n}\n\ninterface ActiveSession extends Candidate {\n  user?: User;\n  exam?: any;\n  timeRemaining?: string | null;\n}\n\nexport default function MonitoringPage() {\n  const [videoFeeds, setVideoFeeds] = useState<Map<number, string>>(new Map());\n  const wsRef = useRef<WebSocket | null>(null);\n\n  const { data: activeSessions, isLoading: sessionsLoading } = useQuery<ActiveSession[]>({\n    queryKey: [\"/api/monitoring/active\"],\n  });\n\n  const { data: logs, isLoading: logsLoading } = useQuery<ProctorLogWithDetails[]>({\n    queryKey: [\"/api/monitoring/logs\"],\n  });\n\n  // WebSocket connection for receiving video feeds\n  useEffect(() => {\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n    const wsUrl = `${protocol}//${window.location.host}/ws`;\n    \n    const ws = new WebSocket(wsUrl);\n    wsRef.current = ws;\n\n    ws.onopen = () => {\n      console.log('Admin WebSocket connected for video monitoring');\n      ws.send(JSON.stringify({\n        type: 'register',\n        clientType: 'admin'\n      }));\n    };\n\n    ws.onmessage = (event) => {\n      try {\n        const data = JSON.parse(event.data);\n        \n        if (data.type === 'video_frame' && data.candidateId && data.frame) {\n          setVideoFeeds(prev => {\n            const updated = new Map(prev);\n            updated.set(data.candidateId, data.frame);\n            return updated;\n          });\n        }\n      } catch (error) {\n        console.error('WebSocket message error:', error);\n      }\n    };\n\n    ws.onerror = (error) => {\n      console.error('Admin WebSocket error:', error);\n    };\n\n    ws.onclose = () => {\n      console.log('Admin WebSocket disconnected');\n    };\n\n    return () => {\n      if (ws.readyState === WebSocket.OPEN) {\n        ws.close();\n      }\n    };\n  }, []);\n\n  const getSeverityColor = (severity: string) => {\n    switch (severity) {\n      case \"high\":\n        return \"bg-destructive/10 text-destructive\";\n      case \"medium\":\n        return \"bg-chart-4/10 text-chart-4\";\n      default:\n        return \"bg-chart-2/10 text-chart-2\";\n    }\n  };\n\n  const getEventIcon = (eventType: string) => {\n    switch (eventType) {\n      case \"face_absent\":\n      case \"multiple_faces\":\n        return Camera;\n      case \"tab_switch\":\n        return Eye;\n      default:\n        return AlertTriangle;\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-semibold mb-2\" data-testid=\"text-page-title\">Live Monitoring</h1>\n          <p className=\"text-muted-foreground\" data-testid=\"text-page-description\">\n            Real-time exam monitoring and proctoring events\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button onClick={() => logs && exportProctorLogsCSV(logs)} variant=\"outline\" data-testid=\"button-export-logs-csv\">\n            <FileDown className=\"h-4 w-4 mr-2\" />\n            Export CSV\n          </Button>\n          <Button onClick={() => logs && exportProctorLogsPDF(logs)} variant=\"outline\" data-testid=\"button-export-logs-pdf\">\n            <FileDown className=\"h-4 w-4 mr-2\" />\n            Export PDF\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"grid gap-6 lg:grid-cols-3\">\n        <div className=\"lg:col-span-2 space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Active Exam Sessions</CardTitle>\n            </CardHeader>\n            <CardContent>\n              {sessionsLoading ? (\n                <div className=\"grid gap-4 md:grid-cols-2\">\n                  {[1, 2].map((i) => (\n                    <Skeleton key={i} className=\"h-48\" />\n                  ))}\n                </div>\n              ) : activeSessions && activeSessions.length > 0 ? (\n                <div className=\"grid gap-4 md:grid-cols-2\">\n                  {activeSessions.map((session: any) => {\n                    const user = session.user;\n                    const initials = user?.firstName && user?.lastName \n                      ? `${user.firstName[0]}${user.lastName[0]}`.toUpperCase()\n                      : user?.email?.[0]?.toUpperCase() || \"U\";\n\n                    return (\n                      <div\n                        key={session.id}\n                        className=\"p-4 rounded-lg border border-border bg-card\"\n                        data-testid={`session-${session.id}`}\n                      >\n                        <div className=\"flex items-start gap-3 mb-3\">\n                          <Avatar className=\"h-10 w-10\">\n                            <AvatarImage src={user?.profileImageUrl || undefined} className=\"object-cover\" />\n                            <AvatarFallback>{initials}</AvatarFallback>\n                          </Avatar>\n                          <div className=\"flex-1\">\n                            <p className=\"font-medium text-sm\">\n                              {user?.firstName && user?.lastName \n                                ? `${user.firstName} ${user.lastName}`\n                                : user?.email || \"Unknown\"}\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">{session.exam?.title}</p>\n                          </div>\n                          <Badge variant=\"outline\" className=\"bg-chart-2/10 text-chart-2\">\n                            <div className=\"h-2 w-2 rounded-full bg-chart-2 mr-1.5 animate-pulse\" />\n                            Live\n                          </Badge>\n                        </div>\n\n                        <div className=\"aspect-video bg-muted rounded-md flex items-center justify-center mb-3 relative overflow-hidden\" data-testid={`camera-feed-${session.id}`}>\n                          {videoFeeds.get(session.id) ? (\n                            <img \n                              src={videoFeeds.get(session.id)} \n                              alt=\"Live camera feed\"\n                              className=\"w-full h-full object-cover\"\n                            />\n                          ) : (\n                            <>\n                              <Camera className=\"h-8 w-8 text-muted-foreground\" />\n                              <span className=\"ml-2 text-sm text-muted-foreground\">Waiting for feed...</span>\n                            </>\n                          )}\n                        </div>\n\n                        <div className=\"flex items-center justify-between text-sm\">\n                          <span className=\"text-muted-foreground\">Time Remaining:</span>\n                          <span className=\"font-medium font-mono\" data-testid={`time-remaining-${session.id}`}>\n                            {session.timeRemaining || \"00:00\"}\n                          </span>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              ) : (\n                <p className=\"text-sm text-muted-foreground text-center py-8\" data-testid=\"text-no-active-sessions\">\n                  No active exam sessions\n                </p>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Proctoring Events</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {logsLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3, 4].map((i) => (\n                  <Skeleton key={i} className=\"h-20\" />\n                ))}\n              </div>\n            ) : logs && logs.length > 0 ? (\n              <div className=\"space-y-3 max-h-[600px] overflow-y-auto\">\n                {logs.map((log) => {\n                  const EventIcon = getEventIcon(log.eventType);\n                  const user = log.candidate?.user;\n\n                  return (\n                    <div\n                      key={log.id}\n                      className=\"p-3 rounded-lg border border-border\"\n                      data-testid={`log-${log.id}`}\n                    >\n                      <div className=\"flex items-start gap-3\">\n                        <div className={`h-8 w-8 rounded-lg ${getSeverityColor(log.severity)} flex items-center justify-center flex-shrink-0`}>\n                          <EventIcon className=\"h-4 w-4\" />\n                        </div>\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-2 mb-1\">\n                            <Badge variant=\"outline\" className={getSeverityColor(log.severity)}>\n                              {log.severity}\n                            </Badge>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {new Date(log.timestamp).toLocaleTimeString()}\n                            </p>\n                          </div>\n                          <p className=\"text-sm font-medium mb-1\">\n                            {log.eventType.replace(\"_\", \" \").replace(/\\b\\w/g, l => l.toUpperCase())}\n                          </p>\n                          <p className=\"text-xs text-muted-foreground truncate\">\n                            {user?.firstName && user?.lastName \n                              ? `${user.firstName} ${user.lastName}`\n                              : user?.email || \"Unknown User\"}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            ) : (\n              <p className=\"text-sm text-muted-foreground text-center py-8\" data-testid=\"text-no-events\">\n                No proctoring events\n              </p>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":10477},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/pages/admin/domains.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Plus, FolderOpen } from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport type { Domain } from \"@shared/schema\";\n\nexport default function DomainsPage() {\n  const [isCreateOpen, setIsCreateOpen] = useState(false);\n  const { toast } = useToast();\n\n  const { data: domains, isLoading } = useQuery<Domain[]>({\n    queryKey: [\"/api/domains\"],\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/domains\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/domains\"] });\n      setIsCreateOpen(false);\n      toast({\n        title: \"Success\",\n        description: \"Domain created successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const formData = new FormData(e.currentTarget);\n    \n    const data = {\n      name: formData.get(\"name\") as string,\n      description: formData.get(\"description\") as string,\n    };\n\n    createMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-semibold mb-2\" data-testid=\"text-page-title\">Domains</h1>\n          <p className=\"text-muted-foreground\" data-testid=\"text-page-description\">\n            Organize questions and exams by subject area\n          </p>\n        </div>\n        <Button onClick={() => setIsCreateOpen(true)} data-testid=\"button-create-domain\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Add Domain\n        </Button>\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {[1, 2, 3].map((i) => (\n            <Skeleton key={i} className=\"h-32\" />\n          ))}\n        </div>\n      ) : domains && domains.length > 0 ? (\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {domains.map((domain) => (\n            <Card key={domain.id} className=\"p-6 hover-elevate\" data-testid={`domain-card-${domain.id}`}>\n              <div className=\"flex items-start gap-4\">\n                <div className=\"h-12 w-12 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0\">\n                  <FolderOpen className=\"h-6 w-6 text-primary\" />\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                  <h3 className=\"font-semibold mb-1\" data-testid={`text-domain-name-${domain.id}`}>\n                    {domain.name}\n                  </h3>\n                  <p className=\"text-sm text-muted-foreground line-clamp-2\">\n                    {domain.description || \"No description\"}\n                  </p>\n                </div>\n              </div>\n            </Card>\n          ))}\n        </div>\n      ) : (\n        <Card className=\"p-12\">\n          <div className=\"text-center\">\n            <FolderOpen className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-semibold mb-2\" data-testid=\"text-no-domains\">No domains created yet</h3>\n            <p className=\"text-sm text-muted-foreground mb-6\">\n              Create subject domains to organize your questions and exams\n            </p>\n            <Button onClick={() => setIsCreateOpen(true)} data-testid=\"button-create-first-domain\">\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Create First Domain\n            </Button>\n          </div>\n        </Card>\n      )}\n\n      <Dialog open={isCreateOpen} onOpenChange={setIsCreateOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Create New Domain</DialogTitle>\n            <DialogDescription>\n              Add a new subject area for organizing questions and exams\n            </DialogDescription>\n          </DialogHeader>\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"name\">Domain Name *</Label>\n              <Input\n                id=\"name\"\n                name=\"name\"\n                placeholder=\"e.g., Mathematics, Physics, History\"\n                required\n                data-testid=\"input-domain-name\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"description\">Description</Label>\n              <Textarea\n                id=\"description\"\n                name=\"description\"\n                placeholder=\"Brief description of this subject area\"\n                rows={3}\n                data-testid=\"input-domain-description\"\n              />\n            </div>\n\n            <DialogFooter>\n              <Button type=\"button\" variant=\"outline\" onClick={() => setIsCreateOpen(false)} data-testid=\"button-cancel\">\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={createMutation.isPending} data-testid=\"button-submit-domain\">\n                {createMutation.isPending ? \"Creating...\" : \"Create Domain\"}\n              </Button>\n            </DialogFooter>\n          </form>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":5888},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n\n  /* Automatic computation of border around primary / danger buttons */\n  --opaque-button-border-intensity: -8; /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n\n  --background: 0 0% 100%;\n  --foreground: 222 47% 11%;\n  --border: 214 32% 91%;\n\n  --card: 210 20% 98%;\n  --card-foreground: 222 47% 11%;\n  --card-border: 214 32% 94%;\n\n  --sidebar: 210 20% 96%;\n  --sidebar-foreground: 222 47% 11%;\n  --sidebar-border: 214 32% 88%;\n  --sidebar-primary: 217 91% 60%;\n  --sidebar-primary-foreground: 210 20% 98%;\n  --sidebar-accent: 210 20% 92%;\n  --sidebar-accent-foreground: 222 47% 11%;\n  --sidebar-ring: 217 91% 60%;\n\n  --popover: 210 20% 95%;\n  --popover-foreground: 222 47% 11%;\n  --popover-border: 214 32% 86%;\n\n  --primary: 217 91% 60%;\n  --primary-foreground: 210 20% 98%;\n\n  --secondary: 210 20% 90%;\n  --secondary-foreground: 222 47% 11%;\n\n  --muted: 210 15% 93%;\n  --muted-foreground: 215 16% 47%;\n\n  --accent: 210 18% 91%;\n  --accent-foreground: 222 47% 11%;\n\n  --destructive: 0 84% 60%;\n  --destructive-foreground: 210 20% 98%;\n\n  --input: 214 32% 75%;\n  --ring: 217 91% 60%;\n\n  --chart-1: 217 91% 55%;\n  --chart-2: 142 76% 36%;\n  --chart-3: 199 89% 48%;\n  --chart-4: 38 92% 50%;\n  --chart-5: 24 100% 50%;\n\n  --font-sans: 'Inter', system-ui, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: 'JetBrains Mono', monospace;\n  --radius: .5rem;\n  --shadow-2xs: 0px 1px 2px 0px hsl(222 47% 11% / 0.05);\n  --shadow-xs: 0px 1px 3px 0px hsl(222 47% 11% / 0.1);\n  --shadow-sm: 0px 1px 2px 0px hsl(222 47% 11% / 0.05), 0px 1px 3px -1px hsl(222 47% 11% / 0.1);\n  --shadow: 0px 1px 3px 0px hsl(222 47% 11% / 0.1), 0px 1px 2px -1px hsl(222 47% 11% / 0.1);\n  --shadow-md: 0px 4px 6px -1px hsl(222 47% 11% / 0.1), 0px 2px 4px -1px hsl(222 47% 11% / 0.1);\n  --shadow-lg: 0px 10px 15px -3px hsl(222 47% 11% / 0.1), 0px 4px 6px -2px hsl(222 47% 11% / 0.1);\n  --shadow-xl: 0px 20px 25px -5px hsl(222 47% 11% / 0.1), 0px 10px 10px -5px hsl(222 47% 11% / 0.1);\n  --shadow-2xl: 0px 25px 50px -12px hsl(222 47% 11% / 0.25);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n\n  --opaque-button-border-intensity: 9;  /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n\n  --background: 222 47% 11%;\n  --foreground: 210 20% 98%;\n  --border: 215 28% 25%;\n\n  --card: 217 33% 17%;\n  --card-foreground: 210 20% 98%;\n  --card-border: 215 28% 28%;\n\n  --sidebar: 217 33% 15%;\n  --sidebar-foreground: 210 20% 98%;\n  --sidebar-border: 215 28% 22%;\n  --sidebar-primary: 217 91% 60%;\n  --sidebar-primary-foreground: 210 20% 98%;\n  --sidebar-accent: 217 33% 20%;\n  --sidebar-accent-foreground: 210 20% 98%;\n  --sidebar-ring: 217 91% 60%;\n\n  --popover: 217 33% 19%;\n  --popover-foreground: 210 20% 98%;\n  --popover-border: 215 28% 30%;\n\n  --primary: 217 91% 60%;\n  --primary-foreground: 210 20% 98%;\n\n  --secondary: 217 33% 22%;\n  --secondary-foreground: 210 20% 98%;\n\n  --muted: 217 25% 24%;\n  --muted-foreground: 215 20% 65%;\n\n  --accent: 217 25% 26%;\n  --accent-foreground: 210 20% 98%;\n\n  --destructive: 0 84% 60%;\n  --destructive-foreground: 210 20% 98%;\n\n  --input: 215 28% 45%;\n  --ring: 217 91% 60%;\n\n  --chart-1: 217 91% 70%;\n  --chart-2: 142 76% 45%;\n  --chart-3: 199 89% 58%;\n  --chart-4: 38 92% 60%;\n  --chart-5: 24 100% 60%;\n\n  --shadow-2xs: 0px 1px 2px 0px hsl(0 0% 0% / 0.3);\n  --shadow-xs: 0px 1px 3px 0px hsl(0 0% 0% / 0.4);\n  --shadow-sm: 0px 1px 2px 0px hsl(0 0% 0% / 0.3), 0px 1px 3px -1px hsl(0 0% 0% / 0.4);\n  --shadow: 0px 1px 3px 0px hsl(0 0% 0% / 0.4), 0px 1px 2px -1px hsl(0 0% 0% / 0.4);\n  --shadow-md: 0px 4px 6px -1px hsl(0 0% 0% / 0.4), 0px 2px 4px -1px hsl(0 0% 0% / 0.4);\n  --shadow-lg: 0px 10px 15px -3px hsl(0 0% 0% / 0.4), 0px 4px 6px -2px hsl(0 0% 0% / 0.4);\n  --shadow-xl: 0px 20px 25px -5px hsl(0 0% 0% / 0.5), 0px 10px 10px -5px hsl(0 0% 0% / 0.4);\n  --shadow-2xl: 0px 25px 50px -12px hsl(0 0% 0% / 0.6);\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: -1;\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: 999;\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}","size_bytes":10996},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/pages/admin/exams.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Plus, Pencil, Trash2, Eye, FileText, X } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Switch } from \"@/components/ui/switch\";\nimport type { Exam, Domain } from \"@shared/schema\";\n\ntype QuestionInput = {\n  type: \"multiple_choice\" | \"true_false\";\n  content: string;\n  options: string[];\n  correctAnswer: string;\n};\n\nexport default function ExamsPage() {\n  const [, setLocation] = useLocation();\n  const [isCreateOpen, setIsCreateOpen] = useState(false);\n  const [questions, setQuestions] = useState<QuestionInput[]>([]);\n  const [selectedDomain, setSelectedDomain] = useState<number | null>(null);\n  const [useAI, setUseAI] = useState(false);\n  const [aiQuestionCount, setAiQuestionCount] = useState<number>(5);\n  const [documentContent, setDocumentContent] = useState<string>(\"\");\n  const [isUploadingDoc, setIsUploadingDoc] = useState(false);\n  const [uploadedDocName, setUploadedDocName] = useState<string>(\"\");\n  const [examToDelete, setExamToDelete] = useState<number | null>(null);\n  const { toast} = useToast();\n\n  const { data: exams, isLoading } = useQuery<Exam[]>({\n    queryKey: [\"/api/exams\"],\n  });\n\n  const { data: domains } = useQuery<Domain[]>({\n    queryKey: [\"/api/domains\"],\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/exams\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\"] });\n      setIsCreateOpen(false);\n      setQuestions([]);\n      setSelectedDomain(null);\n      setUseAI(false);\n      setAiQuestionCount(5);\n      toast({\n        title: \"Success\",\n        description: \"Exam created successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (examId: number) => {\n      return await apiRequest(\"DELETE\", `/api/exams/${examId}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\"] });\n      setExamToDelete(null);\n      toast({\n        title: \"Success\",\n        description: \"Exam deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const formData = new FormData(e.currentTarget);\n    \n    const examData = {\n      domainId: parseInt(formData.get(\"domainId\") as string),\n      title: formData.get(\"title\") as string,\n      description: formData.get(\"description\") as string,\n      duration: parseInt(formData.get(\"duration\") as string),\n      questionCount: parseInt(formData.get(\"questionCount\") as string),\n      showResults: formData.get(\"showResults\") as string,\n      status: \"draft\",\n      enableWebcam: formData.get(\"enableWebcam\") === \"on\",\n      enableTabDetection: formData.get(\"enableTabDetection\") === \"on\",\n    };\n\n    const questionsData = questions.map(q => ({\n      domainId: examData.domainId,\n      type: q.type,\n      content: q.content,\n      options: q.options.filter(opt => opt.trim() !== \"\"),\n      correctAnswer: q.correctAnswer,\n    }));\n\n    createMutation.mutate({\n      ...examData,\n      questions: questionsData,\n      useAI,\n      aiQuestionCount: useAI ? aiQuestionCount : 0,\n      documentContent: useAI && documentContent ? documentContent : undefined,\n    });\n  };\n\n  const handleDocumentUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Validate file type\n    const allowedTypes = [\n      'application/pdf',\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n      'application/msword',\n      'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      'application/vnd.ms-powerpoint'\n    ];\n    \n    if (!allowedTypes.includes(file.type)) {\n      toast({\n        title: \"Invalid File\",\n        description: \"Please upload a PDF, Word, or PowerPoint document\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsUploadingDoc(true);\n    try {\n      const formData = new FormData();\n      formData.append('document', file);\n\n      const response = await fetch('/api/ai/extract-document', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to extract document text');\n      }\n\n      const data = await response.json();\n      setDocumentContent(data.text);\n      setUploadedDocName(file.name);\n      \n      toast({\n        title: \"Document Uploaded\",\n        description: `Successfully extracted text from ${file.name}`,\n      });\n    } catch (error) {\n      toast({\n        title: \"Upload Failed\",\n        description: error instanceof Error ? error.message : \"Failed to upload document\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsUploadingDoc(false);\n    }\n  };\n\n  const clearDocument = () => {\n    setDocumentContent(\"\");\n    setUploadedDocName(\"\");\n  };\n\n  const addQuestion = () => {\n    setQuestions([...questions, {\n      type: \"multiple_choice\",\n      content: \"\",\n      options: [\"\", \"\", \"\", \"\"],\n      correctAnswer: \"\",\n    }]);\n  };\n\n  const removeQuestion = (index: number) => {\n    setQuestions(questions.filter((_, i) => i !== index));\n  };\n\n  const updateQuestion = (index: number, field: keyof QuestionInput, value: any) => {\n    const updated = [...questions];\n    if (field === \"type\") {\n      if (value === \"true_false\") {\n        updated[index] = { \n          ...updated[index], \n          type: value, \n          options: [\"True\", \"False\"],\n          correctAnswer: \"True\"\n        };\n      } else {\n        updated[index] = { \n          ...updated[index], \n          type: value, \n          options: [\"\", \"\", \"\", \"\"],\n          correctAnswer: \"\" \n        };\n      }\n    } else {\n      updated[index] = { ...updated[index], [field]: value };\n    }\n    setQuestions(updated);\n  };\n\n  const updateQuestionOption = (questionIndex: number, optionIndex: number, value: string) => {\n    const updated = [...questions];\n    updated[questionIndex].options[optionIndex] = value;\n    setQuestions(updated);\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-semibold mb-2\" data-testid=\"text-page-title\">Exams</h1>\n          <p className=\"text-muted-foreground\" data-testid=\"text-page-description\">\n            Create and manage your examinations\n          </p>\n        </div>\n        <Button onClick={() => setIsCreateOpen(true)} data-testid=\"button-create-exam\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Create Exam\n        </Button>\n      </div>\n\n      {isLoading ? (\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {[1, 2, 3].map((i) => (\n            <Skeleton key={i} className=\"h-48\" />\n          ))}\n        </div>\n      ) : exams && exams.length > 0 ? (\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {exams.map((exam) => (\n            <Card key={exam.id} className=\"p-6 hover-elevate\" data-testid={`exam-card-${exam.id}`}>\n              <div className=\"space-y-4\">\n                <div className=\"flex items-start justify-between gap-2\">\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-semibold mb-1\" data-testid={`text-exam-title-${exam.id}`}>\n                      {exam.title}\n                    </h3>\n                    <p className=\"text-sm text-muted-foreground line-clamp-2\">\n                      {exam.description}\n                    </p>\n                  </div>\n                  <Badge\n                    variant={exam.status === \"active\" ? \"default\" : \"secondary\"}\n                    data-testid={`badge-exam-status-${exam.id}`}\n                  >\n                    {exam.status}\n                  </Badge>\n                </div>\n\n                <div className=\"flex items-center justify-between text-sm\">\n                  <span className=\"text-muted-foreground\">Duration:</span>\n                  <span className=\"font-medium\">{exam.duration} mins</span>\n                </div>\n\n                <div className=\"flex gap-2 pt-2\">\n                  <Button \n                    variant=\"outline\" \n                    size=\"sm\" \n                    className=\"flex-1\" \n                    onClick={() => setLocation(`/exams/${exam.id}/manage`)}\n                    data-testid={`button-manage-exam-${exam.id}`}\n                  >\n                    <Pencil className=\"h-4 w-4 mr-2\" />\n                    Manage\n                  </Button>\n                  <Button \n                    variant=\"outline\" \n                    size=\"sm\" \n                    onClick={() => setExamToDelete(exam.id)}\n                    data-testid={`button-delete-exam-${exam.id}`}\n                  >\n                    <Trash2 className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            </Card>\n          ))}\n        </div>\n      ) : (\n        <Card className=\"p-12\">\n          <div className=\"text-center\">\n            <FileText className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-semibold mb-2\" data-testid=\"text-no-exams\">No exams created yet</h3>\n            <p className=\"text-sm text-muted-foreground mb-6\">\n              Get started by creating your first examination\n            </p>\n            <Button onClick={() => setIsCreateOpen(true)} data-testid=\"button-create-first-exam\">\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Create Your First Exam\n            </Button>\n          </div>\n        </Card>\n      )}\n\n      <Dialog open={isCreateOpen} onOpenChange={setIsCreateOpen}>\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Create New Exam</DialogTitle>\n            <DialogDescription>\n              Configure exam settings and add questions\n            </DialogDescription>\n          </DialogHeader>\n\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"title\">Exam Title *</Label>\n                <Input\n                  id=\"title\"\n                  name=\"title\"\n                  placeholder=\"e.g., Mathematics Final Exam\"\n                  required\n                  data-testid=\"input-exam-title\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"description\">Description</Label>\n                <Textarea\n                  id=\"description\"\n                  name=\"description\"\n                  placeholder=\"Brief description of the exam\"\n                  rows={3}\n                  data-testid=\"input-exam-description\"\n                />\n              </div>\n\n              <div className=\"grid gap-4 md:grid-cols-2\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"domainId\">Domain *</Label>\n                  <Select \n                    name=\"domainId\" \n                    required \n                    onValueChange={(value) => setSelectedDomain(parseInt(value))}\n                  >\n                    <SelectTrigger data-testid=\"select-domain\">\n                      <SelectValue placeholder=\"Select domain\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {domains?.map((domain) => (\n                        <SelectItem key={domain.id} value={domain.id.toString()}>\n                          {domain.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"duration\">Duration (minutes) *</Label>\n                  <Input\n                    id=\"duration\"\n                    name=\"duration\"\n                    type=\"number\"\n                    min=\"1\"\n                    placeholder=\"60\"\n                    required\n                    data-testid=\"input-exam-duration\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"grid gap-4 md:grid-cols-2\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"questionCount\">Number of Questions *</Label>\n                  <Input\n                    id=\"questionCount\"\n                    name=\"questionCount\"\n                    type=\"number\"\n                    min=\"1\"\n                    placeholder=\"20\"\n                    required\n                    data-testid=\"input-question-count\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"showResults\">Result Visibility *</Label>\n                  <Select name=\"showResults\" defaultValue=\"delayed\" required>\n                    <SelectTrigger data-testid=\"select-show-results\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"immediate\">Immediate</SelectItem>\n                      <SelectItem value=\"delayed\">Delayed</SelectItem>\n                      <SelectItem value=\"hidden\">Hidden</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              <div className=\"space-y-4 pt-4 border-t\">\n                <h4 className=\"font-medium\">Proctoring Settings</h4>\n                \n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-0.5\">\n                    <Label htmlFor=\"enableWebcam\">Webcam Monitoring</Label>\n                    <p className=\"text-sm text-muted-foreground\">\n                      Enable face detection and presence monitoring\n                    </p>\n                  </div>\n                  <Switch id=\"enableWebcam\" name=\"enableWebcam\" defaultChecked data-testid=\"switch-webcam\" />\n                </div>\n\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-0.5\">\n                    <Label htmlFor=\"enableTabDetection\">Tab Switch Detection</Label>\n                    <p className=\"text-sm text-muted-foreground\">\n                      Monitor and log when candidates switch tabs\n                    </p>\n                  </div>\n                  <Switch id=\"enableTabDetection\" name=\"enableTabDetection\" defaultChecked data-testid=\"switch-tab-detection\" />\n                </div>\n              </div>\n\n              <div className=\"space-y-4 pt-4 border-t\">\n                <h4 className=\"font-medium\">Question Generation</h4>\n                \n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-0.5\">\n                    <Label htmlFor=\"useAI\">Generate Questions with AI</Label>\n                    <p className=\"text-sm text-muted-foreground\">\n                      Use AI to automatically generate exam questions\n                    </p>\n                  </div>\n                  <Switch \n                    id=\"useAI\" \n                    checked={useAI}\n                    onCheckedChange={setUseAI}\n                    disabled={!selectedDomain}\n                    data-testid=\"switch-use-ai\" \n                  />\n                </div>\n\n                {useAI && (\n                  <div className=\"space-y-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"aiQuestionCount\">Number of AI Questions</Label>\n                      <Input\n                        id=\"aiQuestionCount\"\n                        type=\"number\"\n                        min=\"1\"\n                        max=\"50\"\n                        value={aiQuestionCount}\n                        onChange={(e) => setAiQuestionCount(parseInt(e.target.value) || 5)}\n                        placeholder=\"5\"\n                        data-testid=\"input-ai-question-count\"\n                      />\n                    </div>\n                    \n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"document\">Upload Document (Optional)</Label>\n                      <p className=\"text-sm text-muted-foreground mb-2\">\n                        Upload a PDF, Word, or PowerPoint document to generate questions based on its content\n                      </p>\n                      {!uploadedDocName ? (\n                        <div className=\"flex items-center gap-2\">\n                          <Input\n                            id=\"document\"\n                            type=\"file\"\n                            accept=\".pdf,.doc,.docx,.ppt,.pptx\"\n                            onChange={handleDocumentUpload}\n                            disabled={isUploadingDoc}\n                            data-testid=\"input-document-upload\"\n                          />\n                          {isUploadingDoc && <span className=\"text-sm text-muted-foreground\">Uploading...</span>}\n                        </div>\n                      ) : (\n                        <div className=\"flex items-center gap-2 p-2 border rounded-md bg-muted\">\n                          <FileText className=\"h-4 w-4 text-muted-foreground\" />\n                          <span className=\"text-sm flex-1\">{uploadedDocName}</span>\n                          <Button\n                            type=\"button\"\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={clearDocument}\n                            data-testid=\"button-clear-document\"\n                          >\n                            <X className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      )}\n                      <p className=\"text-sm text-muted-foreground\">\n                        {documentContent \n                          ? \"Questions will be generated from the uploaded document content\" \n                          : \"Without a document, AI will generate questions based on exam title, domain, and description\"}\n                      </p>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"space-y-4 pt-4 border-t\">\n                <div className=\"flex items-center justify-between\">\n                  <h4 className=\"font-medium\">Manual Questions</h4>\n                  <Button \n                    type=\"button\" \n                    variant=\"outline\" \n                    size=\"sm\"\n                    onClick={addQuestion}\n                    disabled={!selectedDomain}\n                    data-testid=\"button-add-question\"\n                  >\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Add Question\n                  </Button>\n                </div>\n\n                {!selectedDomain && (\n                  <p className=\"text-sm text-muted-foreground\">\n                    Select a domain first to add questions\n                  </p>\n                )}\n\n                {questions.length > 0 && (\n                  <div className=\"space-y-4\">\n                    {questions.map((question, qIndex) => (\n                      <Card key={qIndex} className=\"p-4\" data-testid={`question-builder-${qIndex}`}>\n                        <div className=\"space-y-4\">\n                          <div className=\"flex items-start justify-between gap-2\">\n                            <h5 className=\"font-medium\">Question {qIndex + 1}</h5>\n                            <Button\n                              type=\"button\"\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              onClick={() => removeQuestion(qIndex)}\n                              data-testid={`button-remove-question-${qIndex}`}\n                            >\n                              <X className=\"h-4 w-4\" />\n                            </Button>\n                          </div>\n\n                          <div className=\"space-y-2\">\n                            <Label>Question Type</Label>\n                            <Select\n                              value={question.type}\n                              onValueChange={(value) => updateQuestion(qIndex, \"type\", value)}\n                            >\n                              <SelectTrigger data-testid={`select-question-type-${qIndex}`}>\n                                <SelectValue />\n                              </SelectTrigger>\n                              <SelectContent>\n                                <SelectItem value=\"multiple_choice\">Multiple Choice</SelectItem>\n                                <SelectItem value=\"true_false\">True/False</SelectItem>\n                              </SelectContent>\n                            </Select>\n                          </div>\n\n                          <div className=\"space-y-2\">\n                            <Label>Question Content *</Label>\n                            <Textarea\n                              value={question.content}\n                              onChange={(e) => updateQuestion(qIndex, \"content\", e.target.value)}\n                              placeholder=\"Enter your question here...\"\n                              rows={3}\n                              required\n                              data-testid={`textarea-question-content-${qIndex}`}\n                            />\n                          </div>\n\n                          <div className=\"space-y-2\">\n                            <Label>Options</Label>\n                            {question.type === \"true_false\" ? (\n                              <div className=\"space-y-2\">\n                                <Input value=\"True\" disabled />\n                                <Input value=\"False\" disabled />\n                              </div>\n                            ) : (\n                              <div className=\"space-y-2\">\n                                {question.options.map((option, oIndex) => (\n                                  <Input\n                                    key={oIndex}\n                                    value={option}\n                                    onChange={(e) => updateQuestionOption(qIndex, oIndex, e.target.value)}\n                                    placeholder={`Option ${oIndex + 1}`}\n                                    data-testid={`input-question-option-${qIndex}-${oIndex}`}\n                                  />\n                                ))}\n                              </div>\n                            )}\n                          </div>\n\n                          <div className=\"space-y-2\">\n                            <Label>Correct Answer *</Label>\n                            <Select\n                              value={question.correctAnswer}\n                              onValueChange={(value) => updateQuestion(qIndex, \"correctAnswer\", value)}\n                              required\n                            >\n                              <SelectTrigger data-testid={`select-correct-answer-${qIndex}`}>\n                                <SelectValue placeholder=\"Select correct answer\" />\n                              </SelectTrigger>\n                              <SelectContent>\n                                {question.type === \"true_false\" ? (\n                                  <>\n                                    <SelectItem value=\"True\">True</SelectItem>\n                                    <SelectItem value=\"False\">False</SelectItem>\n                                  </>\n                                ) : (\n                                  question.options\n                                    .filter(opt => opt.trim() !== \"\")\n                                    .map((option, idx) => (\n                                      <SelectItem key={idx} value={option}>\n                                        {option}\n                                      </SelectItem>\n                                    ))\n                                )}\n                              </SelectContent>\n                            </Select>\n                          </div>\n                        </div>\n                      </Card>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <DialogFooter>\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={() => {\n                  setIsCreateOpen(false);\n                  setQuestions([]);\n                  setSelectedDomain(null);\n                }}\n                data-testid=\"button-cancel\"\n              >\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={createMutation.isPending} data-testid=\"button-submit-exam\">\n                {createMutation.isPending ? \"Creating...\" : \"Create Exam\"}\n              </Button>\n            </DialogFooter>\n          </form>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation Dialog */}\n      <Dialog open={examToDelete !== null} onOpenChange={() => setExamToDelete(null)}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Delete Exam</DialogTitle>\n            <DialogDescription>\n              Are you sure you want to delete this exam? This action cannot be undone.\n              All associated candidates, responses, and proctoring logs will also be deleted.\n            </DialogDescription>\n          </DialogHeader>\n          <DialogFooter>\n            <Button \n              variant=\"outline\" \n              onClick={() => setExamToDelete(null)}\n              data-testid=\"button-cancel-delete\"\n            >\n              Cancel\n            </Button>\n            <Button \n              variant=\"destructive\" \n              onClick={() => examToDelete && deleteMutation.mutate(examToDelete)}\n              disabled={deleteMutation.isPending}\n              data-testid=\"button-confirm-delete-exam\"\n            >\n              {deleteMutation.isPending ? \"Deleting...\" : \"Delete\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":27374},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"server/db.ts":{"content":"// Database configuration using Drizzle ORM with PostgreSQL\nimport { Pool } from 'pg';\nimport { drizzle } from 'drizzle-orm/node-postgres';\nimport * as schema from \"@shared/schema\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle(pool, { schema });\n","size_bytes":439},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n    isAdmin: user?.role === \"admin\",\n    isCandidate: user?.role === \"candidate\",\n  };\n}\n","size_bytes":389},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<any> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return await res.json();\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1391},"client/src/pages/candidate/pre-exam-check.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { CheckCircle, XCircle, Camera, Mic, Chrome } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface SystemCheck {\n  name: string;\n  status: \"checking\" | \"passed\" | \"failed\";\n  icon: any;\n  message: string;\n}\n\nexport default function PreExamCheck({ \n  examTitle, \n  onStart,\n  isStarting = false\n}: { \n  examTitle: string; \n  onStart: () => void;\n  isStarting?: boolean;\n}) {\n  const [checks, setChecks] = useState<SystemCheck[]>([\n    { name: \"Camera Access\", status: \"checking\", icon: Camera, message: \"Checking camera...\" },\n    { name: \"Microphone Access\", status: \"checking\", icon: Mic, message: \"Checking microphone...\" },\n    { name: \"Browser Compatibility\", status: \"checking\", icon: Chrome, message: \"Checking browser...\" },\n  ]);\n  const [allPassed, setAllPassed] = useState(false);\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const { toast } = useToast();\n\n  useEffect(() => {\n    checkSystems();\n  }, []);\n\n  const checkSystems = async () => {\n    // Check camera\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n      }\n      updateCheck(\"Camera Access\", \"passed\", \"Camera working properly\");\n      \n      // Stop the stream after check\n      setTimeout(() => {\n        stream.getTracks().forEach(track => track.stop());\n      }, 2000);\n    } catch (error) {\n      updateCheck(\"Camera Access\", \"failed\", \"Camera access denied or unavailable\");\n    }\n\n    // Check microphone\n    try {\n      await navigator.mediaDevices.getUserMedia({ audio: true });\n      updateCheck(\"Microphone Access\", \"passed\", \"Microphone working properly\");\n    } catch (error) {\n      updateCheck(\"Microphone Access\", \"failed\", \"Microphone access denied or unavailable\");\n    }\n\n    // Check browser\n    const isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\n    const isFirefox = /Firefox/.test(navigator.userAgent);\n    const isEdge = /Edg/.test(navigator.userAgent);\n\n    if (isChrome || isFirefox || isEdge) {\n      updateCheck(\"Browser Compatibility\", \"passed\", \"Browser is compatible\");\n    } else {\n      updateCheck(\"Browser Compatibility\", \"failed\", \"Please use Chrome, Firefox, or Edge\");\n    }\n  };\n\n  const updateCheck = (name: string, status: \"passed\" | \"failed\", message: string) => {\n    setChecks(prev => {\n      const updated = prev.map(check =>\n        check.name === name ? { ...check, status, message } : check\n      );\n      \n      // Check if all passed\n      const allChecksPassed = updated.every(check => check.status === \"passed\");\n      setAllPassed(allChecksPassed);\n      \n      return updated;\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4 sm:p-6\">\n      <Card className=\"max-w-2xl w-full p-4 sm:p-8\">\n        <div className=\"text-center mb-6 sm:mb-8\">\n          <h1 className=\"text-xl sm:text-2xl font-semibold mb-2\" data-testid=\"text-exam-title\">\n            {examTitle}\n          </h1>\n          <p className=\"text-sm sm:text-base text-muted-foreground\" data-testid=\"text-system-check\">\n            System Compatibility Check\n          </p>\n        </div>\n\n        <div className=\"space-y-3 sm:space-y-4 mb-6 sm:mb-8\">\n          {checks.map((check) => {\n            const Icon = check.icon;\n            const StatusIcon = check.status === \"passed\" ? CheckCircle : check.status === \"failed\" ? XCircle : null;\n\n            return (\n              <div\n                key={check.name}\n                className=\"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-lg border border-border\"\n                data-testid={`check-${check.name.toLowerCase().replace(/\\s/g, \"-\")}`}\n              >\n                <div className={`h-10 w-10 sm:h-12 sm:w-12 rounded-lg flex items-center justify-center flex-shrink-0 ${\n                  check.status === \"passed\" ? \"bg-chart-2/10\" :\n                  check.status === \"failed\" ? \"bg-destructive/10\" :\n                  \"bg-muted\"\n                }`}>\n                  <Icon className={`h-5 w-5 sm:h-6 sm:w-6 ${\n                    check.status === \"passed\" ? \"text-chart-2\" :\n                    check.status === \"failed\" ? \"text-destructive\" :\n                    \"text-muted-foreground\"\n                  }`} />\n                </div>\n\n                <div className=\"flex-1 min-w-0\">\n                  <p className=\"font-medium text-sm sm:text-base\">{check.name}</p>\n                  <p className={`text-xs sm:text-sm ${\n                    check.status === \"passed\" ? \"text-chart-2\" :\n                    check.status === \"failed\" ? \"text-destructive\" :\n                    \"text-muted-foreground\"\n                  }`}>\n                    {check.message}\n                  </p>\n                </div>\n\n                {StatusIcon && (\n                  <StatusIcon className={`h-5 w-5 ${\n                    check.status === \"passed\" ? \"text-chart-2\" : \"text-destructive\"\n                  }`} />\n                )}\n              </div>\n            );\n          })}\n        </div>\n\n        {/* Camera Preview */}\n        <div className=\"mb-8\">\n          <p className=\"text-sm font-medium mb-2\">Camera Preview</p>\n          <div className=\"aspect-video bg-muted rounded-lg overflow-hidden\">\n            <video\n              ref={videoRef}\n              autoPlay\n              playsInline\n              muted\n              className=\"w-full h-full object-cover\"\n              data-testid=\"video-preview\"\n            />\n          </div>\n        </div>\n\n        {/* Instructions */}\n        <div className=\"bg-muted/50 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6\">\n          <h3 className=\"font-medium text-sm sm:text-base mb-2\">Before you start:</h3>\n          <ul className=\"text-xs sm:text-sm text-muted-foreground space-y-1\">\n            <li> Ensure you are in a quiet, well-lit environment</li>\n            <li> Do not switch tabs or leave the exam window</li>\n            <li> Keep your face visible to the camera at all times</li>\n            <li> The exam will auto-submit when time expires</li>\n          </ul>\n        </div>\n\n        <Button\n          className=\"w-full\"\n          size=\"lg\"\n          disabled={!allPassed || isStarting}\n          onClick={onStart}\n          data-testid=\"button-start-exam\"\n        >\n          {isStarting ? \"Starting Exam...\" : allPassed ? \"Start Exam\" : \"System Check In Progress...\"}\n        </Button>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":6649},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"server/storage.ts":{"content":"// Storage layer using DatabaseStorage with PostgreSQL (referenced from javascript_database blueprint)\nimport {\n  users,\n  domains,\n  questions,\n  exams,\n  examQuestions,\n  candidates,\n  responses,\n  proctorLogs,\n  type User,\n  type UpsertUser,\n  type Domain,\n  type InsertDomain,\n  type Question,\n  type InsertQuestion,\n  type Exam,\n  type InsertExam,\n  type Candidate,\n  type InsertCandidate,\n  type Response,\n  type InsertResponse,\n  type ProctorLog,\n  type InsertProctorLog,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, desc } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // User operations\n  getUser(id: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  getUserByInvitationToken(token: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  createUser(user: UpsertUser): Promise<User>;\n  setUserPassword(id: string, passwordHash: string): Promise<User>;\n  setInvitationToken(id: string, token: string): Promise<User>;\n  getAllUsers(): Promise<User[]>;\n  getAdministrators(): Promise<User[]>;\n  updateUser(id: string, data: Partial<UpsertUser>): Promise<User>;\n  updateUserRole(id: string, role: \"admin\" | \"candidate\"): Promise<User>;\n  deleteUser(id: string): Promise<boolean>;\n  setResetPasswordToken(id: string, token: string, expiry: Date): Promise<User>;\n  clearResetPasswordToken(id: string): Promise<User>;\n\n  // Domain operations\n  getDomains(): Promise<Domain[]>;\n  getDomain(id: number): Promise<Domain | undefined>;\n  createDomain(domain: InsertDomain): Promise<Domain>;\n\n  // Question operations\n  getQuestions(): Promise<Question[]>;\n  getQuestionsByDomain(domainId: number): Promise<Question[]>;\n  getQuestion(id: number): Promise<Question | undefined>;\n  createQuestion(question: InsertQuestion): Promise<Question>;\n  updateQuestion(id: number, question: InsertQuestion): Promise<Question | undefined>;\n  deleteQuestion(id: number): Promise<void>;\n\n  // Exam operations\n  getExams(): Promise<Exam[]>;\n  getExam(id: number): Promise<Exam | undefined>;\n  createExam(exam: InsertExam): Promise<Exam>;\n  createExamWithQuestions(exam: InsertExam, questions: InsertQuestion[]): Promise<Exam>;\n  updateExam(id: number, exam: Partial<InsertExam>): Promise<Exam>;\n  getExamQuestions(examId: number): Promise<Question[]>;\n  addQuestionsToExam(examId: number, questions: InsertQuestion[]): Promise<void>;\n  deleteExam(id: number): Promise<void>;\n\n  // Candidate operations\n  getCandidates(): Promise<Candidate[]>;\n  getCandidate(id: number): Promise<Candidate | undefined>;\n  getCandidatesByUser(userId: string): Promise<Candidate[]>;\n  getCandidatesByExam(examId: number): Promise<Candidate[]>;\n  createCandidate(candidate: InsertCandidate): Promise<Candidate>;\n  updateCandidate(id: number, candidate: Partial<InsertCandidate>): Promise<Candidate>;\n  deleteCandidate(id: number): Promise<void>;\n\n  // Response operations\n  getResponses(candidateId: number): Promise<Response[]>;\n  createResponse(response: InsertResponse): Promise<Response>;\n  updateResponse(id: number, response: Partial<InsertResponse>): Promise<Response>;\n\n  // Proctor log operations\n  getProctorLogs(candidateId?: number): Promise<ProctorLog[]>;\n  createProctorLog(log: InsertProctorLog): Promise<ProctorLog>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // User operations\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user;\n  }\n\n  async getUserByInvitationToken(token: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.invitationToken, token));\n    return user;\n  }\n\n  async createUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db.insert(users).values(userData).returning();\n    return user;\n  }\n\n  async setUserPassword(id: string, passwordHash: string): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({ \n        passwordHash, \n        invitationToken: null,\n        invitedAt: null,\n        updatedAt: new Date() \n      })\n      .where(eq(users.id, id))\n      .returning();\n    return user;\n  }\n\n  async setInvitationToken(id: string, token: string): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({ \n        invitationToken: token,\n        invitedAt: new Date(),\n        updatedAt: new Date() \n      })\n      .where(eq(users.id, id))\n      .returning();\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const existingByEmail = await this.getUserByEmail(userData.email!);\n    \n    if (existingByEmail && existingByEmail.id !== userData.id) {\n      const [updated] = await db\n        .update(users)\n        .set({\n          ...userData,\n          updatedAt: new Date(),\n        })\n        .where(eq(users.id, existingByEmail.id))\n        .returning();\n      return updated;\n    }\n    \n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  async getAllUsers(): Promise<User[]> {\n    return await db.select().from(users);\n  }\n\n  async updateUser(id: string, data: Partial<UpsertUser>): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({ ...data, updatedAt: new Date() })\n      .where(eq(users.id, id))\n      .returning();\n    return user;\n  }\n\n  async updateUserRole(id: string, role: \"admin\" | \"candidate\"): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({ role, updatedAt: new Date() })\n      .where(eq(users.id, id))\n      .returning();\n    return user;\n  }\n\n  async getAdministrators(): Promise<User[]> {\n    return await db.select().from(users).where(eq(users.role, \"admin\"));\n  }\n\n  async deleteUser(id: string): Promise<boolean> {\n    const result = await db.delete(users).where(eq(users.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async setResetPasswordToken(id: string, token: string, expiry: Date): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({ resetPasswordToken: token, resetPasswordExpiry: expiry, updatedAt: new Date() })\n      .where(eq(users.id, id))\n      .returning();\n    return user;\n  }\n\n  async clearResetPasswordToken(id: string): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({ resetPasswordToken: null, resetPasswordExpiry: null, updatedAt: new Date() })\n      .where(eq(users.id, id))\n      .returning();\n    return user;\n  }\n\n  // Domain operations\n  async getDomains(): Promise<Domain[]> {\n    return await db.select().from(domains).orderBy(desc(domains.createdAt));\n  }\n\n  async getDomain(id: number): Promise<Domain | undefined> {\n    const [domain] = await db.select().from(domains).where(eq(domains.id, id));\n    return domain;\n  }\n\n  async createDomain(domainData: InsertDomain): Promise<Domain> {\n    const [domain] = await db\n      .insert(domains)\n      .values(domainData)\n      .returning();\n    return domain;\n  }\n\n  // Question operations\n  async getQuestions(): Promise<Question[]> {\n    return await db.select().from(questions).orderBy(desc(questions.createdAt));\n  }\n\n  async getQuestionsByDomain(domainId: number): Promise<Question[]> {\n    return await db\n      .select()\n      .from(questions)\n      .where(eq(questions.domainId, domainId))\n      .orderBy(desc(questions.createdAt));\n  }\n\n  async getQuestion(id: number): Promise<Question | undefined> {\n    const [question] = await db.select().from(questions).where(eq(questions.id, id));\n    return question;\n  }\n\n  async createQuestion(questionData: InsertQuestion): Promise<Question> {\n    const [question] = await db\n      .insert(questions)\n      .values({\n        ...questionData,\n        options: questionData.options as any,\n      })\n      .returning();\n    return question;\n  }\n\n  async updateQuestion(id: number, questionData: InsertQuestion): Promise<Question | undefined> {\n    const [question] = await db\n      .update(questions)\n      .set({\n        ...questionData,\n        options: questionData.options as any,\n      })\n      .where(eq(questions.id, id))\n      .returning();\n    return question;\n  }\n\n  async deleteQuestion(id: number): Promise<void> {\n    await db.delete(questions).where(eq(questions.id, id));\n  }\n\n  // Exam operations\n  async getExams(): Promise<Exam[]> {\n    return await db.select().from(exams).orderBy(desc(exams.createdAt));\n  }\n\n  async getExam(id: number): Promise<Exam | undefined> {\n    const [exam] = await db.select().from(exams).where(eq(exams.id, id));\n    return exam;\n  }\n\n  async createExam(examData: InsertExam): Promise<Exam> {\n    const [exam] = await db\n      .insert(exams)\n      .values(examData)\n      .returning();\n    return exam;\n  }\n\n  async createExamWithQuestions(examData: InsertExam, questionsData: InsertQuestion[]): Promise<Exam> {\n    const exam = await db.transaction(async (tx) => {\n      const [newExam] = await tx\n        .insert(exams)\n        .values(examData)\n        .returning();\n      \n      if (questionsData && questionsData.length > 0) {\n        const createdQuestions = await tx\n          .insert(questions)\n          .values(questionsData.map(q => ({\n            ...q,\n            options: q.options as any,\n          })))\n          .returning();\n        \n        const examQuestionLinks = createdQuestions.map((q, index) => ({\n          examId: newExam.id,\n          questionId: q.id,\n          orderIndex: index,\n        }));\n        \n        await tx.insert(examQuestions).values(examQuestionLinks);\n      }\n      \n      return newExam;\n    });\n    \n    return exam;\n  }\n\n  async updateExam(id: number, examData: Partial<InsertExam>): Promise<Exam> {\n    const [exam] = await db\n      .update(exams)\n      .set(examData)\n      .where(eq(exams.id, id))\n      .returning();\n    return exam;\n  }\n\n  async deleteExam(id: number): Promise<void> {\n    await db.transaction(async (tx) => {\n      // Delete all exam_questions links first\n      await tx.delete(examQuestions).where(eq(examQuestions.examId, id));\n      \n      // Delete all candidates and their related data\n      const candidatesToDelete = await tx\n        .select()\n        .from(candidates)\n        .where(eq(candidates.examId, id));\n      \n      for (const candidate of candidatesToDelete) {\n        // Delete responses\n        await tx.delete(responses).where(eq(responses.candidateId, candidate.id));\n        // Delete proctor logs\n        await tx.delete(proctorLogs).where(eq(proctorLogs.candidateId, candidate.id));\n      }\n      \n      // Delete candidates\n      await tx.delete(candidates).where(eq(candidates.examId, id));\n      \n      // Finally delete the exam\n      await tx.delete(exams).where(eq(exams.id, id));\n    });\n  }\n\n  async getExamQuestions(examId: number): Promise<Question[]> {\n    const result = await db\n      .select({\n        question: questions,\n        orderIndex: examQuestions.orderIndex,\n      })\n      .from(examQuestions)\n      .innerJoin(questions, eq(examQuestions.questionId, questions.id))\n      .where(eq(examQuestions.examId, examId))\n      .orderBy(examQuestions.orderIndex);\n    \n    return result.map(r => r.question);\n  }\n\n  async addQuestionsToExam(examId: number, questionsData: InsertQuestion[]): Promise<void> {\n    await db.transaction(async (tx) => {\n      const existingLinks = await tx\n        .select()\n        .from(examQuestions)\n        .where(eq(examQuestions.examId, examId));\n      \n      const nextOrderIndex = existingLinks.length;\n      \n      const createdQuestions = await tx\n        .insert(questions)\n        .values(questionsData.map(q => ({\n          ...q,\n          options: q.options as any,\n        })))\n        .returning();\n      \n      const examQuestionLinks = createdQuestions.map((q, index) => ({\n        examId: examId,\n        questionId: q.id,\n        orderIndex: nextOrderIndex + index,\n      }));\n      \n      await tx.insert(examQuestions).values(examQuestionLinks);\n      \n      const newQuestionCount = existingLinks.length + createdQuestions.length;\n      await tx\n        .update(exams)\n        .set({ questionCount: newQuestionCount })\n        .where(eq(exams.id, examId));\n    });\n  }\n\n  // Candidate operations\n  async getCandidates(): Promise<Candidate[]> {\n    return await db.select().from(candidates);\n  }\n\n  async getCandidate(id: number): Promise<Candidate | undefined> {\n    const [candidate] = await db.select().from(candidates).where(eq(candidates.id, id));\n    return candidate;\n  }\n\n  async getCandidatesByUser(userId: string): Promise<Candidate[]> {\n    return await db\n      .select()\n      .from(candidates)\n      .where(eq(candidates.userId, userId));\n  }\n\n  async getCandidatesByExam(examId: number): Promise<Candidate[]> {\n    return await db\n      .select()\n      .from(candidates)\n      .where(eq(candidates.examId, examId));\n  }\n\n  async createCandidate(candidateData: InsertCandidate): Promise<Candidate> {\n    const [candidate] = await db\n      .insert(candidates)\n      .values(candidateData)\n      .returning();\n    return candidate;\n  }\n\n  async updateCandidate(id: number, candidateData: Partial<InsertCandidate>): Promise<Candidate> {\n    const [candidate] = await db\n      .update(candidates)\n      .set(candidateData)\n      .where(eq(candidates.id, id))\n      .returning();\n    return candidate;\n  }\n\n  async deleteCandidate(id: number): Promise<void> {\n    await db.transaction(async (tx) => {\n      // Delete responses first\n      await tx.delete(responses).where(eq(responses.candidateId, id));\n      // Delete proctor logs\n      await tx.delete(proctorLogs).where(eq(proctorLogs.candidateId, id));\n      // Delete the candidate\n      await tx.delete(candidates).where(eq(candidates.id, id));\n    });\n  }\n\n  // Response operations\n  async getResponses(candidateId: number): Promise<Response[]> {\n    return await db\n      .select()\n      .from(responses)\n      .where(eq(responses.candidateId, candidateId));\n  }\n\n  async createResponse(responseData: InsertResponse): Promise<Response> {\n    const [response] = await db\n      .insert(responses)\n      .values(responseData)\n      .returning();\n    return response;\n  }\n\n  async updateResponse(id: number, responseData: Partial<InsertResponse>): Promise<Response> {\n    const [response] = await db\n      .update(responses)\n      .set(responseData)\n      .where(eq(responses.id, id))\n      .returning();\n    return response;\n  }\n\n  // Proctor log operations\n  async getProctorLogs(candidateId?: number): Promise<ProctorLog[]> {\n    if (candidateId) {\n      return await db\n        .select()\n        .from(proctorLogs)\n        .where(eq(proctorLogs.candidateId, candidateId))\n        .orderBy(desc(proctorLogs.timestamp));\n    }\n    return await db.select().from(proctorLogs).orderBy(desc(proctorLogs.timestamp));\n  }\n\n  async createProctorLog(logData: InsertProctorLog): Promise<ProctorLog> {\n    const [log] = await db\n      .insert(proctorLogs)\n      .values(logData)\n      .returning();\n    return log;\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":15350},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/pages/admin/dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { FileText, Users, AlertTriangle, CheckCircle } from \"lucide-react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nexport default function AdminDashboard() {\n  const { data: stats, isLoading } = useQuery({\n    queryKey: [\"/api/admin/stats\"],\n  });\n\n  const statCards = [\n    {\n      title: \"Active Exams\",\n      value: stats?.activeExams || 0,\n      icon: FileText,\n      color: \"text-primary\",\n      bgColor: \"bg-primary/10\",\n      testId: \"stat-active-exams\"\n    },\n    {\n      title: \"Total Candidates\",\n      value: stats?.totalCandidates || 0,\n      icon: Users,\n      color: \"text-chart-2\",\n      bgColor: \"bg-chart-2/10\",\n      testId: \"stat-total-candidates\"\n    },\n    {\n      title: \"Flagged Incidents\",\n      value: stats?.flaggedIncidents || 0,\n      icon: AlertTriangle,\n      color: \"text-destructive\",\n      bgColor: \"bg-destructive/10\",\n      testId: \"stat-flagged-incidents\"\n    },\n    {\n      title: \"Completion Rate\",\n      value: `${stats?.completionRate || 0}%`,\n      icon: CheckCircle,\n      color: \"text-chart-2\",\n      bgColor: \"bg-chart-2/10\",\n      testId: \"stat-completion-rate\"\n    },\n  ];\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-semibold mb-2\" data-testid=\"text-page-title\">Dashboard</h1>\n        <p className=\"text-muted-foreground\" data-testid=\"text-page-description\">\n          Overview of your examination system\n        </p>\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-4\">\n        {statCards.map((stat) => (\n          <Card key={stat.title}>\n            <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">{stat.title}</CardTitle>\n              <div className={`h-8 w-8 rounded-lg ${stat.bgColor} flex items-center justify-center`}>\n                <stat.icon className={`h-4 w-4 ${stat.color}`} />\n              </div>\n            </CardHeader>\n            <CardContent>\n              {isLoading ? (\n                <Skeleton className=\"h-8 w-20\" />\n              ) : (\n                <div className=\"text-2xl font-bold\" data-testid={stat.testId}>\n                  {stat.value}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <div className=\"grid gap-6 lg:grid-cols-2\">\n        <Card>\n          <CardHeader>\n            <CardTitle>Recent Exams</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3].map((i) => (\n                  <Skeleton key={i} className=\"h-16 w-full\" />\n                ))}\n              </div>\n            ) : stats?.recentExams?.length ? (\n              <div className=\"space-y-3\">\n                {stats.recentExams.map((exam: any) => (\n                  <div\n                    key={exam.id}\n                    className=\"flex items-center justify-between p-3 rounded-lg border border-border hover-elevate\"\n                    data-testid={`exam-item-${exam.id}`}\n                  >\n                    <div>\n                      <p className=\"font-medium\">{exam.title}</p>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {exam.candidateCount} candidates\n                      </p>\n                    </div>\n                    <div className={`px-2 py-1 rounded-md text-xs font-medium ${\n                      exam.status === 'active' \n                        ? 'bg-chart-2/10 text-chart-2' \n                        : 'bg-muted text-muted-foreground'\n                    }`}>\n                      {exam.status}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-sm text-muted-foreground text-center py-8\" data-testid=\"text-no-exams\">\n                No exams created yet\n              </p>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Recent Activity</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3].map((i) => (\n                  <Skeleton key={i} className=\"h-16 w-full\" />\n                ))}\n              </div>\n            ) : stats?.recentActivity?.length ? (\n              <div className=\"space-y-3\">\n                {stats.recentActivity.map((activity: any, index: number) => (\n                  <div\n                    key={index}\n                    className=\"flex items-start gap-3 p-3 rounded-lg border border-border\"\n                    data-testid={`activity-item-${index}`}\n                  >\n                    <div className={`h-2 w-2 rounded-full mt-2 ${\n                      activity.severity === 'high' ? 'bg-destructive' :\n                      activity.severity === 'medium' ? 'bg-chart-4' :\n                      'bg-chart-2'\n                    }`} />\n                    <div className=\"flex-1\">\n                      <p className=\"text-sm font-medium\">{activity.message}</p>\n                      <p className=\"text-xs text-muted-foreground\">{activity.timestamp}</p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-sm text-muted-foreground text-center py-8\" data-testid=\"text-no-activity\">\n                No recent activity\n              </p>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5744},"design_guidelines.md":{"content":"# WokkahCBT Design Guidelines\n\n## Design Approach\n\n**Selected Approach:** Design System - Professional Dashboard Pattern\n**Justification:** WokkahCBT is a utility-focused, information-dense application requiring clarity, trust, and efficiency. Drawing inspiration from Linear, Notion, and enterprise dashboards for clean data presentation and professional aesthetics.\n\n## Core Design Principles\n\n1. **Clarity Over Decoration** - Information hierarchy guides every decision\n2. **Trust Through Professionalism** - Clean, secure aesthetics reinforce platform integrity\n3. **Efficiency First** - Minimize cognitive load for both admins and candidates\n4. **Contextual Emphasis** - Highlight critical actions (Start Exam, Submit, Alerts) appropriately\n\n---\n\n## Color Palette\n\n### Light Mode\n- **Primary:** 217 91% 60% (Professional Blue - trust and security)\n- **Primary Hover:** 217 91% 50%\n- **Secondary:** 142 76% 36% (Green - success states, completion)\n- **Background:** 0 0% 100% (Pure white)\n- **Surface:** 210 20% 98% (Subtle gray for cards)\n- **Border:** 214 32% 91% (Soft borders)\n- **Text Primary:** 222 47% 11% (Near black)\n- **Text Secondary:** 215 16% 47% (Muted gray)\n\n### Dark Mode\n- **Primary:** 217 91% 60%\n- **Primary Hover:** 217 91% 70%\n- **Secondary:** 142 76% 45%\n- **Background:** 222 47% 11%\n- **Surface:** 217 33% 17%\n- **Border:** 215 28% 25%\n- **Text Primary:** 210 20% 98%\n- **Text Secondary:** 215 20% 65%\n\n### Status Colors\n- **Success:** 142 76% 36%\n- **Warning:** 38 92% 50%\n- **Danger:** 0 84% 60%\n- **Info:** 199 89% 48%\n\n### Proctoring Alert Colors\n- **Low Severity:** 45 93% 47% (Amber)\n- **Medium Severity:** 24 100% 50% (Orange)\n- **High Severity:** 0 84% 60% (Red)\n\n---\n\n## Typography\n\n**Font Families:**\n- **Primary:** 'Inter', system-ui, sans-serif (body, UI elements)\n- **Monospace:** 'JetBrains Mono', monospace (codes, IDs, technical data)\n\n**Type Scale:**\n- **Display:** text-5xl font-bold (Admin dashboard headers)\n- **H1:** text-3xl font-semibold (Page titles)\n- **H2:** text-2xl font-semibold (Section headers)\n- **H3:** text-xl font-medium (Card titles)\n- **Body Large:** text-base font-normal (Primary content)\n- **Body:** text-sm font-normal (Secondary content)\n- **Caption:** text-xs font-medium (Labels, metadata)\n\n**Font Weights:**\n- Regular: 400 (body text)\n- Medium: 500 (labels, navigation)\n- Semibold: 600 (headings, emphasis)\n- Bold: 700 (critical actions)\n\n---\n\n## Layout System\n\n**Spacing Units:** Use Tailwind spacing of 2, 4, 6, 8, 12, 16, 24 for consistency\n- Micro spacing: p-2, gap-2 (tight elements)\n- Component spacing: p-4, gap-4 (cards, buttons)\n- Section spacing: p-6 to p-8 (page sections)\n- Major spacing: mb-12, mt-16 (page divisions)\n\n**Grid System:**\n- Admin Dashboard: 12-column grid with responsive breakpoints\n- Exam Interface: Centered single column (max-w-4xl)\n- Monitoring: Multi-column flexible grid (2-4 columns based on screen)\n\n**Container Widths:**\n- Full-width dashboards: max-w-7xl\n- Forms and exams: max-w-3xl\n- Settings panels: max-w-5xl\n\n---\n\n## Component Library\n\n### Navigation\n**Admin Sidebar:**\n- Fixed left sidebar (w-64) with logo, navigation items, user profile\n- Icon + label navigation items with active state indicator (left border accent)\n- Collapsible on mobile (hamburger menu)\n\n**Candidate Top Bar:**\n- Fixed top bar with exam title, timer (always visible), and minimal controls\n- Sticky positioning for constant visibility\n\n### Data Display\n\n**Dashboard Cards:**\n- White/dark surface with subtle shadow (shadow-sm)\n- Rounded corners (rounded-lg)\n- Padding: p-6\n- Border: border border-gray-200/dark:border-gray-700\n\n**Data Tables:**\n- Zebra striping for row differentiation\n- Sticky headers for long lists\n- Sortable columns with icon indicators\n- Row hover states for interactivity\n- Actions menu (three-dot) aligned right\n\n**Stat Cards:**\n- Large numerical display (text-4xl font-bold)\n- Label below (text-sm text-secondary)\n- Trend indicator with color-coded arrows\n- Compact padding (p-4)\n\n### Forms\n\n**Input Fields:**\n- Consistent height (h-10)\n- Border with focus ring (focus:ring-2 focus:ring-primary)\n- Dark mode: proper background and text contrast\n- Labels above inputs (text-sm font-medium)\n- Helper text below (text-xs text-secondary)\n\n**Buttons:**\n- Primary: bg-primary text-white with hover state\n- Secondary: border border-primary text-primary\n- Danger: bg-red-600 text-white (delete, submit)\n- Size variants: sm (h-8), default (h-10), lg (h-12)\n\n**Question Display (Exam Interface):**\n- Large, readable question text (text-lg)\n- Radio buttons or checkboxes with ample spacing (gap-3)\n- Clear selection states with primary color\n- Progress indicator showing question number\n\n### Proctoring Components\n\n**Camera Feed Display:**\n- Rounded window (rounded-lg) showing live feed\n- Border color indicating monitoring status (green=active, red=alert)\n- Compact view in admin dashboard (w-48 h-36)\n- Picture-in-picture option for candidate during exam\n\n**Alert Banners:**\n- Top-positioned sticky alerts (top-0)\n- Color-coded by severity (bg-amber-100 for warnings)\n- Dismissible with X icon\n- Icon + message + timestamp format\n\n**Event Log:**\n- Chronological list with timestamps\n- Color-coded severity indicators (left border)\n- Expandable for detailed metadata\n- Auto-scroll to latest events\n\n### Overlays\n\n**Modals:**\n- Centered overlay with backdrop (bg-black/50)\n- White/dark card (max-w-2xl)\n- Header with title and close button\n- Footer with action buttons (right-aligned)\n\n**Pre-Exam System Check:**\n- Full-screen overlay with checklist UI\n- Green checkmarks for passed tests\n- Red X for failures with troubleshooting\n- Large \"Start Exam\" button (disabled until all checks pass)\n\n---\n\n## Exam Interface Specific Design\n\n**Layout:**\n- Centered question container (max-w-3xl mx-auto)\n- Fixed timer bar at top (always visible)\n- Question number and navigation at bottom\n- Full-screen mode enforcement (clean, distraction-free)\n\n**Question Card:**\n- Generous padding (p-8)\n- Clear question text (text-xl mb-6)\n- Answer options with large click targets\n- \"Mark for Review\" toggle (subtle, top-right)\n\n**Navigation:**\n- Bottom bar with Previous/Next buttons\n- Question palette sidebar showing all questions (numbered grid)\n- Visual indicators: answered (green), flagged (amber), unanswered (gray)\n\n---\n\n## Admin Dashboard Layout\n\n**Main Dashboard:**\n- Top stats row (4 columns): Active Exams, Total Candidates, Flagged Incidents, Completion Rate\n- Live Monitoring section (grid of camera feeds, 3-4 per row)\n- Recent activity feed (right sidebar)\n- Quick action buttons (Create Exam, Add Candidate)\n\n**Exam Management:**\n- List view with search/filter controls\n- Each exam card shows: title, domain, schedule, candidate count, status toggle\n- Inline edit and duplicate actions\n\n**Monitoring Dashboard:**\n- Split view: Camera grid (left 2/3) + Event log (right 1/3)\n- Real-time status badges for each candidate\n- Filter controls for severity levels\n\n---\n\n## Animations\n\nUse sparingly for feedback only:\n- Button hover: subtle scale (scale-105) and shadow increase\n- Page transitions: fade-in (200ms)\n- Alert appearances: slide-down (300ms)\n- Loading states: pulse animation on skeletons\n- No decorative animations in exam interface\n\n---\n\n## Images\n\n**Admin Dashboard Header:**\n- Optional abstract tech/security illustration in hero area (if using hero section)\n- Dimensions: 1200x400px, subtle gradient overlay\n- Purpose: Brand identity and visual interest\n\n**Empty States:**\n- Illustration for \"No exams created yet\" (centered, max-w-sm)\n- Illustration for \"No candidates enrolled\" \n- Purpose: Guide users to take action\n\n**System Check Icons:**\n- Camera, microphone, browser icons for pre-exam checklist\n- Simple, outlined style matching UI icons\n\n**No large hero image** - This is a functional dashboard application focused on data and workflows, not marketing content.\n\n---\n\n## Accessibility & Responsiveness\n\n- Maintain WCAG 2.1 AA contrast ratios (4.5:1 for text)\n- Focus indicators on all interactive elements\n- Keyboard navigation support throughout\n- Screen reader labels for icon-only buttons\n- Mobile-responsive breakpoints: sm (640px), md (768px), lg (1024px), xl (1280px)\n- Exam interface optimized for tablets and desktops (min 768px recommended)","size_bytes":8271},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/pages/admin/candidates.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Plus, UserPlus, Upload, Download, FileDown } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport Papa from \"papaparse\";\nimport { exportExamResultsCSV, exportExamResultsPDF } from \"@/lib/exportReports\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport type { Candidate, User, Exam } from \"@shared/schema\";\n\ninterface CandidateWithDetails extends Candidate {\n  user?: User;\n  exam?: Exam;\n}\n\nexport default function CandidatesPage() {\n  const [isAssignOpen, setIsAssignOpen] = useState(false);\n  const [isImportOpen, setIsImportOpen] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const { toast } = useToast();\n\n  const { data: candidates, isLoading } = useQuery<CandidateWithDetails[]>({\n    queryKey: [\"/api/candidates\"],\n  });\n\n  const { data: users } = useQuery<User[]>({\n    queryKey: [\"/api/users\"],\n  });\n\n  const { data: exams } = useQuery<Exam[]>({\n    queryKey: [\"/api/exams\"],\n  });\n\n  const assignMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/candidates\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/candidates\"] });\n      setIsAssignOpen(false);\n      toast({\n        title: \"Success\",\n        description: \"Exam assigned to candidate successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const bulkImportMutation = useMutation({\n    mutationFn: async (data: any[]) => {\n      return await apiRequest(\"POST\", \"/api/candidates/bulk-import\", { candidates: data });\n    },\n    onSuccess: (response: any) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/candidates\"] });\n      setIsImportOpen(false);\n      toast({\n        title: \"Import Complete\",\n        description: `Successfully imported ${response.successful} candidates. ${response.failed > 0 ? `${response.failed} failed.` : ''}`,\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Import Failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const formData = new FormData(e.currentTarget);\n    \n    const data = {\n      userId: formData.get(\"userId\") as string,\n      examId: parseInt(formData.get(\"examId\") as string),\n    };\n\n    assignMutation.mutate(data);\n  };\n\n  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    Papa.parse(file, {\n      header: true,\n      complete: (results) => {\n        const validData = results.data\n          .filter((row: any) => row.email && row.examId)\n          .map((row: any) => ({\n            email: row.email.trim(),\n            examId: parseInt(row.examId),\n            firstName: row.firstName?.trim() || '',\n            lastName: row.lastName?.trim() || '',\n          }));\n\n        if (validData.length === 0) {\n          toast({\n            title: \"No Valid Data\",\n            description: \"The CSV file contains no valid candidate entries.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n\n        bulkImportMutation.mutate(validData);\n      },\n      error: (error) => {\n        toast({\n          title: \"CSV Parse Error\",\n          description: error.message,\n          variant: \"destructive\",\n        });\n      },\n    });\n\n    // Reset file input\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const downloadTemplate = () => {\n    const template = 'email,firstName,lastName,examId\\ncandidate@example.com,John,Doe,1\\n';\n    const blob = new Blob([template], { type: 'text/csv' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'candidate_import_template.csv';\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case \"completed\":\n        return \"bg-chart-2/10 text-chart-2\";\n      case \"in_progress\":\n        return \"bg-chart-3/10 text-chart-3\";\n      case \"auto_submitted\":\n        return \"bg-chart-4/10 text-chart-4\";\n      default:\n        return \"bg-muted text-muted-foreground\";\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-semibold mb-2\" data-testid=\"text-page-title\">Candidates</h1>\n          <p className=\"text-muted-foreground\" data-testid=\"text-page-description\">\n            Manage candidate enrollments and exam assignments\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button onClick={() => candidates && exportExamResultsCSV(candidates)} variant=\"outline\" data-testid=\"button-export-csv\">\n            <FileDown className=\"h-4 w-4 mr-2\" />\n            Export CSV\n          </Button>\n          <Button onClick={() => candidates && exportExamResultsPDF(candidates)} variant=\"outline\" data-testid=\"button-export-pdf\">\n            <FileDown className=\"h-4 w-4 mr-2\" />\n            Export PDF\n          </Button>\n          <Button onClick={() => setIsImportOpen(true)} variant=\"outline\" data-testid=\"button-import-csv\">\n            <Upload className=\"h-4 w-4 mr-2\" />\n            Import CSV\n          </Button>\n          <Button onClick={() => setIsAssignOpen(true)} data-testid=\"button-assign-exam\">\n            <UserPlus className=\"h-4 w-4 mr-2\" />\n            Assign Exam\n          </Button>\n        </div>\n      </div>\n\n      {isLoading ? (\n        <div className=\"space-y-4\">\n          {[1, 2, 3].map((i) => (\n            <Skeleton key={i} className=\"h-24\" />\n          ))}\n        </div>\n      ) : candidates && candidates.length > 0 ? (\n        <div className=\"space-y-4\">\n          {candidates.map((candidate) => {\n            const user = candidate.user;\n            const initials = user?.firstName && user?.lastName \n              ? `${user.firstName[0]}${user.lastName[0]}`.toUpperCase()\n              : user?.email?.[0]?.toUpperCase() || \"U\";\n\n            return (\n              <Card key={candidate.id} className=\"p-6\" data-testid={`candidate-card-${candidate.id}`}>\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"flex items-center gap-4 flex-1\">\n                    <Avatar className=\"h-12 w-12\">\n                      <AvatarImage src={user?.profileImageUrl || undefined} className=\"object-cover\" />\n                      <AvatarFallback>{initials}</AvatarFallback>\n                    </Avatar>\n                    \n                    <div className=\"flex-1\">\n                      <p className=\"font-medium\" data-testid={`text-candidate-name-${candidate.id}`}>\n                        {user?.firstName && user?.lastName \n                          ? `${user.firstName} ${user.lastName}`\n                          : user?.email || \"Unknown User\"}\n                      </p>\n                      <p className=\"text-sm text-muted-foreground\" data-testid={`text-candidate-exam-${candidate.id}`}>\n                        {candidate.exam?.title || \"Unknown Exam\"}\n                      </p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-4\">\n                    {candidate.score !== null && (\n                      <div className=\"text-right\">\n                        <p className=\"text-2xl font-bold\" data-testid={`text-candidate-score-${candidate.id}`}>\n                          {candidate.score}%\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">Score</p>\n                      </div>\n                    )}\n                    \n                    <Badge className={getStatusColor(candidate.status)} data-testid={`badge-candidate-status-${candidate.id}`}>\n                      {candidate.status.replace(\"_\", \" \")}\n                    </Badge>\n                  </div>\n                </div>\n              </Card>\n            );\n          })}\n        </div>\n      ) : (\n        <Card className=\"p-12\">\n          <div className=\"text-center\">\n            <p className=\"text-lg font-semibold mb-2\" data-testid=\"text-no-candidates\">No candidates assigned yet</p>\n            <p className=\"text-sm text-muted-foreground mb-6\">\n              Assign exams to candidates to get started\n            </p>\n            <Button onClick={() => setIsAssignOpen(true)} data-testid=\"button-assign-first-exam\">\n              <UserPlus className=\"h-4 w-4 mr-2\" />\n              Assign First Exam\n            </Button>\n          </div>\n        </Card>\n      )}\n\n      <Dialog open={isAssignOpen} onOpenChange={setIsAssignOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Assign Exam to Candidate</DialogTitle>\n            <DialogDescription>\n              Select a candidate and exam to create a new assignment\n            </DialogDescription>\n          </DialogHeader>\n\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"userId\">Candidate *</Label>\n                <Select name=\"userId\" required>\n                  <SelectTrigger data-testid=\"select-candidate-user\">\n                    <SelectValue placeholder=\"Select candidate\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {users?.filter(u => u.role === \"candidate\").map((user) => (\n                      <SelectItem key={user.id} value={user.id}>\n                        {user.firstName && user.lastName \n                          ? `${user.firstName} ${user.lastName}`\n                          : user.email}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"examId\">Exam *</Label>\n                <Select name=\"examId\" required>\n                  <SelectTrigger data-testid=\"select-candidate-exam\">\n                    <SelectValue placeholder=\"Select exam\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {exams?.filter(e => e.status === \"active\").map((exam) => (\n                      <SelectItem key={exam.id} value={exam.id.toString()}>\n                        {exam.title}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <DialogFooter>\n              <Button type=\"button\" variant=\"outline\" onClick={() => setIsAssignOpen(false)} data-testid=\"button-cancel\">\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={assignMutation.isPending} data-testid=\"button-submit-assignment\">\n                {assignMutation.isPending ? \"Assigning...\" : \"Assign Exam\"}\n              </Button>\n            </DialogFooter>\n          </form>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={isImportOpen} onOpenChange={setIsImportOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Import Candidates from CSV</DialogTitle>\n            <DialogDescription>\n              Upload a CSV file to bulk import candidates and assign exams\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4\">\n            <div className=\"rounded-lg border border-border p-4 bg-muted/50\">\n              <p className=\"text-sm text-muted-foreground mb-2\">\n                CSV should include: email, firstName, lastName, examId\n              </p>\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={downloadTemplate}\n                data-testid=\"button-download-template\"\n              >\n                <Download className=\"h-4 w-4 mr-2\" />\n                Download Template\n              </Button>\n            </div>\n\n            <div>\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\".csv\"\n                onChange={handleFileUpload}\n                className=\"hidden\"\n                data-testid=\"input-csv-file\"\n              />\n              <Button\n                type=\"button\"\n                onClick={() => fileInputRef.current?.click()}\n                disabled={bulkImportMutation.isPending}\n                className=\"w-full\"\n                data-testid=\"button-select-csv\"\n              >\n                <Upload className=\"h-4 w-4 mr-2\" />\n                {bulkImportMutation.isPending ? \"Importing...\" : \"Select CSV File\"}\n              </Button>\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={() => setIsImportOpen(false)}\n              data-testid=\"button-cancel-import\"\n            >\n              Cancel\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":14012},"client/src/components/app-sidebar.tsx":{"content":"import {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarHeader,\n  SidebarFooter,\n} from \"@/components/ui/sidebar\";\nimport { \n  LayoutDashboard, \n  FileText, \n  Users, \n  Eye,\n  Shield,\n  LogOut,\n  User,\n  BarChart3,\n  FolderOpen,\n  UserCog\n} from \"lucide-react\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Button } from \"@/components/ui/button\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useLocation } from \"wouter\";\n\nconst adminItems = [\n  {\n    title: \"Dashboard\",\n    url: \"/\",\n    icon: LayoutDashboard,\n    testId: \"link-admin-dashboard\"\n  },\n  {\n    title: \"Exams\",\n    url: \"/exams\",\n    icon: FileText,\n    testId: \"link-exams\"\n  },\n  {\n    title: \"Domains\",\n    url: \"/domains\",\n    icon: FolderOpen,\n    testId: \"link-domains\"\n  },\n  {\n    title: \"Administrators\",\n    url: \"/administrators\",\n    icon: UserCog,\n    testId: \"link-administrators\"\n  },\n  {\n    title: \"Live Monitoring\",\n    url: \"/monitoring\",\n    icon: Eye,\n    testId: \"link-monitoring\"\n  },\n  {\n    title: \"Analytics\",\n    url: \"/analytics\",\n    icon: BarChart3,\n    testId: \"link-analytics\"\n  },\n];\n\nconst candidateItems = [\n  {\n    title: \"My Exams\",\n    url: \"/\",\n    icon: FileText,\n    testId: \"link-my-exams\"\n  },\n];\n\nexport function AppSidebar() {\n  const { user, isAdmin } = useAuth();\n  const items = isAdmin ? adminItems : candidateItems;\n  const [, setLocation] = useLocation();\n  const queryClient = useQueryClient();\n\n  const logoutMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"POST\", \"/api/auth/logout\", {});\n    },\n    onSuccess: () => {\n      queryClient.setQueryData([\"/api/auth/user\"], null);\n      setLocation(isAdmin ? \"/admin\" : \"/\");\n    },\n  });\n\n  const initials = user?.firstName && user?.lastName \n    ? `${user.firstName[0]}${user.lastName[0]}`.toUpperCase()\n    : user?.email?.[0]?.toUpperCase() || \"U\";\n\n  return (\n    <Sidebar>\n      <SidebarHeader className=\"border-b border-sidebar-border p-4\">\n        <div className=\"flex items-center gap-2\">\n          <Shield className=\"h-6 w-6 text-sidebar-primary\" />\n          <span className=\"font-semibold text-sidebar-foreground\">WokkahCBT</span>\n        </div>\n      </SidebarHeader>\n      \n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel>{isAdmin ? \"Admin Panel\" : \"Candidate\"}</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {items.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton asChild data-testid={item.testId}>\n                    <a href={item.url}>\n                      <item.icon className=\"h-4 w-4\" />\n                      <span>{item.title}</span>\n                    </a>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n\n      <SidebarFooter className=\"border-t border-sidebar-border p-4\">\n        <div className=\"flex items-center gap-3 mb-3\">\n          <Avatar className=\"h-8 w-8\">\n            <AvatarFallback>{initials}</AvatarFallback>\n          </Avatar>\n          <div className=\"flex-1 min-w-0\">\n            <p className=\"text-sm font-medium text-sidebar-foreground truncate\" data-testid=\"text-user-name\">\n              {user?.firstName && user?.lastName \n                ? `${user.firstName} ${user.lastName}`\n                : user?.email || \"User\"}\n            </p>\n            <p className=\"text-xs text-muted-foreground capitalize\" data-testid=\"text-user-role\">\n              {user?.role || \"Candidate\"}\n            </p>\n          </div>\n        </div>\n        <Button \n          variant=\"outline\" \n          size=\"sm\" \n          className=\"w-full\" \n          onClick={() => logoutMutation.mutate()}\n          disabled={logoutMutation.isPending}\n          data-testid=\"button-logout\"\n        >\n          <LogOut className=\"h-4 w-4 mr-2\" />\n          Sign Out\n        </Button>\n      </SidebarFooter>\n    </Sidebar>\n  );\n}\n","size_bytes":4298},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"server/routes.ts":{"content":"// API routes with password-based authentication and WebSocket support\nimport type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { WebSocketServer, WebSocket } from \"ws\";\nimport multer from \"multer\";\nimport { storage } from \"./storage\";\nimport { setupAuth, isAuthenticated, isAdmin, generateInvitationToken } from \"./auth\";\nimport { sendInvitationEmail, isEmailConfigured, sendCandidateCredentials, sendPasswordResetEmail } from \"./email\";\nimport { generateQuestionsWithAI } from \"./ai\";\nimport { extractTextFromDocument } from \"./document-parser\";\nimport {\n  insertDomainSchema,\n  insertQuestionSchema,\n  insertExamSchema,\n  insertCandidateSchema,\n  insertResponseSchema,\n  insertProctorLogSchema,\n} from \"@shared/schema\";\nimport { randomBytes } from \"crypto\";\nimport bcrypt from \"bcrypt\";\n\nconst SALT_ROUNDS = 12;\n\n// Configure multer for file uploads (in-memory storage)\nconst upload = multer({\n  storage: multer.memoryStorage(),\n  limits: {\n    fileSize: 10 * 1024 * 1024, // 10MB limit\n  },\n  fileFilter: (req, file, cb) => {\n    const allowedMimes = [\n      'application/pdf',\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n      'application/msword',\n      'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      'application/vnd.ms-powerpoint'\n    ];\n    if (allowedMimes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new Error('Invalid file type. Only PDF, Word, and PowerPoint documents are allowed.'));\n    }\n  },\n});\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Auth middleware\n  await setupAuth(app);\n\n  // Note: Auth routes are now in server/auth.ts\n\n  // Password Reset routes\n  app.post(\"/api/auth/forgot-password\", async (req, res) => {\n    try {\n      const { email } = req.body;\n      console.log(`[FORGOT-PASSWORD] Request received for email: ${email}`);\n\n      if (!email) {\n        return res.status(400).json({ message: \"Email is required\" });\n      }\n\n      const user = await storage.getUserByEmail(email);\n      \n      // Always return success to prevent email enumeration\n      if (!user || user.role !== \"admin\") {\n        console.log(`[FORGOT-PASSWORD] No admin user found for email: ${email}`);\n        return res.json({ message: \"If an account exists, a password reset link has been sent to your email\" });\n      }\n\n      console.log(`[FORGOT-PASSWORD] Admin user found: ${user.email} (${user.id})`);\n\n      // Generate reset token (plaintext for email)\n      const resetToken = randomBytes(32).toString(\"hex\");\n      const expiry = new Date(Date.now() + 3600000); // 1 hour from now\n\n      // Hash token before storing in database\n      const hashedToken = await bcrypt.hash(resetToken, SALT_ROUNDS);\n\n      // Save hashed token to database\n      await storage.setResetPasswordToken(user.id, hashedToken, expiry);\n      console.log(`[FORGOT-PASSWORD] Reset token saved to database for user: ${user.email}`);\n\n      // Send email with plaintext token\n      const emailSent = await sendPasswordResetEmail(\n        user.email,\n        user.firstName || \"Admin\",\n        user.lastName || \"User\",\n        resetToken\n      );\n\n      if (!emailSent && process.env.NODE_ENV === \"development\") {\n        const resetLink = `${process.env.APP_URL || \"http://localhost:5000\"}/admin/reset-password?token=${resetToken}`;\n        console.log(\"\\n========================================\");\n        console.log(\"[FORGOT-PASSWORD] Email sending failed!\");\n        console.log(\"Reset link for development:\", resetLink);\n        console.log(\"========================================\\n\");\n      }\n\n      res.json({ message: \"If an account exists, a password reset link has been sent to your email\" });\n    } catch (error: any) {\n      console.error(\"[FORGOT-PASSWORD] Error:\", error);\n      res.status(500).json({ message: \"Failed to process password reset request\" });\n    }\n  });\n\n  app.post(\"/api/auth/reset-password\", async (req, res) => {\n    try {\n      const { token, password } = req.body;\n\n      if (!token || !password) {\n        return res.status(400).json({ message: \"Token and password are required\" });\n      }\n\n      if (password.length < 8) {\n        return res.status(400).json({ message: \"Password must be at least 8 characters\" });\n      }\n\n      // Get all admin users with reset tokens\n      const admins = await storage.getAdministrators();\n      \n      // Find user by comparing hashed tokens\n      let matchedUser = null;\n      for (const admin of admins) {\n        if (admin.resetPasswordToken && admin.resetPasswordExpiry) {\n          // Check if token matches\n          const isMatch = await bcrypt.compare(token, admin.resetPasswordToken);\n          if (isMatch) {\n            matchedUser = admin;\n            break;\n          }\n        }\n      }\n\n      if (!matchedUser || !matchedUser.resetPasswordExpiry) {\n        return res.status(400).json({ message: \"Invalid or expired reset token\" });\n      }\n\n      // Check if token is expired\n      if (new Date() > new Date(matchedUser.resetPasswordExpiry)) {\n        return res.status(400).json({ message: \"Reset token has expired\" });\n      }\n\n      // Hash new password\n      const passwordHash = await bcrypt.hash(password, SALT_ROUNDS);\n\n      // Update password\n      await storage.updateUser(matchedUser.id, { passwordHash });\n\n      // Clear reset token\n      await storage.clearResetPasswordToken(matchedUser.id);\n\n      res.json({ message: \"Password reset successful\" });\n    } catch (error: any) {\n      console.error(\"Error resetting password:\", error);\n      res.status(500).json({ message: \"Failed to reset password\" });\n    }\n  });\n\n  // Administrator Management routes\n  app.get(\"/api/administrators\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const admins = await storage.getAdministrators();\n      // Remove sensitive fields before sending to client\n      const sanitizedAdmins = admins.map(({ passwordHash, invitationToken, ...admin }) => admin);\n      res.json(sanitizedAdmins);\n    } catch (error) {\n      console.error(\"Error fetching administrators:\", error);\n      res.status(500).json({ message: \"Failed to fetch administrators\" });\n    }\n  });\n\n  app.post(\"/api/administrators\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const { email, firstName, lastName, password } = req.body;\n      \n      if (!email || !firstName || !lastName || !password) {\n        return res.status(400).json({ message: \"All fields are required\" });\n      }\n\n      // Check if email already exists\n      const existingUser = await storage.getUserByEmail(email);\n      if (existingUser) {\n        return res.status(400).json({ message: \"Email already exists\" });\n      }\n\n      // Hash password\n      const passwordHash = await bcrypt.hash(password, SALT_ROUNDS);\n\n      // Create admin user\n      const admin = await storage.createUser({\n        email,\n        firstName,\n        lastName,\n        passwordHash,\n        role: \"admin\",\n      });\n\n      // Return without sensitive fields\n      const { passwordHash: _, invitationToken: __, ...sanitizedAdmin } = admin;\n      res.json(sanitizedAdmin);\n    } catch (error: any) {\n      console.error(\"Error creating administrator:\", error);\n      res.status(400).json({ message: error.message || \"Failed to create administrator\" });\n    }\n  });\n\n  app.put(\"/api/administrators/:id\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { email, firstName, lastName, password } = req.body;\n\n      if (!email || !firstName || !lastName) {\n        return res.status(400).json({ message: \"Email, first name, and last name are required\" });\n      }\n\n      // Check if email already exists for another user\n      const existingUser = await storage.getUserByEmail(email);\n      if (existingUser && existingUser.id !== id) {\n        return res.status(400).json({ message: \"Email already exists\" });\n      }\n\n      const updateData: any = {\n        email,\n        firstName,\n        lastName,\n      };\n\n      // Only update password if provided\n      if (password) {\n        updateData.passwordHash = await bcrypt.hash(password, SALT_ROUNDS);\n      }\n\n      const admin = await storage.updateUser(id, updateData);\n      if (!admin) {\n        return res.status(404).json({ message: \"Administrator not found\" });\n      }\n\n      // Return without sensitive fields\n      const { passwordHash: _, invitationToken: __, ...sanitizedAdmin } = admin;\n      res.json(sanitizedAdmin);\n    } catch (error: any) {\n      console.error(\"Error updating administrator:\", error);\n      res.status(400).json({ message: error.message || \"Failed to update administrator\" });\n    }\n  });\n\n  app.delete(\"/api/administrators/:id\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const { id } = req.params;\n\n      // Prevent deleting yourself\n      if ((req as any).user?.id === id) {\n        return res.status(400).json({ message: \"Cannot delete your own account\" });\n      }\n\n      const result = await storage.deleteUser(id);\n      if (!result) {\n        return res.status(404).json({ message: \"Administrator not found\" });\n      }\n\n      res.json({ message: \"Administrator deleted successfully\" });\n    } catch (error: any) {\n      console.error(\"Error deleting administrator:\", error);\n      res.status(400).json({ message: error.message || \"Failed to delete administrator\" });\n    }\n  });\n\n  // Admin Stats\n  app.get(\"/api/admin/stats\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const exams = await storage.getExams();\n      const candidates = await storage.getCandidates();\n      const logs = await storage.getProctorLogs();\n\n      const activeExams = exams.filter(e => e.status === \"active\").length;\n      const totalCandidates = candidates.length;\n      const flaggedIncidents = logs.filter(l => l.severity === \"high\" || l.severity === \"medium\").length;\n      const completed = candidates.filter(c => c.status === \"completed\").length;\n      const completionRate = totalCandidates > 0 ? Math.round((completed / totalCandidates) * 100) : 0;\n\n      const recentExams = exams.slice(0, 3).map(exam => ({\n        id: exam.id,\n        title: exam.title,\n        status: exam.status,\n        candidateCount: candidates.filter(c => c.examId === exam.id).length,\n      }));\n\n      const recentActivity = logs.slice(0, 5).map(log => ({\n        message: `${log.eventType.replace(\"_\", \" \")} detected`,\n        timestamp: new Date(log.timestamp).toLocaleString(),\n        severity: log.severity,\n      }));\n\n      res.json({\n        activeExams,\n        totalCandidates,\n        flaggedIncidents,\n        completionRate,\n        recentExams,\n        recentActivity,\n      });\n    } catch (error) {\n      console.error(\"Error fetching stats:\", error);\n      res.status(500).json({ message: \"Failed to fetch stats\" });\n    }\n  });\n\n  // Domain routes\n  app.get(\"/api/domains\", isAuthenticated, async (req, res) => {\n    try {\n      const domains = await storage.getDomains();\n      res.json(domains);\n    } catch (error) {\n      console.error(\"Error fetching domains:\", error);\n      res.status(500).json({ message: \"Failed to fetch domains\" });\n    }\n  });\n\n  app.post(\"/api/domains\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const validatedData = insertDomainSchema.parse(req.body);\n      const domain = await storage.createDomain(validatedData);\n      res.json(domain);\n    } catch (error: any) {\n      console.error(\"Error creating domain:\", error);\n      res.status(400).json({ message: error.message || \"Failed to create domain\" });\n    }\n  });\n\n  // Question routes\n  app.get(\"/api/questions\", isAuthenticated, async (req, res) => {\n    try {\n      const questions = await storage.getQuestions();\n      res.json(questions);\n    } catch (error) {\n      console.error(\"Error fetching questions:\", error);\n      res.status(500).json({ message: \"Failed to fetch questions\" });\n    }\n  });\n\n  app.post(\"/api/questions\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const validatedData = insertQuestionSchema.parse(req.body);\n      const question = await storage.createQuestion(validatedData);\n      res.json(question);\n    } catch (error: any) {\n      console.error(\"Error creating question:\", error);\n      res.status(400).json({ message: error.message || \"Failed to create question\" });\n    }\n  });\n\n  app.put(\"/api/questions/:id\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      const validatedData = insertQuestionSchema.parse(req.body);\n      const question = await storage.updateQuestion(id, validatedData);\n      if (!question) {\n        return res.status(404).json({ message: \"Question not found\" });\n      }\n      res.json(question);\n    } catch (error: any) {\n      console.error(\"Error updating question:\", error);\n      res.status(400).json({ message: error.message || \"Failed to update question\" });\n    }\n  });\n\n  app.delete(\"/api/questions/:id\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      await storage.deleteQuestion(id);\n      res.json({ message: \"Question deleted successfully\" });\n    } catch (error: any) {\n      console.error(\"Error deleting question:\", error);\n      res.status(400).json({ message: error.message || \"Failed to delete question\" });\n    }\n  });\n\n  // Exam routes\n  app.get(\"/api/exams\", isAuthenticated, async (req, res) => {\n    try {\n      const exams = await storage.getExams();\n      res.json(exams);\n    } catch (error) {\n      console.error(\"Error fetching exams:\", error);\n      res.status(500).json({ message: \"Failed to fetch exams\" });\n    }\n  });\n\n  app.post(\"/api/exams\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const { questions: questionsData, useAI, aiQuestionCount, documentContent, ...examData } = req.body;\n      const validatedExamData = insertExamSchema.parse(examData);\n      \n      let finalQuestions = questionsData || [];\n      \n      // Generate questions with AI if requested\n      if (useAI && aiQuestionCount && aiQuestionCount > 0) {\n        if (!process.env.OPENAI_API_KEY) {\n          return res.status(400).json({ \n            message: \"AI question generation is not configured. Please add OPENAI_API_KEY.\" \n          });\n        }\n        \n        // Fetch domain name for better AI prompts\n        const domain = await storage.getDomain(validatedExamData.domainId);\n        if (!domain) {\n          return res.status(400).json({ message: \"Invalid domain\" });\n        }\n        \n        const aiQuestions = await generateQuestionsWithAI({\n          domainId: validatedExamData.domainId,\n          examTitle: validatedExamData.title,\n          examDescription: validatedExamData.description || \"\",\n          domainName: domain.name,\n          questionCount: aiQuestionCount,\n          documentContent, // Pass document content if provided\n        });\n        \n        finalQuestions = [...finalQuestions, ...aiQuestions];\n      }\n      \n      if (finalQuestions.length > 0) {\n        const validatedQuestions = finalQuestions.map((q: any) => insertQuestionSchema.parse(q));\n        const exam = await storage.createExamWithQuestions(validatedExamData, validatedQuestions);\n        res.json(exam);\n      } else {\n        const exam = await storage.createExam(validatedExamData);\n        res.json(exam);\n      }\n    } catch (error: any) {\n      console.error(\"Error creating exam:\", error);\n      res.status(400).json({ message: error.message || \"Failed to create exam\" });\n    }\n  });\n\n  app.get(\"/api/exams/:id\", isAuthenticated, async (req, res) => {\n    try {\n      const examId = parseInt(req.params.id);\n      const exam = await storage.getExam(examId);\n      if (!exam) {\n        return res.status(404).json({ message: \"Exam not found\" });\n      }\n      res.json(exam);\n    } catch (error: any) {\n      console.error(\"Error fetching exam:\", error);\n      res.status(500).json({ message: \"Failed to fetch exam\" });\n    }\n  });\n\n  app.patch(\"/api/exams/:id\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const examId = parseInt(req.params.id);\n      const validatedData = insertExamSchema.partial().parse(req.body);\n      const updatedExam = await storage.updateExam(examId, validatedData);\n      res.json(updatedExam);\n    } catch (error: any) {\n      console.error(\"Error updating exam:\", error);\n      res.status(400).json({ message: error.message || \"Failed to update exam\" });\n    }\n  });\n\n  app.delete(\"/api/exams/:id\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const examId = parseInt(req.params.id);\n      await storage.deleteExam(examId);\n      res.json({ message: \"Exam deleted successfully\" });\n    } catch (error: any) {\n      console.error(\"Error deleting exam:\", error);\n      res.status(500).json({ message: \"Failed to delete exam\" });\n    }\n  });\n\n  // Document upload and text extraction endpoint\n  app.post(\"/api/ai/extract-document\", isAuthenticated, isAdmin, upload.single('document'), async (req, res) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({ message: \"No document file provided\" });\n      }\n\n      const extractedText = await extractTextFromDocument(req.file.buffer, req.file.mimetype);\n      \n      res.json({ \n        text: extractedText,\n        filename: req.file.originalname,\n        size: req.file.size,\n      });\n    } catch (error: any) {\n      console.error(\"Error extracting document text:\", error);\n      res.status(400).json({ message: error.message || \"Failed to extract text from document\" });\n    }\n  });\n\n  // AI question generation endpoint (supports document content)\n  app.post(\"/api/ai/generate-questions\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const { examTitle, domainId, description, count, documentContent } = req.body;\n      \n      if (!process.env.OPENAI_API_KEY) {\n        return res.status(400).json({ \n          message: \"AI question generation is not configured. Please add OPENAI_API_KEY.\" \n        });\n      }\n      \n      // Fetch domain name for better AI prompts\n      const domain = await storage.getDomain(domainId);\n      if (!domain) {\n        return res.status(400).json({ message: \"Invalid domain\" });\n      }\n      \n      const questions = await generateQuestionsWithAI({\n        domainId,\n        examTitle,\n        examDescription: description || \"\",\n        domainName: domain.name,\n        questionCount: count || 5,\n        documentContent, // Optional document content\n      });\n      \n      res.json({ questions });\n    } catch (error: any) {\n      console.error(\"Error generating AI questions:\", error);\n      res.status(400).json({ message: error.message || \"Failed to generate AI questions\" });\n    }\n  });\n\n  app.get(\"/api/exams/:id/questions\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const examId = parseInt(req.params.id);\n      const questions = await storage.getExamQuestions(examId);\n      res.json(questions);\n    } catch (error: any) {\n      console.error(\"Error fetching exam questions:\", error);\n      res.status(500).json({ message: \"Failed to fetch exam questions\" });\n    }\n  });\n\n  app.post(\"/api/exams/:id/questions\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const examId = parseInt(req.params.id);\n      const questionsData = req.body.questions;\n      \n      if (!questionsData || !Array.isArray(questionsData) || questionsData.length === 0) {\n        return res.status(400).json({ message: \"Questions array is required\" });\n      }\n      \n      const validatedQuestions = questionsData.map((q: any) => insertQuestionSchema.parse(q));\n      await storage.addQuestionsToExam(examId, validatedQuestions);\n      res.json({ message: \"Questions added successfully\" });\n    } catch (error: any) {\n      console.error(\"Error adding questions to exam:\", error);\n      res.status(400).json({ message: error.message || \"Failed to add questions\" });\n    }\n  });\n\n  // Users route for candidate selection\n  app.get(\"/api/users\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const users = await storage.getAllUsers();\n      res.json(users);\n    } catch (error) {\n      console.error(\"Error fetching users:\", error);\n      res.status(500).json({ message: \"Failed to fetch users\" });\n    }\n  });\n\n  // Candidate routes\n  app.get(\"/api/candidates\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const candidates = await storage.getCandidates();\n      \n      // Fetch related user and exam data\n      const candidatesWithDetails = await Promise.all(\n        candidates.map(async (candidate) => {\n          const user = await storage.getUser(candidate.userId);\n          const exam = await storage.getExam(candidate.examId);\n          return { ...candidate, user, exam };\n        })\n      );\n\n      res.json(candidatesWithDetails);\n    } catch (error) {\n      console.error(\"Error fetching candidates:\", error);\n      res.status(500).json({ message: \"Failed to fetch candidates\" });\n    }\n  });\n\n  app.get(\"/api/exams/:id/candidates\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const examId = parseInt(req.params.id);\n      const candidates = await storage.getCandidatesByExam(examId);\n      \n      // Fetch related user data\n      const candidatesWithDetails = await Promise.all(\n        candidates.map(async (candidate) => {\n          const user = await storage.getUser(candidate.userId);\n          return { ...candidate, user };\n        })\n      );\n\n      res.json(candidatesWithDetails);\n    } catch (error) {\n      console.error(\"Error fetching exam candidates:\", error);\n      res.status(500).json({ message: \"Failed to fetch exam candidates\" });\n    }\n  });\n\n  app.post(\"/api/candidates\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const { userId, examId } = req.body;\n      \n      // Generate random seed for question randomization\n      const randomSeed = randomBytes(16).toString(\"hex\");\n      \n      const candidateData = {\n        userId,\n        examId,\n        randomSeed,\n        status: \"assigned\" as const,\n      };\n\n      const validatedData = insertCandidateSchema.parse(candidateData);\n      const candidate = await storage.createCandidate(validatedData);\n      \n      // Send invitation email if user doesn't have a password yet\n      const user = await storage.getUser(userId);\n      const exam = await storage.getExam(examId);\n      \n      if (user && !user.passwordHash && user.invitationToken && exam) {\n        const emailSent = await sendInvitationEmail(user.email, user.invitationToken, exam);\n        if (!emailSent && isEmailConfigured()) {\n          console.error(\"Failed to send invitation email to:\", user.email);\n        }\n      }\n      \n      res.json(candidate);\n    } catch (error: any) {\n      console.error(\"Error creating candidate:\", error);\n      res.status(400).json({ message: error.message || \"Failed to assign exam\" });\n    }\n  });\n\n  app.delete(\"/api/candidates/:id\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const candidateId = parseInt(req.params.id);\n      await storage.deleteCandidate(candidateId);\n      res.json({ message: \"Candidate deleted successfully\" });\n    } catch (error: any) {\n      console.error(\"Error deleting candidate:\", error);\n      res.status(500).json({ message: \"Failed to delete candidate\" });\n    }\n  });\n\n  // Start exam (update candidate status)\n  app.post(\"/api/candidates/:candidateId/start\", isAuthenticated, async (req: any, res) => {\n    try {\n      const candidateId = parseInt(req.params.candidateId);\n      const candidate = await storage.getCandidate(candidateId);\n      \n      if (!candidate) {\n        return res.status(404).json({ message: \"Candidate not found\" });\n      }\n\n      const userId = req.user.id;\n      if (candidate.userId !== userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n\n      // Check exam status before allowing start\n      const exam = await storage.getExam(candidate.examId);\n      if (!exam) {\n        return res.status(404).json({ message: \"Exam not found\" });\n      }\n\n      if (exam.status === \"draft\") {\n        return res.status(403).json({ message: \"This exam is not yet available\" });\n      }\n\n      if (exam.status === \"inactive\") {\n        return res.status(403).json({ message: \"This exam has been archived and new attempts cannot be started\" });\n      }\n\n      const updated = await storage.updateCandidate(candidateId, {\n        status: \"in_progress\",\n        startedAt: new Date(),\n      });\n\n      // Log exam start event\n      await storage.createProctorLog({\n        candidateId,\n        eventType: \"exam_start\",\n        severity: \"low\",\n      });\n\n      res.json(updated);\n    } catch (error) {\n      console.error(\"Error starting exam:\", error);\n      res.status(500).json({ message: \"Failed to start exam\" });\n    }\n  });\n\n  // Bulk import candidates\n  app.post(\"/api/candidates/bulk-import\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const { candidates } = req.body;\n      \n      if (!Array.isArray(candidates) || candidates.length === 0) {\n        return res.status(400).json({ message: \"No candidates provided\" });\n      }\n\n      const results = {\n        successful: 0,\n        failed: 0,\n        errors: [] as string[],\n      };\n\n      for (const candidate of candidates) {\n        try {\n          const { email, firstName, lastName, department, matricNo, examId, password } = candidate;\n          \n          // Fetch exam for email invitation\n          const exam = await storage.getExam(parseInt(examId));\n          \n          // Find or create user\n          let user = await storage.getUserByEmail(email);\n          \n          if (!user) {\n            // Hash the provided password\n            const passwordHash = password ? await bcrypt.hash(password, SALT_ROUNDS) : undefined;\n            \n            user = await storage.createUser({\n              id: crypto.randomUUID(),\n              email,\n              firstName: firstName || '',\n              lastName: lastName || '',\n              department: department || null,\n              matricNo: matricNo || null,\n              role: \"candidate\",\n              passwordHash,\n              invitedAt: new Date(),\n            });\n          } else {\n            // Update existing user with new information\n            if (password) {\n              const passwordHash = await bcrypt.hash(password, SALT_ROUNDS);\n              user = await storage.updateUser(user.id, {\n                firstName: firstName || user.firstName,\n                lastName: lastName || user.lastName,\n                department: department || user.department,\n                matricNo: matricNo || user.matricNo,\n                passwordHash,\n              });\n            } else {\n              user = await storage.updateUser(user.id, {\n                firstName: firstName || user.firstName,\n                lastName: lastName || user.lastName,\n                department: department || user.department,\n                matricNo: matricNo || user.matricNo,\n              });\n            }\n          }\n\n          // Create candidate assignment\n          await storage.createCandidate({\n            userId: user.id,\n            examId: parseInt(examId),\n            status: \"assigned\",\n            randomSeed: Math.floor(Math.random() * 1000000).toString(),\n          });\n\n          // Send email notification if password was provided (new candidate)\n          if (password && exam) {\n            try {\n              await sendCandidateCredentials({\n                email,\n                firstName: firstName || '',\n                lastName: lastName || '',\n                password,\n                examTitle: exam.title,\n                examDuration: exam.duration,\n              });\n            } catch (emailError) {\n              console.error(`Failed to send email to ${email}:`, emailError);\n              // Don't fail the import if email fails\n            }\n          }\n\n          results.successful++;\n        } catch (error: any) {\n          results.failed++;\n          results.errors.push(`${candidate.email}: ${error.message}`);\n        }\n      }\n\n      res.json(results);\n    } catch (error: any) {\n      console.error(\"Bulk import error:\", error);\n      res.status(500).json({ message: error.message || \"Bulk import failed\" });\n    }\n  });\n\n  // My exams (for candidates)\n  app.get(\"/api/my-exams\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const candidates = await storage.getCandidatesByUser(userId);\n      \n      const candidatesWithExams = await Promise.all(\n        candidates.map(async (candidate) => {\n          const exam = await storage.getExam(candidate.examId);\n          return { ...candidate, exam };\n        })\n      );\n\n      // Filter out draft exams on the backend for security\n      const filteredCandidates = candidatesWithExams.filter(\n        candidate => candidate.exam?.status !== 'draft'\n      );\n\n      res.json(filteredCandidates);\n    } catch (error) {\n      console.error(\"Error fetching my exams:\", error);\n      res.status(500).json({ message: \"Failed to fetch exams\" });\n    }\n  });\n\n  // Exam session with randomization\n  app.get(\"/api/exam-session/:candidateId\", isAuthenticated, async (req: any, res) => {\n    try {\n      const candidateId = parseInt(req.params.candidateId);\n      const candidate = await storage.getCandidate(candidateId);\n      \n      if (!candidate) {\n        return res.status(404).json({ message: \"Candidate not found\" });\n      }\n\n      // Verify user owns this candidate session\n      const userId = req.user.id;\n      if (candidate.userId !== userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n\n      const exam = await storage.getExam(candidate.examId);\n      if (!exam) {\n        return res.status(404).json({ message: \"Exam not found\" });\n      }\n\n      // Check exam status restrictions\n      if (exam.status === \"draft\") {\n        return res.status(403).json({ message: \"This exam is not yet available\" });\n      }\n\n      // Archived exams: allow viewing completed results, but prevent new attempts\n      if (exam.status === \"inactive\") {\n        if (candidate.status === \"assigned\" || candidate.status === \"in_progress\") {\n          return res.status(403).json({ message: \"This exam has been archived and new attempts cannot be started\" });\n        }\n        // Allow completed status to view results\n      }\n\n      // Get questions from domain\n      const allQuestions = await storage.getQuestionsByDomain(exam.domainId);\n      \n      // Randomize questions using the candidate's seed\n      const seededRandom = (seed: string) => {\n        let hash = 0;\n        for (let i = 0; i < seed.length; i++) {\n          hash = ((hash << 5) - hash) + seed.charCodeAt(i);\n          hash = hash & hash;\n        }\n        return () => {\n          hash = (hash * 9301 + 49297) % 233280;\n          return hash / 233280;\n        };\n      };\n\n      const random = seededRandom(candidate.randomSeed);\n      const shuffled = [...allQuestions].sort(() => random() - 0.5);\n      const selectedQuestions = shuffled.slice(0, exam.questionCount);\n\n      // Shuffle options for each question\n      const randomizedQuestions = selectedQuestions.map(q => ({\n        ...q,\n        options: [...(q.options as string[])].sort(() => random() - 0.5),\n      }));\n\n      // Calculate time remaining\n      const startedAt = candidate.startedAt ? new Date(candidate.startedAt).getTime() : Date.now();\n      const elapsedSeconds = Math.floor((Date.now() - startedAt) / 1000);\n      const totalSeconds = exam.duration * 60;\n      const timeRemaining = Math.max(0, totalSeconds - elapsedSeconds);\n\n      // Get existing responses\n      const responses = await storage.getResponses(candidateId);\n\n      res.json({\n        candidateId: candidate.id,\n        examTitle: exam.title,\n        duration: exam.duration,\n        questions: selectedQuestions,\n        randomizedQuestions,\n        responses,\n        timeRemaining,\n      });\n    } catch (error) {\n      console.error(\"Error fetching exam session:\", error);\n      res.status(500).json({ message: \"Failed to fetch exam session\" });\n    }\n  });\n\n  // Response routes (auto-save)\n  app.post(\"/api/responses\", isAuthenticated, async (req: any, res) => {\n    try {\n      const { candidateId, questionId, selectedAnswer } = req.body;\n\n      // Check if response already exists\n      const existingResponses = await storage.getResponses(candidateId);\n      const existing = existingResponses.find(r => r.questionId === questionId);\n\n      const question = await storage.getQuestion(questionId);\n      const isCorrect = question?.correctAnswer === selectedAnswer;\n\n      if (existing) {\n        const updated = await storage.updateResponse(existing.id, {\n          selectedAnswer,\n          isCorrect,\n        });\n        return res.json(updated);\n      }\n\n      const responseData = {\n        candidateId,\n        questionId,\n        selectedAnswer,\n        isCorrect,\n      };\n\n      const validatedData = insertResponseSchema.parse(responseData);\n      const response = await storage.createResponse(validatedData);\n      res.json(response);\n    } catch (error: any) {\n      console.error(\"Error saving response:\", error);\n      res.status(400).json({ message: error.message || \"Failed to save response\" });\n    }\n  });\n\n  // Submit exam\n  app.post(\"/api/exam-session/:candidateId/submit\", isAuthenticated, async (req: any, res) => {\n    try {\n      const candidateId = parseInt(req.params.candidateId);\n      const candidate = await storage.getCandidate(candidateId);\n      \n      if (!candidate) {\n        return res.status(404).json({ message: \"Candidate not found\" });\n      }\n\n      const userId = req.user.id;\n      if (candidate.userId !== userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n\n      // Calculate score\n      const responses = await storage.getResponses(candidateId);\n      const correctCount = responses.filter(r => r.isCorrect).length;\n      const totalCount = responses.length;\n      const score = totalCount > 0 ? Math.round((correctCount / totalCount) * 100) : 0;\n\n      // Update candidate\n      await storage.updateCandidate(candidateId, {\n        completedAt: new Date(),\n        score,\n        status: \"completed\",\n      });\n\n      // Log completion event\n      await storage.createProctorLog({\n        candidateId,\n        eventType: \"exam_complete\",\n        severity: \"low\",\n      });\n\n      res.json({ message: \"Exam submitted successfully\", score });\n    } catch (error) {\n      console.error(\"Error submitting exam:\", error);\n      res.status(500).json({ message: \"Failed to submit exam\" });\n    }\n  });\n\n  // Proctor logs\n  app.post(\"/api/proctor-logs\", isAuthenticated, async (req, res) => {\n    try {\n      const validatedData = insertProctorLogSchema.parse(req.body);\n      const log = await storage.createProctorLog(validatedData);\n      \n      // Broadcast to WebSocket clients\n      wss.clients.forEach(client => {\n        if (client.readyState === WebSocket.OPEN) {\n          client.send(JSON.stringify({ type: \"proctor_event\", data: log }));\n        }\n      });\n\n      res.json(log);\n    } catch (error: any) {\n      console.error(\"Error creating proctor log:\", error);\n      res.status(400).json({ message: error.message || \"Failed to log event\" });\n    }\n  });\n\n  // Get individual candidate (for results page)\n  app.get(\"/api/candidates/:id\", isAuthenticated, async (req: any, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      const candidate = await storage.getCandidate(id);\n      \n      if (!candidate) {\n        return res.status(404).json({ message: \"Candidate not found\" });\n      }\n\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      // Allow access if user is admin or owns the candidate session\n      if (user?.role !== \"admin\" && candidate.userId !== userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n\n      const exam = await storage.getExam(candidate.examId);\n      res.json({ ...candidate, exam });\n    } catch (error) {\n      console.error(\"Error fetching candidate:\", error);\n      res.status(500).json({ message: \"Failed to fetch candidate\" });\n    }\n  });\n\n  // Analytics routes\n  app.get(\"/api/analytics\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const allCandidates = await storage.getCandidates();\n      const allExams = await storage.getExams();\n      const allLogs = await storage.getProctorLogs();\n\n      const completedCandidates = allCandidates.filter(c => c.status === \"completed\");\n      const scores = completedCandidates.filter(c => c.score !== null).map(c => c.score!);\n      const averageScore = scores.length > 0 ? scores.reduce((a, b) => a + b, 0) / scores.length : 0;\n\n      // Status distribution\n      const statusCounts = allCandidates.reduce((acc: any, c) => {\n        acc[c.status] = (acc[c.status] || 0) + 1;\n        return acc;\n      }, {});\n      const statusDistribution = Object.entries(statusCounts).map(([name, value]) => ({ name, value }));\n\n      // Score distribution\n      const scoreRanges = ['0-20', '21-40', '41-60', '61-80', '81-100'];\n      const scoreDistribution = scoreRanges.map(range => {\n        const [min, max] = range.split('-').map(Number);\n        const count = scores.filter(s => s >= min && s <= max).length;\n        return { range, count };\n      });\n\n      // Completions over time (last 7 days)\n      const today = new Date();\n      const completionsOverTime = Array.from({ length: 7 }, (_, i) => {\n        const date = new Date(today);\n        date.setDate(date.getDate() - (6 - i));\n        const dateStr = date.toISOString().split('T')[0];\n        const completions = completedCandidates.filter(c => \n          c.completedAt && new Date(c.completedAt).toISOString().split('T')[0] === dateStr\n        ).length;\n        return { date: dateStr, completions };\n      });\n\n      // Violation types\n      const violationCounts = allLogs.reduce((acc: any, log) => {\n        acc[log.eventType] = (acc[log.eventType] || 0) + 1;\n        return acc;\n      }, {});\n      const violationTypes = Object.entries(violationCounts).map(([type, count]) => ({ type, count }));\n\n      // Exam performance\n      const examPerformance = await Promise.all(allExams.map(async (exam) => {\n        const examCandidates = allCandidates.filter(c => c.examId === exam.id);\n        const examCompleted = examCandidates.filter(c => c.status === \"completed\");\n        const examScores = examCompleted.filter(c => c.score !== null).map(c => c.score!);\n        const avgScore = examScores.length > 0 ? examScores.reduce((a, b) => a + b, 0) / examScores.length : 0;\n        const passingScore = 70; // Default passing score\n        const passRate = examScores.length > 0 ? (examScores.filter(s => s >= passingScore).length / examScores.length * 100) : 0;\n        const violations = allLogs.filter(log => examCandidates.some(c => c.id === log.candidateId)).length;\n\n        return {\n          examId: exam.id,\n          title: exam.title,\n          totalCandidates: examCandidates.length,\n          completed: examCompleted.length,\n          avgScore,\n          passRate,\n          violations,\n        };\n      }));\n\n      res.json({\n        totalExams: allExams.length,\n        activeExams: allExams.filter(e => e.status === \"active\").length,\n        totalCandidates: allCandidates.length,\n        completedCandidates: completedCandidates.length,\n        averageScore,\n        totalViolations: allLogs.length,\n        highSeverityViolations: allLogs.filter(l => l.severity === \"high\").length,\n        statusDistribution,\n        scoreDistribution,\n        completionsOverTime,\n        violationTypes,\n        examPerformance,\n      });\n    } catch (error) {\n      console.error(\"Analytics error:\", error);\n      res.status(500).json({ message: \"Failed to fetch analytics\" });\n    }\n  });\n\n  // Monitoring routes\n  app.get(\"/api/monitoring/active\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const examId = req.query.examId ? parseInt(req.query.examId as string) : undefined;\n      \n      // Fetch candidates based on exam ID filter\n      let candidates;\n      if (examId) {\n        candidates = await storage.getCandidatesByExam(examId);\n      } else {\n        candidates = await storage.getCandidates();\n      }\n      \n      const activeSessions = candidates.filter(c => c.status === \"in_progress\");\n\n      // Auto-expire stale sessions and prepare response\n      const sessionsWithDetails = await Promise.all(\n        activeSessions.map(async (candidate) => {\n          const user = await storage.getUser(candidate.userId);\n          const exam = await storage.getExam(candidate.examId);\n          \n          // Check if session has expired\n          if (candidate.startedAt && exam?.duration) {\n            const startTime = new Date(candidate.startedAt).getTime();\n            const currentTime = Date.now();\n            const elapsedMinutes = (currentTime - startTime) / (1000 * 60);\n            \n            // If elapsed time exceeds exam duration by more than 5 minutes, mark as auto-submitted (expired)\n            if (elapsedMinutes > exam.duration + 5) {\n              await storage.updateCandidate(candidate.id, { status: \"auto_submitted\" });\n              return null; // Exclude from active sessions\n            }\n            \n            const remainingMinutes = Math.max(0, exam.duration - elapsedMinutes);\n            \n            // Format as MM:SS\n            const minutes = Math.floor(remainingMinutes);\n            const seconds = Math.floor((remainingMinutes - minutes) * 60);\n            const timeRemaining = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n            \n            return { ...candidate, user, exam, timeRemaining };\n          }\n          \n          return { ...candidate, user, exam, timeRemaining: null };\n        })\n      );\n\n      // Filter out null entries (expired sessions)\n      const validSessions = sessionsWithDetails.filter(s => s !== null);\n\n      res.json(validSessions);\n    } catch (error) {\n      console.error(\"Error fetching active sessions:\", error);\n      res.status(500).json({ message: \"Failed to fetch active sessions\" });\n    }\n  });\n\n  app.get(\"/api/monitoring/logs\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const examId = req.query.examId ? parseInt(req.query.examId as string) : undefined;\n      const logs = await storage.getProctorLogs();\n      \n      // Filter by exam ID if provided\n      let filteredLogs = logs;\n      if (examId) {\n        const examCandidates = await storage.getCandidatesByExam(examId);\n        const candidateIds = examCandidates.map(c => c.id);\n        filteredLogs = logs.filter(log => candidateIds.includes(log.candidateId));\n      }\n      \n      const logsWithDetails = await Promise.all(\n        filteredLogs.slice(0, 20).map(async (log) => {\n          const candidate = await storage.getCandidate(log.candidateId);\n          let user = undefined;\n          if (candidate) {\n            user = await storage.getUser(candidate.userId);\n          }\n          return { ...log, candidate: candidate ? { ...candidate, user } : undefined };\n        })\n      );\n\n      res.json(logsWithDetails);\n    } catch (error) {\n      console.error(\"Error fetching proctor logs:\", error);\n      res.status(500).json({ message: \"Failed to fetch logs\" });\n    }\n  });\n\n  // Export all logs for an exam as CSV\n  app.get(\"/api/monitoring/logs/export\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const examId = req.query.examId ? parseInt(req.query.examId as string) : undefined;\n      \n      if (!examId) {\n        return res.status(400).json({ message: \"Exam ID required\" });\n      }\n\n      const logs = await storage.getProctorLogs();\n      const examCandidates = await storage.getCandidatesByExam(examId);\n      const candidateIds = examCandidates.map(c => c.id);\n      const filteredLogs = logs.filter(log => candidateIds.includes(log.candidateId));\n      \n      const logsWithDetails = await Promise.all(\n        filteredLogs.map(async (log) => {\n          const candidate = await storage.getCandidate(log.candidateId);\n          let user = undefined;\n          if (candidate) {\n            user = await storage.getUser(candidate.userId);\n          }\n          return { ...log, candidate: candidate ? { ...candidate, user } : undefined };\n        })\n      );\n\n      res.json(logsWithDetails);\n    } catch (error) {\n      console.error(\"Error exporting proctor logs:\", error);\n      res.status(500).json({ message: \"Failed to export logs\" });\n    }\n  });\n\n  // Check if email exists (admin only)\n  app.get(\"/api/users/check-email\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const email = req.query.email as string;\n      \n      if (!email) {\n        return res.status(400).json({ message: \"Email required\" });\n      }\n\n      const user = await storage.getUserByEmail(email);\n      res.json({ exists: !!user });\n    } catch (error) {\n      console.error(\"Error checking email:\", error);\n      res.status(500).json({ message: \"Failed to check email\" });\n    }\n  });\n\n  // Reset user password (admin only)\n  app.post(\"/api/users/reset-password\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const { userId, password } = req.body;\n      \n      if (!userId || !password) {\n        return res.status(400).json({ message: \"User ID and password required\" });\n      }\n\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      const passwordHash = await bcrypt.hash(password, SALT_ROUNDS);\n      await storage.updateUser(userId, { passwordHash });\n      \n      // Send email notification with new password\n      const candidates = await storage.getCandidatesByUser(userId);\n      if (candidates.length > 0 && user.email) {\n        // Get the first assigned exam for email context\n        const firstCandidate = candidates[0];\n        const exam = await storage.getExam(firstCandidate.examId);\n        \n        if (exam) {\n          try {\n            await sendCandidateCredentials({\n              email: user.email,\n              firstName: user.firstName || '',\n              lastName: user.lastName || '',\n              password,\n              examTitle: exam.title,\n              examDuration: exam.duration,\n            });\n          } catch (emailError) {\n            console.error(`Failed to send password reset email to ${user.email}:`, emailError);\n            // Don't fail the request if email fails\n          }\n        }\n      }\n      \n      res.json({ success: true, message: \"Password reset successfully\" });\n    } catch (error) {\n      console.error(\"Error resetting password:\", error);\n      res.status(500).json({ message: \"Failed to reset password\" });\n    }\n  });\n\n  // Allow candidate to retake exam (admin only)\n  app.post(\"/api/candidates/:id/allow-retake\", isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const candidateId = parseInt(req.params.id);\n      \n      const candidate = await storage.getCandidate(candidateId);\n      if (!candidate) {\n        return res.status(404).json({ message: \"Candidate not found\" });\n      }\n\n      // Reset candidate status to assigned and clear completion data\n      // Note: Previous responses are kept as historical data\n      await storage.updateCandidate(candidateId, {\n        status: \"assigned\",\n        startedAt: null,\n        completedAt: null,\n      });\n\n      res.json({ success: true, message: \"Candidate can now retake the exam\" });\n    } catch (error) {\n      console.error(\"Error allowing retake:\", error);\n      res.status(500).json({ message: \"Failed to allow retake\" });\n    }\n  });\n\n  // Catch-all 404 handler for undefined API routes\n  app.all(\"/api/auth/register-admin\", (_req, res) => {\n    res.status(404).json({ message: \"API endpoint not found\" });\n  });\n\n  const httpServer = createServer(app);\n\n  // WebSocket server for real-time monitoring (referenced from javascript_websocket blueprint)\n  const wss = new WebSocketServer({ server: httpServer, path: '/ws' });\n\n  // Track connected clients by type (candidate or admin) and ID\n  const clients = new Map<string, { ws: any; type: 'candidate' | 'admin'; id?: number }>();\n\n  wss.on('connection', (ws) => {\n    console.log('WebSocket client connected');\n    let clientId: string | null = null;\n\n    ws.on('message', (message) => {\n      try {\n        const data = JSON.parse(message.toString());\n        \n        // Handle client registration\n        if (data.type === 'register') {\n          clientId = data.clientType === 'candidate' \n            ? `candidate_${data.candidateId}` \n            : `admin_${Date.now()}`;\n          \n          clients.set(clientId, {\n            ws,\n            type: data.clientType,\n            id: data.candidateId\n          });\n          \n          console.log(`Client registered: ${clientId}`);\n          ws.send(JSON.stringify({ type: 'registered', clientId }));\n        }\n        \n        // Handle video frames from candidate\n        else if (data.type === 'video_frame' && data.candidateId) {\n          // Broadcast video frame to all connected admin clients\n          clients.forEach((client, id) => {\n            if (client.type === 'admin' && client.ws.readyState === 1) {\n              client.ws.send(JSON.stringify({\n                type: 'video_frame',\n                candidateId: data.candidateId,\n                frame: data.frame,\n                timestamp: Date.now()\n              }));\n            }\n          });\n        }\n        \n        // Handle proctor events (existing functionality)\n        else if (data.type === 'proctor_event') {\n          // Broadcast to all admin clients\n          clients.forEach((client, id) => {\n            if (client.type === 'admin' && client.ws.readyState === 1) {\n              client.ws.send(JSON.stringify(data));\n            }\n          });\n        }\n      } catch (error) {\n        console.error('WebSocket message error:', error);\n      }\n    });\n\n    ws.on('close', () => {\n      if (clientId) {\n        clients.delete(clientId);\n        console.log(`WebSocket client disconnected: ${clientId}`);\n      }\n    });\n  });\n\n  return httpServer;\n}\n","size_bytes":50496},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","size_bytes":116},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/pages/candidate/exam-session.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  ChevronLeft, \n  ChevronRight, \n  Flag, \n  Clock, \n  Camera,\n  AlertTriangle\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Question } from \"@shared/schema\";\nimport * as blazeface from \"@tensorflow-models/blazeface\";\nimport \"@tensorflow/tfjs\";\n\ninterface ExamSessionData {\n  candidateId: number;\n  examTitle: string;\n  duration: number;\n  questions: Question[];\n  randomizedQuestions: any[];\n  responses: any[];\n  timeRemaining: number;\n}\n\nexport default function ExamSessionPage({ \n  candidateId, \n  onComplete \n}: { \n  candidateId: number;\n  onComplete?: () => void;\n}) {\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [selectedAnswer, setSelectedAnswer] = useState<string | null>(null);\n  const [flaggedQuestions, setFlaggedQuestions] = useState<Set<number>>(new Set());\n  const [timeRemaining, setTimeRemaining] = useState(0);\n  const [isCameraActive, setIsCameraActive] = useState(false);\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [audioLevel, setAudioLevel] = useState(0);\n  const [isMicActive, setIsMicActive] = useState(false);\n  const [faceDetectionStatus, setFaceDetectionStatus] = useState<\"detecting\" | \"face_detected\" | \"no_face\" | \"multiple_faces\">(\"detecting\");\n  const [noiseWarningCount, setNoiseWarningCount] = useState(0);\n  const [faceWarningCount, setFaceWarningCount] = useState(0);\n  const [tabSwitchTimer, setTabSwitchTimer] = useState<number | null>(null);\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const audioContextRef = useRef<AudioContext | null>(null);\n  const analyserRef = useRef<AnalyserNode | null>(null);\n  const faceModelRef = useRef<blazeface.BlazeFaceModel | null>(null);\n  const tabSwitchTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const wsRef = useRef<WebSocket | null>(null);\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\n  const { toast } = useToast();\n\n  const { data: sessionData, isLoading } = useQuery<ExamSessionData>({\n    queryKey: [`/api/exam-session/${candidateId}`],\n  });\n\n  useEffect(() => {\n    if (sessionData) {\n      setTimeRemaining(sessionData.timeRemaining || sessionData.duration * 60);\n    }\n  }, [sessionData]);\n\n  // Restore selected answer when navigating between questions\n  useEffect(() => {\n    if (!sessionData) return;\n    \n    const currentQuestion = sessionData.randomizedQuestions[currentQuestionIndex];\n    const savedResponse = sessionData.responses.find(\n      (r: any) => r.questionId === currentQuestion.id\n    );\n    \n    if (savedResponse) {\n      setSelectedAnswer(savedResponse.selectedAnswer);\n    } else {\n      setSelectedAnswer(null);\n    }\n  }, [currentQuestionIndex, sessionData]);\n\n  // Timer\n  useEffect(() => {\n    if (timeRemaining <= 0) return;\n\n    const interval = setInterval(() => {\n      setTimeRemaining((prev) => {\n        if (prev <= 1) {\n          handleAutoSubmit();\n          return 0;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [timeRemaining]);\n\n  // Webcam and Microphone\n  useEffect(() => {\n    const startCameraAndMic = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ \n          video: true, \n          audio: true \n        });\n        \n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          setIsCameraActive(true);\n        }\n\n        // Setup audio analysis\n        const audioContext = new AudioContext();\n        const source = audioContext.createMediaStreamSource(stream);\n        const analyser = audioContext.createAnalyser();\n        analyser.fftSize = 256;\n        \n        source.connect(analyser);\n        audioContextRef.current = audioContext;\n        analyserRef.current = analyser;\n        setIsMicActive(true);\n\n        // Monitor audio levels\n        const dataArray = new Uint8Array(analyser.frequencyBinCount);\n        let silenceStartTime: number | null = null;\n        let highNoiseStartTime: number | null = null;\n\n        const checkAudioLevel = () => {\n          if (!analyserRef.current) return;\n\n          analyser.getByteFrequencyData(dataArray);\n          const average = dataArray.reduce((a, b) => a + b) / dataArray.length;\n          setAudioLevel(Math.round(average));\n\n          const now = Date.now();\n          \n          // Detect prolonged silence (no speech for 30 seconds)\n          if (average < 5) {\n            if (!silenceStartTime) silenceStartTime = now;\n            if (now - silenceStartTime > 30000) {\n              logProctorEvent(\"voice_absence\", \"low\");\n              silenceStartTime = now; // Reset to avoid spam\n            }\n          } else {\n            silenceStartTime = null;\n          }\n\n          // Detect loud background noise\n          if (average > 80) {\n            if (!highNoiseStartTime) highNoiseStartTime = now;\n            if (now - highNoiseStartTime > 3000) {\n              logProctorEvent(\"background_noise\", \"medium\");\n              setNoiseWarningCount(prev => {\n                const newCount = prev + 1;\n                if (newCount >= 3) {\n                  toast({\n                    title: \"Exam Terminated\",\n                    description: \"You have been logged out due to excessive background noise violations.\",\n                    variant: \"destructive\",\n                  });\n                  setTimeout(() => {\n                    submitMutation.mutate();\n                  }, 2000);\n                } else {\n                  toast({\n                    title: `Background Noise Warning (${newCount}/3)`,\n                    description: \"High audio levels detected. Please minimize background noise or you will be logged out.\",\n                    variant: \"destructive\",\n                  });\n                }\n                return newCount;\n              });\n              highNoiseStartTime = now;\n            }\n          } else {\n            highNoiseStartTime = null;\n          }\n\n          requestAnimationFrame(checkAudioLevel);\n        };\n\n        checkAudioLevel();\n\n      } catch (error) {\n        toast({\n          title: \"Media Error\",\n          description: \"Unable to access camera/microphone. Please check permissions.\",\n          variant: \"destructive\",\n        });\n      }\n    };\n\n    startCameraAndMic();\n\n    return () => {\n      if (videoRef.current?.srcObject) {\n        const stream = videoRef.current.srcObject as MediaStream;\n        stream.getTracks().forEach(track => track.stop());\n      }\n      if (audioContextRef.current) {\n        audioContextRef.current.close();\n      }\n    };\n  }, []);\n\n  // WebSocket connection for video streaming\n  useEffect(() => {\n    if (!candidateId) return;\n\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n    const wsUrl = `${protocol}//${window.location.host}/ws`;\n    \n    const ws = new WebSocket(wsUrl);\n    wsRef.current = ws;\n\n    ws.onopen = () => {\n      console.log('WebSocket connected for video streaming');\n      ws.send(JSON.stringify({\n        type: 'register',\n        clientType: 'candidate',\n        candidateId: candidateId\n      }));\n    };\n\n    ws.onerror = (error) => {\n      console.error('WebSocket error:', error);\n    };\n\n    ws.onclose = () => {\n      console.log('WebSocket disconnected');\n    };\n\n    // Setup canvas for capturing video frames\n    const canvas = document.createElement('canvas');\n    canvasRef.current = canvas;\n    canvas.width = 320; // Reduced size for better performance\n    canvas.height = 240;\n    const ctx = canvas.getContext('2d');\n\n    // Send video frames every 500ms (2 fps to reduce bandwidth)\n    const frameInterval = setInterval(() => {\n      if (videoRef.current && ctx && isCameraActive && \n          ws.readyState === WebSocket.OPEN) {\n        try {\n          ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n          const frame = canvas.toDataURL('image/jpeg', 0.5); // Compress to 50% quality\n          \n          ws.send(JSON.stringify({\n            type: 'video_frame',\n            candidateId: candidateId,\n            frame: frame\n          }));\n        } catch (error) {\n          console.error('Error sending video frame:', error);\n        }\n      }\n    }, 500);\n\n    return () => {\n      clearInterval(frameInterval);\n      if (ws.readyState === WebSocket.OPEN) {\n        ws.close();\n      }\n    };\n  }, [candidateId, isCameraActive]);\n\n  // Face Detection with TensorFlow.js\n  useEffect(() => {\n    const loadFaceDetection = async () => {\n      try {\n        const model = await blazeface.load();\n        faceModelRef.current = model;\n        \n        let noFaceStartTime: number | null = null;\n        let multipleFacesStartTime: number | null = null;\n\n        const detectFaces = async () => {\n          if (!videoRef.current || !faceModelRef.current || videoRef.current.readyState < 2) {\n            requestAnimationFrame(detectFaces);\n            return;\n          }\n\n          const predictions = await faceModelRef.current.estimateFaces(videoRef.current, false);\n          const now = Date.now();\n\n          if (predictions.length === 0) {\n            setFaceDetectionStatus(\"no_face\");\n            if (!noFaceStartTime) noFaceStartTime = now;\n            \n            // Log if no face detected for more than 10 seconds\n            if (now - noFaceStartTime > 10000) {\n              logProctorEvent(\"face_absent\", \"high\");\n              setFaceWarningCount(prev => {\n                const newCount = prev + 1;\n                if (newCount >= 3) {\n                  toast({\n                    title: \"Exam Terminated\",\n                    description: \"You have been logged out due to repeated failure to maintain camera focus.\",\n                    variant: \"destructive\",\n                  });\n                  setTimeout(() => {\n                    submitMutation.mutate();\n                  }, 2000);\n                } else {\n                  toast({\n                    title: `Camera Focus Warning (${newCount}/3)`,\n                    description: \"Please ensure your face is visible to the camera or you will be logged out.\",\n                    variant: \"destructive\",\n                  });\n                }\n                return newCount;\n              });\n              noFaceStartTime = now; // Reset to avoid spam\n            }\n          } else if (predictions.length > 1) {\n            setFaceDetectionStatus(\"multiple_faces\");\n            if (!multipleFacesStartTime) multipleFacesStartTime = now;\n            \n            // Log if multiple faces detected for more than 5 seconds\n            if (now - multipleFacesStartTime > 5000) {\n              logProctorEvent(\"multiple_faces\", \"high\");\n              toast({\n                title: \"Multiple Faces Detected\",\n                description: \"Only the candidate should be visible in the camera.\",\n                variant: \"destructive\",\n              });\n              multipleFacesStartTime = now;\n            }\n          } else {\n            setFaceDetectionStatus(\"face_detected\");\n            noFaceStartTime = null;\n            multipleFacesStartTime = null;\n          }\n\n          requestAnimationFrame(detectFaces);\n        };\n\n        detectFaces();\n      } catch (error) {\n        console.error(\"Face detection error:\", error);\n      }\n    };\n\n    loadFaceDetection();\n  }, [isCameraActive]);\n\n  // Full-screen enforcement\n  useEffect(() => {\n    const enterFullscreen = async () => {\n      try {\n        await document.documentElement.requestFullscreen();\n        setIsFullscreen(true);\n      } catch (error) {\n        toast({\n          title: \"Fullscreen Required\",\n          description: \"Please enable fullscreen mode to continue the exam.\",\n          variant: \"destructive\",\n        });\n      }\n    };\n\n    const handleFullscreenChange = () => {\n      const inFullscreen = !!document.fullscreenElement;\n      setIsFullscreen(inFullscreen);\n      \n      if (!inFullscreen) {\n        logProctorEvent(\"fullscreen_exit\", \"high\");\n        toast({\n          title: \"Fullscreen Exited\",\n          description: \"Exiting fullscreen mode is not allowed. This has been logged.\",\n          variant: \"destructive\",\n        });\n        \n        // Re-enter fullscreen after a short delay\n        setTimeout(() => {\n          enterFullscreen();\n        }, 1000);\n      }\n    };\n\n    enterFullscreen();\n    document.addEventListener(\"fullscreenchange\", handleFullscreenChange);\n    \n    return () => {\n      document.removeEventListener(\"fullscreenchange\", handleFullscreenChange);\n      if (document.fullscreenElement) {\n        document.exitFullscreen().catch(() => {});\n      }\n    };\n  }, []);\n\n  // Tab switch detection with 10-second countdown\n  useEffect(() => {\n    const handleVisibilityChange = () => {\n      if (document.hidden) {\n        logProctorEvent(\"tab_switch\", \"high\");\n        \n        // Start 10-second countdown\n        setTabSwitchTimer(10);\n        \n        toast({\n          title: \"Warning: Return to Exam\",\n          description: \"You will be automatically logged out in 10 seconds if you don't return to this tab.\",\n          variant: \"destructive\",\n        });\n\n        // Clear any existing timeout\n        if (tabSwitchTimeoutRef.current) {\n          clearTimeout(tabSwitchTimeoutRef.current);\n        }\n\n        // Set 10-second auto-logout\n        tabSwitchTimeoutRef.current = setTimeout(() => {\n          toast({\n            title: \"Exam Terminated\",\n            description: \"You have been logged out due to leaving the exam tab.\",\n            variant: \"destructive\",\n          });\n          setTimeout(() => {\n            submitMutation.mutate();\n          }, 2000);\n        }, 10000);\n      } else {\n        // Tab is visible again - cancel logout\n        if (tabSwitchTimeoutRef.current) {\n          clearTimeout(tabSwitchTimeoutRef.current);\n          tabSwitchTimeoutRef.current = null;\n          setTabSwitchTimer(null);\n          toast({\n            title: \"Welcome Back\",\n            description: \"Logout cancelled. Please stay focused on the exam.\",\n          });\n        }\n      }\n    };\n\n    document.addEventListener(\"visibilitychange\", handleVisibilityChange);\n    return () => {\n      document.removeEventListener(\"visibilitychange\", handleVisibilityChange);\n      if (tabSwitchTimeoutRef.current) {\n        clearTimeout(tabSwitchTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  // Update tab switch countdown timer\n  useEffect(() => {\n    if (tabSwitchTimer === null || tabSwitchTimer <= 0) return;\n\n    const interval = setInterval(() => {\n      setTabSwitchTimer(prev => {\n        if (prev === null) return prev;\n        if (prev <= 1) return 0;\n        return prev - 1;\n      });\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [tabSwitchTimer]);\n\n  const logProctorEvent = async (eventType: string, severity: string) => {\n    try {\n      await apiRequest(\"POST\", \"/api/proctor-logs\", {\n        candidateId,\n        eventType,\n        severity,\n      });\n    } catch (error) {\n      console.error(\"Failed to log proctor event:\", error);\n    }\n  };\n\n  const saveMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/responses\", data);\n    },\n    onSuccess: () => {\n      // Invalidate session data to refresh responses and show answered questions\n      queryClient.invalidateQueries({ queryKey: [`/api/exam-session/${candidateId}`] });\n    },\n  });\n\n  const submitMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"POST\", `/api/exam-session/${candidateId}/submit`, {});\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Exam submitted successfully\",\n      });\n      if (onComplete) {\n        onComplete();\n      } else {\n        window.location.href = \"/\";\n      }\n    },\n  });\n\n  const handleAnswerSelect = (answer: string) => {\n    setSelectedAnswer(answer);\n    \n    if (sessionData) {\n      const question = sessionData.randomizedQuestions[currentQuestionIndex];\n      saveMutation.mutate({\n        candidateId,\n        questionId: question.id,\n        selectedAnswer: answer,\n      });\n    }\n  };\n\n  const handleAutoSubmit = () => {\n    submitMutation.mutate();\n  };\n\n  const handleNext = () => {\n    if (sessionData && currentQuestionIndex < sessionData.randomizedQuestions.length - 1) {\n      setCurrentQuestionIndex(currentQuestionIndex + 1);\n    }\n  };\n\n  const handlePrevious = () => {\n    if (currentQuestionIndex > 0) {\n      setCurrentQuestionIndex(currentQuestionIndex - 1);\n    }\n  };\n\n  const toggleFlag = () => {\n    const newFlagged = new Set(flaggedQuestions);\n    if (newFlagged.has(currentQuestionIndex)) {\n      newFlagged.delete(currentQuestionIndex);\n    } else {\n      newFlagged.add(currentQuestionIndex);\n    }\n    setFlaggedQuestions(newFlagged);\n  };\n\n  const isQuestionAnswered = (questionIndex: number) => {\n    if (!sessionData) return false;\n    const question = sessionData.randomizedQuestions[questionIndex];\n    return sessionData.responses.some((r: any) => r.questionId === question.id);\n  };\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins.toString().padStart(2, \"0\")}:${secs.toString().padStart(2, \"0\")}`;\n  };\n\n  if (isLoading || !sessionData) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <p className=\"text-muted-foreground\">Loading exam...</p>\n      </div>\n    );\n  }\n\n  const currentQuestion = sessionData.randomizedQuestions[currentQuestionIndex];\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Fixed Header */}\n      <div className=\"sticky top-0 z-50 border-b bg-background\">\n        <div className=\"max-w-7xl mx-auto px-2 sm:px-4 py-3 sm:py-4\">\n          <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-4\">\n            <div className=\"flex items-center gap-2 sm:gap-4 flex-wrap\">\n              <h1 className=\"font-semibold text-sm sm:text-base\" data-testid=\"text-exam-title\">{sessionData.examTitle}</h1>\n              <Badge variant=\"outline\" data-testid=\"text-question-number\">\n                Q {currentQuestionIndex + 1}/{sessionData.randomizedQuestions.length}\n              </Badge>\n            </div>\n\n            <div className=\"flex items-center gap-2 flex-wrap\">\n              {/* Warning Indicators */}\n              {noiseWarningCount > 0 && (\n                <Badge variant=\"outline\" className=\"bg-destructive/10 text-destructive\">\n                  <AlertTriangle className=\"h-3 w-3 mr-1\" />\n                  Noise: {noiseWarningCount}/3\n                </Badge>\n              )}\n              {faceWarningCount > 0 && (\n                <Badge variant=\"outline\" className=\"bg-destructive/10 text-destructive\">\n                  <AlertTriangle className=\"h-3 w-3 mr-1\" />\n                  Focus: {faceWarningCount}/3\n                </Badge>\n              )}\n              {tabSwitchTimer !== null && (\n                <Badge variant=\"outline\" className=\"bg-destructive/10 text-destructive animate-pulse\">\n                  <AlertTriangle className=\"h-3 w-3 mr-1\" />\n                  Logout in: {tabSwitchTimer}s\n                </Badge>\n              )}\n              \n              {isCameraActive && (\n                <Badge \n                  variant=\"outline\" \n                  className={\n                    faceDetectionStatus === \"face_detected\" ? \"bg-chart-2/10 text-chart-2\" :\n                    faceDetectionStatus === \"multiple_faces\" ? \"bg-destructive/10 text-destructive\" :\n                    faceDetectionStatus === \"no_face\" ? \"bg-chart-4/10 text-chart-4\" :\n                    \"bg-muted text-muted-foreground\"\n                  }\n                >\n                  <Camera className=\"h-3 w-3 mr-1\" />\n                  {faceDetectionStatus === \"face_detected\" ? \"Face OK\" :\n                   faceDetectionStatus === \"multiple_faces\" ? \"Multiple Faces\" :\n                   faceDetectionStatus === \"no_face\" ? \"No Face\" :\n                   \"Detecting...\"}\n                </Badge>\n              )}\n              {isMicActive && (\n                <Badge variant=\"outline\" className=\"bg-chart-3/10 text-chart-3\">\n                  <svg className=\"h-3 w-3 mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path d=\"M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z\"/>\n                    <path d=\"M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z\"/>\n                  </svg>\n                  Audio: {audioLevel}%\n                </Badge>\n              )}\n              <Badge \n                variant=\"outline\" \n                className={timeRemaining < 300 ? \"bg-destructive/10 text-destructive\" : \"bg-chart-3/10 text-chart-3\"}\n                data-testid=\"text-timer\"\n              >\n                <Clock className=\"h-3 w-3 mr-1\" />\n                {formatTime(timeRemaining)}\n              </Badge>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"max-w-4xl mx-auto px-2 sm:px-4 py-4 sm:py-8\">\n        <Card className=\"p-4 sm:p-8\">\n          <div className=\"space-y-6\">\n            <div className=\"flex items-start justify-between gap-4\">\n              <h2 className=\"text-lg sm:text-xl font-medium flex-1\" data-testid=\"text-question-content\">\n                {currentQuestion.content}\n              </h2>\n              <Button\n                variant=\"outline\"\n                size=\"icon\"\n                onClick={toggleFlag}\n                className={flaggedQuestions.has(currentQuestionIndex) ? \"bg-chart-4/10 text-chart-4\" : \"\"}\n                data-testid=\"button-flag-question\"\n              >\n                <Flag className=\"h-4 w-4\" />\n              </Button>\n            </div>\n\n            <div className=\"space-y-3\">\n              {(currentQuestion.options as string[]).map((option, index) => (\n                <button\n                  key={index}\n                  onClick={() => handleAnswerSelect(option)}\n                  className={`w-full text-left p-4 rounded-lg border transition-colors hover-elevate ${\n                    selectedAnswer === option\n                      ? \"border-primary bg-primary/5\"\n                      : \"border-border\"\n                  }`}\n                  data-testid={`option-${index}`}\n                >\n                  <div className=\"flex items-start gap-3\">\n                    <div className={`h-5 w-5 rounded-full border-2 flex items-center justify-center mt-0.5 ${\n                      selectedAnswer === option ? \"border-primary\" : \"border-muted-foreground\"\n                    }`}>\n                      {selectedAnswer === option && (\n                        <div className=\"h-2.5 w-2.5 rounded-full bg-primary\" />\n                      )}\n                    </div>\n                    <span>{String.fromCharCode(65 + index)}. {option}</span>\n                  </div>\n                </button>\n              ))}\n            </div>\n          </div>\n        </Card>\n\n        {/* Navigation */}\n        <div className=\"space-y-4 mt-6\">\n          {/* Question Number Grid - Responsive */}\n          <div className=\"overflow-x-auto\">\n            <div className=\"flex flex-wrap gap-2 justify-center min-w-0 p-2\">\n              {sessionData.randomizedQuestions.map((_, index) => {\n                const isAnswered = isQuestionAnswered(index);\n                const isCurrent = index === currentQuestionIndex;\n                const isFlagged = flaggedQuestions.has(index);\n                \n                return (\n                  <button\n                    key={index}\n                    onClick={() => setCurrentQuestionIndex(index)}\n                    className={`h-8 w-8 flex-shrink-0 rounded-md text-sm font-medium transition-colors ${\n                      isCurrent\n                        ? \"bg-primary text-primary-foreground\"\n                        : isFlagged\n                        ? \"bg-chart-4/20 text-chart-4 border border-chart-4\"\n                        : isAnswered\n                        ? \"bg-chart-2/20 text-chart-2 border border-chart-2\"\n                        : \"bg-muted hover-elevate\"\n                    }`}\n                    data-testid={`nav-question-${index}`}\n                  >\n                    {index + 1}\n                  </button>\n                );\n              })}\n            </div>\n          </div>\n\n          {/* Previous/Next/Submit Buttons */}\n          <div className=\"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2 sm:gap-4\">\n            <Button\n              variant=\"outline\"\n              onClick={handlePrevious}\n              disabled={currentQuestionIndex === 0}\n              data-testid=\"button-previous\"\n              className=\"w-full sm:w-auto\"\n            >\n              <ChevronLeft className=\"h-4 w-4 mr-2\" />\n              <span className=\"hidden sm:inline\">Previous</span>\n              <span className=\"sm:hidden\">Prev</span>\n            </Button>\n\n            <div className=\"flex gap-2 w-full sm:w-auto\">\n              {currentQuestionIndex < sessionData.randomizedQuestions.length - 1 && (\n                <Button\n                  variant=\"outline\"\n                  onClick={handleNext}\n                  data-testid=\"button-next\"\n                  className=\"flex-1 sm:flex-initial\"\n                >\n                  <span className=\"hidden sm:inline\">Next</span>\n                  <span className=\"sm:hidden\">Next</span>\n                  <ChevronRight className=\"h-4 w-4 ml-2\" />\n                </Button>\n              )}\n              <Button\n                onClick={() => submitMutation.mutate()}\n                disabled={submitMutation.isPending}\n                data-testid=\"button-submit\"\n                className=\"flex-1 sm:flex-initial\"\n              >\n                <span className=\"hidden sm:inline\">{submitMutation.isPending ? \"Submitting...\" : \"Submit Exam\"}</span>\n                <span className=\"sm:hidden\">{submitMutation.isPending ? \"Submitting...\" : \"Submit\"}</span>\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        {/* Camera Preview (small, bottom corner) - Responsive */}\n        <div className=\"fixed bottom-4 right-2 sm:right-4 w-32 h-24 sm:w-48 sm:h-36 rounded-lg overflow-hidden border-2 border-primary shadow-lg\">\n          <video\n            ref={videoRef}\n            autoPlay\n            playsInline\n            muted\n            className=\"w-full h-full object-cover\"\n            data-testid=\"video-camera-feed\"\n          />\n          {!isCameraActive && (\n            <div className=\"absolute inset-0 bg-muted flex items-center justify-center\">\n              <AlertTriangle className=\"h-4 w-4 sm:h-6 sm:w-6 text-muted-foreground\" />\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":27334},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/theme-provider.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\ntype Theme = \"dark\" | \"light\";\n\ntype ThemeProviderProps = {\n  children: React.ReactNode;\n  defaultTheme?: Theme;\n};\n\ntype ThemeProviderState = {\n  theme: Theme;\n  setTheme: (theme: Theme) => void;\n};\n\nconst ThemeProviderContext = createContext<ThemeProviderState | undefined>(\n  undefined\n);\n\nexport function ThemeProvider({\n  children,\n  defaultTheme = \"light\",\n}: ThemeProviderProps) {\n  const [theme, setTheme] = useState<Theme>(\n    () => (localStorage.getItem(\"theme\") as Theme) || defaultTheme\n  );\n\n  useEffect(() => {\n    const root = document.documentElement;\n    root.classList.remove(\"light\", \"dark\");\n    root.classList.add(theme);\n    localStorage.setItem(\"theme\", theme);\n  }, [theme]);\n\n  return (\n    <ThemeProviderContext.Provider value={{ theme, setTheme }}>\n      {children}\n    </ThemeProviderContext.Provider>\n  );\n}\n\nexport const useTheme = () => {\n  const context = useContext(ThemeProviderContext);\n  if (context === undefined)\n    throw new Error(\"useTheme must be used within a ThemeProvider\");\n  return context;\n};\n","size_bytes":1115},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  // API 404 handler - must come after all API routes but before Vite fallback\n  app.use(\"/api/*\", (_req: Request, res: Response) => {\n    res.status(404).json({ message: \"API endpoint not found\" });\n  });\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2273},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/pages/candidate/exam-results.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { CheckCircle, XCircle, Clock } from \"lucide-react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport type { Candidate, Exam } from \"@shared/schema\";\nimport { useLocation } from \"wouter\";\n\ninterface CandidateWithExam extends Candidate {\n  exam?: Exam;\n}\n\nexport default function ExamResults({ candidateId }: { candidateId: number }) {\n  const [, setLocation] = useLocation();\n\n  const { data: candidate, isLoading } = useQuery<CandidateWithExam>({\n    queryKey: [\"/api/candidates\", candidateId],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Skeleton className=\"h-96 w-full max-w-2xl\" />\n      </div>\n    );\n  }\n\n  if (!candidate) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <p className=\"text-muted-foreground\">Results not found</p>\n      </div>\n    );\n  }\n\n  const exam = candidate.exam;\n  const resultVisibility = exam?.showResults || \"delayed\";\n  const showResults = resultVisibility === \"immediate\";\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4 sm:p-6\">\n      <Card className=\"max-w-2xl w-full p-6 sm:p-8\">\n        <div className=\"text-center mb-6 sm:mb-8\">\n          <div className={`h-16 w-16 sm:h-20 sm:w-20 rounded-full mx-auto mb-4 flex items-center justify-center ${\n            showResults && candidate.score !== null && candidate.score !== undefined && candidate.score >= 70 ? \"bg-chart-2/10\" : \n            showResults && candidate.score !== null && candidate.score !== undefined ? \"bg-destructive/10\" :\n            \"bg-muted\"\n          }`}>\n            {showResults ? (\n              candidate.score !== null && candidate.score !== undefined && candidate.score >= 70 ? (\n                <CheckCircle className=\"h-8 w-8 sm:h-10 sm:w-10 text-chart-2\" />\n              ) : (\n                <XCircle className=\"h-8 w-8 sm:h-10 sm:w-10 text-destructive\" />\n              )\n            ) : (\n              <Clock className=\"h-8 w-8 sm:h-10 sm:w-10 text-muted-foreground\" />\n            )}\n          </div>\n\n          <h1 className=\"text-xl sm:text-2xl font-semibold mb-2\" data-testid=\"text-exam-title\">\n            {exam?.title || \"Exam Complete\"}\n          </h1>\n\n          {showResults ? (\n            <>\n              <p className=\"text-3xl sm:text-4xl font-bold mb-2\" data-testid=\"text-score\">\n                {candidate.score}%\n              </p>\n              <p className=\"text-sm sm:text-base text-muted-foreground\" data-testid=\"text-result-message\">\n                {candidate.score && candidate.score >= 70 \n                  ? \"Congratulations! You passed the exam.\"\n                  : \"You did not pass this time. Keep practicing!\"}\n              </p>\n            </>\n          ) : resultVisibility === \"delayed\" ? (\n            <p className=\"text-base sm:text-lg text-muted-foreground\" data-testid=\"text-delayed-message\">\n              Your exam has been submitted successfully. Results will be published later by your administrator.\n            </p>\n          ) : (\n            <p className=\"text-base sm:text-lg text-muted-foreground\" data-testid=\"text-hidden-message\">\n              Your exam has been submitted successfully. Results are not available for this exam.\n            </p>\n          )}\n        </div>\n\n        {showResults && candidate.completedAt && (\n          <div className=\"bg-muted/50 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6\">\n            <div className=\"flex items-center gap-2 sm:gap-3 justify-center text-xs sm:text-sm text-muted-foreground\">\n              <Clock className=\"h-3 w-3 sm:h-4 sm:w-4\" />\n              <span className=\"text-center\">Completed on {new Date(candidate.completedAt).toLocaleString()}</span>\n            </div>\n          </div>\n        )}\n\n        <Button\n          className=\"w-full\"\n          onClick={() => setLocation(\"/\")}\n          data-testid=\"button-back-to-exams\"\n        >\n          Back to My Exams\n        </Button>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":4160},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"shared/schema.ts":{"content":"import { sql } from 'drizzle-orm';\nimport {\n  index,\n  jsonb,\n  pgTable,\n  timestamp,\n  varchar,\n  text,\n  integer,\n  boolean,\n  serial,\n} from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Session storage table (required for Replit Auth)\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User storage table with password authentication\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique().notNull(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  passwordHash: varchar(\"password_hash\"),\n  invitationToken: varchar(\"invitation_token\"),\n  invitedAt: timestamp(\"invited_at\"),\n  resetPasswordToken: varchar(\"reset_password_token\"),\n  resetPasswordExpiry: timestamp(\"reset_password_expiry\"),\n  role: varchar(\"role\", { enum: [\"admin\", \"candidate\"] }).notNull().default(\"candidate\"),\n  department: varchar(\"department\", { length: 255 }),\n  matricNo: varchar(\"matric_no\", { length: 100 }),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n\n// Domains table\nexport const domains = pgTable(\"domains\", {\n  id: serial(\"id\").primaryKey(),\n  name: varchar(\"name\", { length: 255 }).notNull(),\n  description: text(\"description\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertDomainSchema = createInsertSchema(domains).omit({ id: true, createdAt: true });\nexport type InsertDomain = z.infer<typeof insertDomainSchema>;\nexport type Domain = typeof domains.$inferSelect;\n\n// Questions table\nexport const questions = pgTable(\"questions\", {\n  id: serial(\"id\").primaryKey(),\n  domainId: integer(\"domain_id\").notNull().references(() => domains.id, { onDelete: \"cascade\" }),\n  type: varchar(\"type\", { enum: [\"multiple_choice\", \"true_false\"] }).notNull().default(\"multiple_choice\"),\n  content: text(\"content\").notNull(),\n  options: jsonb(\"options\").notNull().$type<string[]>(),\n  correctAnswer: varchar(\"correct_answer\", { length: 500 }).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertQuestionSchema = createInsertSchema(questions).omit({ id: true, createdAt: true });\nexport type InsertQuestion = z.infer<typeof insertQuestionSchema>;\nexport type Question = typeof questions.$inferSelect;\n\n// Exams table\nexport const exams = pgTable(\"exams\", {\n  id: serial(\"id\").primaryKey(),\n  domainId: integer(\"domain_id\").notNull().references(() => domains.id, { onDelete: \"cascade\" }),\n  title: varchar(\"title\", { length: 255 }).notNull(),\n  description: text(\"description\"),\n  duration: integer(\"duration\").notNull(), // in minutes\n  questionCount: integer(\"question_count\").notNull(),\n  startTime: timestamp(\"start_time\"),\n  endTime: timestamp(\"end_time\"),\n  showResults: varchar(\"show_results\", { enum: [\"immediate\", \"delayed\", \"hidden\"] }).notNull().default(\"delayed\"),\n  status: varchar(\"status\", { enum: [\"draft\", \"active\", \"inactive\"] }).notNull().default(\"draft\"),\n  enableWebcam: boolean(\"enable_webcam\").notNull().default(true),\n  enableTabDetection: boolean(\"enable_tab_detection\").notNull().default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertExamSchema = createInsertSchema(exams).omit({ id: true, createdAt: true });\nexport type InsertExam = z.infer<typeof insertExamSchema>;\nexport type Exam = typeof exams.$inferSelect;\n\n// Exam Questions (for randomization)\nexport const examQuestions = pgTable(\"exam_questions\", {\n  id: serial(\"id\").primaryKey(),\n  examId: integer(\"exam_id\").notNull().references(() => exams.id, { onDelete: \"cascade\" }),\n  questionId: integer(\"question_id\").notNull().references(() => questions.id, { onDelete: \"cascade\" }),\n  orderIndex: integer(\"order_index\").notNull(),\n});\n\nexport type ExamQuestion = typeof examQuestions.$inferSelect;\n\n// Candidates (exam sessions)\nexport const candidates = pgTable(\"candidates\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  examId: integer(\"exam_id\").notNull().references(() => exams.id, { onDelete: \"cascade\" }),\n  randomSeed: varchar(\"random_seed\", { length: 100 }).notNull(),\n  startedAt: timestamp(\"started_at\"),\n  completedAt: timestamp(\"completed_at\"),\n  score: integer(\"score\"),\n  status: varchar(\"status\", { enum: [\"assigned\", \"in_progress\", \"completed\", \"auto_submitted\"] }).notNull().default(\"assigned\"),\n});\n\nexport const insertCandidateSchema = createInsertSchema(candidates).omit({ id: true });\nexport type InsertCandidate = z.infer<typeof insertCandidateSchema>;\nexport type Candidate = typeof candidates.$inferSelect;\n\n// Responses\nexport const responses = pgTable(\"responses\", {\n  id: serial(\"id\").primaryKey(),\n  candidateId: integer(\"candidate_id\").notNull().references(() => candidates.id, { onDelete: \"cascade\" }),\n  questionId: integer(\"question_id\").notNull().references(() => questions.id, { onDelete: \"cascade\" }),\n  selectedAnswer: varchar(\"selected_answer\", { length: 500 }),\n  isCorrect: boolean(\"is_correct\"),\n  timeSpent: integer(\"time_spent\"), // in seconds\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertResponseSchema = createInsertSchema(responses).omit({ id: true, createdAt: true });\nexport type InsertResponse = z.infer<typeof insertResponseSchema>;\nexport type Response = typeof responses.$inferSelect;\n\n// Proctor Logs\nexport const proctorLogs = pgTable(\"proctor_logs\", {\n  id: serial(\"id\").primaryKey(),\n  candidateId: integer(\"candidate_id\").notNull().references(() => candidates.id, { onDelete: \"cascade\" }),\n  eventType: varchar(\"event_type\", { enum: [\"face_absent\", \"multiple_faces\", \"tab_switch\", \"external_voice\", \"exam_start\", \"exam_complete\"] }).notNull(),\n  severity: varchar(\"severity\", { enum: [\"low\", \"medium\", \"high\"] }).notNull().default(\"low\"),\n  metadata: jsonb(\"metadata\"),\n  timestamp: timestamp(\"timestamp\").defaultNow().notNull(),\n});\n\nexport const insertProctorLogSchema = createInsertSchema(proctorLogs).omit({ id: true, timestamp: true });\nexport type InsertProctorLog = z.infer<typeof insertProctorLogSchema>;\nexport type ProctorLog = typeof proctorLogs.$inferSelect;\n\n// Relations\nexport const domainsRelations = relations(domains, ({ many }) => ({\n  questions: many(questions),\n  exams: many(exams),\n}));\n\nexport const questionsRelations = relations(questions, ({ one, many }) => ({\n  domain: one(domains, {\n    fields: [questions.domainId],\n    references: [domains.id],\n  }),\n  examQuestions: many(examQuestions),\n  responses: many(responses),\n}));\n\nexport const examsRelations = relations(exams, ({ one, many }) => ({\n  domain: one(domains, {\n    fields: [exams.domainId],\n    references: [domains.id],\n  }),\n  examQuestions: many(examQuestions),\n  candidates: many(candidates),\n}));\n\nexport const candidatesRelations = relations(candidates, ({ one, many }) => ({\n  user: one(users, {\n    fields: [candidates.userId],\n    references: [users.id],\n  }),\n  exam: one(exams, {\n    fields: [candidates.examId],\n    references: [exams.id],\n  }),\n  responses: many(responses),\n  proctorLogs: many(proctorLogs),\n}));\n\nexport const responsesRelations = relations(responses, ({ one }) => ({\n  candidate: one(candidates, {\n    fields: [responses.candidateId],\n    references: [candidates.id],\n  }),\n  question: one(questions, {\n    fields: [responses.questionId],\n    references: [questions.id],\n  }),\n}));\n\nexport const proctorLogsRelations = relations(proctorLogs, ({ one }) => ({\n  candidate: one(candidates, {\n    fields: [proctorLogs.candidateId],\n    references: [candidates.id],\n  }),\n}));\n","size_bytes":7972},"server/auth.ts":{"content":"// Password-based authentication system\nimport bcrypt from \"bcrypt\";\nimport { randomBytes } from \"crypto\";\nimport type { Express, RequestHandler } from \"express\";\nimport session from \"express-session\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nconst SALT_ROUNDS = 12;\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n\n  // Login route\n  app.post(\"/api/auth/login\", async (req, res) => {\n    try {\n      const { email, password, requiredRole } = req.body;\n\n      if (!email || !password) {\n        return res.status(400).json({ message: \"Email and password required\" });\n      }\n\n      const user = await storage.getUserByEmail(email);\n      \n      if (!user || !user.passwordHash) {\n        return res.status(401).json({ message: \"Invalid credentials\" });\n      }\n\n      const isValid = await bcrypt.compare(password, user.passwordHash);\n      \n      if (!isValid) {\n        return res.status(401).json({ message: \"Invalid credentials\" });\n      }\n\n      // Validate role if requiredRole is specified\n      if (requiredRole && user.role !== requiredRole) {\n        return res.status(403).json({ message: \"Access denied. Please use the correct login page.\" });\n      }\n\n      // Set session\n      (req.session as any).userId = user.id;\n      \n      res.json({ \n        id: user.id,\n        email: user.email,\n        firstName: user.firstName,\n        lastName: user.lastName,\n        role: user.role \n      });\n    } catch (error) {\n      console.error(\"Login error:\", error);\n      res.status(500).json({ message: \"Login failed\" });\n    }\n  });\n\n  // Set password for invited candidates\n  app.post(\"/api/auth/set-password\", async (req, res) => {\n    try {\n      const { invitationToken, password, firstName, lastName } = req.body;\n\n      if (!invitationToken || !password) {\n        return res.status(400).json({ message: \"Invitation token and password required\" });\n      }\n\n      const user = await storage.getUserByInvitationToken(invitationToken);\n      \n      if (!user) {\n        return res.status(400).json({ message: \"Invalid invitation token\" });\n      }\n\n      const passwordHash = await bcrypt.hash(password, SALT_ROUNDS);\n      \n      await storage.setUserPassword(user.id, passwordHash);\n\n      // Update name if provided\n      if (firstName || lastName) {\n        await storage.updateUser(user.id, {\n          firstName: firstName || user.firstName,\n          lastName: lastName || user.lastName,\n        });\n      }\n\n      // Auto-login after setting password\n      (req.session as any).userId = user.id;\n\n      // Get updated user data\n      const updatedUser = await storage.getUser(user.id);\n\n      res.json({ \n        id: updatedUser!.id,\n        email: updatedUser!.email,\n        firstName: updatedUser!.firstName,\n        lastName: updatedUser!.lastName,\n        role: updatedUser!.role \n      });\n    } catch (error) {\n      console.error(\"Set password error:\", error);\n      res.status(500).json({ message: \"Failed to set password\" });\n    }\n  });\n\n  // Get current user\n  app.get(\"/api/auth/user\", async (req, res) => {\n    try {\n      const userId = (req.session as any)?.userId;\n      \n      if (!userId) {\n        return res.status(401).json({ message: \"Unauthorized\" });\n      }\n\n      const user = await storage.getUser(userId);\n      \n      if (!user) {\n        return res.status(401).json({ message: \"Unauthorized\" });\n      }\n\n      res.json({ \n        id: user.id,\n        email: user.email,\n        firstName: user.firstName,\n        lastName: user.lastName,\n        role: user.role \n      });\n    } catch (error) {\n      console.error(\"Get user error:\", error);\n      res.status(401).json({ message: \"Unauthorized\" });\n    }\n  });\n\n  // Logout\n  app.post(\"/api/auth/logout\", (req, res) => {\n    req.session.destroy((err) => {\n      if (err) {\n        return res.status(500).json({ message: \"Logout failed\" });\n      }\n      res.json({ message: \"Logged out successfully\" });\n    });\n  });\n}\n\n// Middleware to check if user is authenticated\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const userId = (req.session as any)?.userId;\n  \n  if (!userId) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const user = await storage.getUser(userId);\n  \n  if (!user) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  (req as any).user = user;\n  next();\n};\n\n// Middleware to check if user is admin\nexport const isAdmin: RequestHandler = async (req, res, next) => {\n  const user = (req as any).user;\n  \n  if (!user || user.role !== \"admin\") {\n    return res.status(403).json({ message: \"Forbidden - Admin access required\" });\n  }\n\n  next();\n};\n\n// Generate invitation token\nexport function generateInvitationToken(): string {\n  return randomBytes(32).toString('hex');\n}\n","size_bytes":5417},"client/src/pages/admin-login.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Shield } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nconst adminLoginSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(6, \"Password must be at least 6 characters\"),\n});\n\ntype AdminLoginForm = z.infer<typeof adminLoginSchema>;\n\nexport default function AdminLoginPage() {\n  const { toast } = useToast();\n\n  const form = useForm<AdminLoginForm>({\n    resolver: zodResolver(adminLoginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (data: AdminLoginForm) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/login\", { ...data, requiredRole: \"admin\" });\n      return response;\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Logged in successfully\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/\";\n      }, 100);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Login failed\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: AdminLoginForm) => {\n    loginMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/30\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <Shield className=\"h-6 w-6 text-primary\" />\n            <CardTitle className=\"text-2xl\">Admin Login</CardTitle>\n          </div>\n          <CardDescription>\n            Enter your admin credentials to access the dashboard\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"email\"\n                        placeholder=\"admin@example.com\"\n                        {...field}\n                        data-testid=\"input-admin-email\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"\"\n                        {...field}\n                        data-testid=\"input-admin-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={loginMutation.isPending}\n                data-testid=\"button-admin-submit\"\n              >\n                {loginMutation.isPending ? \"Signing in...\" : \"Sign In\"}\n              </Button>\n            </form>\n          </Form>\n          \n          <div className=\"text-center mt-4\">\n            <Link href=\"/admin/forgot-password\" className=\"text-sm text-muted-foreground hover:text-foreground transition-colors\" data-testid=\"link-forgot-password\">\n              Forgot your password?\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":4379},"server/email.ts":{"content":"import nodemailer from \"nodemailer\";\nimport type { Exam } from \"@shared/schema\";\n\nconst SMTP_HOST = process.env.SMTP_HOST || \"\";\nconst SMTP_PORT = parseInt(process.env.SMTP_PORT || \"587\");\nconst SMTP_USER = process.env.SMTP_USER || \"\";\nconst SMTP_PASSWORD = process.env.SMTP_PASSWORD || \"\";\nconst SMTP_FROM_EMAIL = process.env.SMTP_FROM_EMAIL || \"noreply@wokkahcbt.com\";\n\n// Create transporter only if SMTP credentials are provided\nlet transporter: nodemailer.Transporter | null = null;\n\nif (SMTP_HOST && SMTP_USER && SMTP_PASSWORD) {\n  console.log(`[SMTP] Configuring with host: ${SMTP_HOST}, port: ${SMTP_PORT}, from: ${SMTP_FROM_EMAIL}`);\n  transporter = nodemailer.createTransport({\n    host: SMTP_HOST,\n    port: SMTP_PORT,\n    secure: SMTP_PORT === 465,\n    auth: {\n      user: SMTP_USER,\n      pass: SMTP_PASSWORD,\n    },\n  });\n} else {\n  console.warn(\"[SMTP] Missing configuration:\", {\n    hasHost: !!SMTP_HOST,\n    hasUser: !!SMTP_USER,\n    hasPassword: !!SMTP_PASSWORD,\n  });\n}\n\nexport async function sendInvitationEmail(\n  email: string,\n  invitationToken: string,\n  exam?: Exam\n): Promise<boolean> {\n  if (!transporter) {\n    console.warn(\"SMTP not configured. Email would be sent to:\", email);\n    console.log(\"Invitation link:\", getInvitationLink(invitationToken));\n    return false;\n  }\n\n  const invitationLink = getInvitationLink(invitationToken);\n\n  const htmlContent = `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"utf-8\">\n        <style>\n          body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 20px;\n          }\n          .header {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 30px;\n            border-radius: 8px 8px 0 0;\n            text-align: center;\n          }\n          .content {\n            background: #f8f9fa;\n            padding: 30px;\n            border-radius: 0 0 8px 8px;\n          }\n          .button {\n            display: inline-block;\n            background: #667eea;\n            color: white;\n            padding: 12px 30px;\n            text-decoration: none;\n            border-radius: 6px;\n            margin: 20px 0;\n          }\n          .exam-info {\n            background: white;\n            padding: 15px;\n            border-left: 4px solid #667eea;\n            margin: 20px 0;\n          }\n          .footer {\n            margin-top: 30px;\n            padding-top: 20px;\n            border-top: 1px solid #dee2e6;\n            color: #6c757d;\n            font-size: 14px;\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"header\">\n          <h1>Welcome to WokkahCBT</h1>\n        </div>\n        <div class=\"content\">\n          <p>Hello,</p>\n          <p>You have been invited to take an exam on WokkahCBT${exam ? `: <strong>${exam.title}</strong>` : \"\"}.</p>\n          \n          ${exam ? `\n          <div class=\"exam-info\">\n            <h3>Exam Details</h3>\n            <p><strong>Title:</strong> ${exam.title}</p>\n            ${exam.description ? `<p><strong>Description:</strong> ${exam.description}</p>` : \"\"}\n            <p><strong>Duration:</strong> ${exam.duration} minutes</p>\n            <p><strong>Questions:</strong> ${exam.questionCount}</p>\n          </div>\n          ` : \"\"}\n          \n          <p>To get started, please click the button below to set up your password:</p>\n          \n          <a href=\"${invitationLink}\" class=\"button\">Set Up Your Password</a>\n          \n          <p>Or copy and paste this link into your browser:</p>\n          <p style=\"word-break: break-all; color: #667eea;\">${invitationLink}</p>\n          \n          <p><strong>Important:</strong> This link will expire once used. After setting up your password, you'll be able to log in and access your assigned exams.</p>\n          \n          <div class=\"footer\">\n            <p>If you didn't request this invitation, please ignore this email.</p>\n            <p> ${new Date().getFullYear()} WokkahCBT. All rights reserved.</p>\n          </div>\n        </div>\n      </body>\n    </html>\n  `;\n\n  try {\n    await transporter.sendMail({\n      from: SMTP_FROM_EMAIL,\n      to: email,\n      subject: exam ? `Invitation to ${exam.title}` : \"Welcome to WokkahCBT\",\n      html: htmlContent,\n    });\n    return true;\n  } catch (error) {\n    console.error(\"Failed to send invitation email:\", error);\n    return false;\n  }\n}\n\nfunction getInvitationLink(token: string): string {\n  const baseUrl = process.env.APP_URL || \"http://localhost:5000\";\n  return `${baseUrl}/set-password?token=${token}`;\n}\n\nexport function isEmailConfigured(): boolean {\n  return !!transporter;\n}\n\nexport async function sendPasswordResetEmail(\n  email: string,\n  firstName: string,\n  lastName: string,\n  resetToken: string\n): Promise<boolean> {\n  if (!transporter) {\n    console.warn(\"SMTP not configured. Password reset email would be sent to:\", email);\n    console.log(\"Reset link:\", getPasswordResetLink(resetToken));\n    return false;\n  }\n\n  const resetLink = getPasswordResetLink(resetToken);\n\n  const htmlContent = `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"utf-8\">\n        <style>\n          body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 20px;\n          }\n          .header {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 30px;\n            border-radius: 8px 8px 0 0;\n            text-align: center;\n          }\n          .content {\n            background: #f8f9fa;\n            padding: 30px;\n            border-radius: 0 0 8px 8px;\n          }\n          .button {\n            display: inline-block;\n            background: #667eea;\n            color: white;\n            padding: 12px 30px;\n            text-decoration: none;\n            border-radius: 6px;\n            margin: 20px 0;\n          }\n          .warning {\n            background: #fff3cd;\n            border-left: 4px solid #ffc107;\n            padding: 15px;\n            margin: 20px 0;\n          }\n          .footer {\n            margin-top: 30px;\n            padding-top: 20px;\n            border-top: 1px solid #dee2e6;\n            color: #6c757d;\n            font-size: 14px;\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"header\">\n          <h1>Password Reset Request</h1>\n        </div>\n        <div class=\"content\">\n          <p>Hello ${firstName} ${lastName},</p>\n          <p>We received a request to reset your password for your WokkahCBT administrator account.</p>\n          \n          <p>Click the button below to reset your password:</p>\n          \n          <a href=\"${resetLink}\" class=\"button\">Reset Password</a>\n          \n          <p>Or copy and paste this link into your browser:</p>\n          <p style=\"word-break: break-all; color: #667eea;\">${resetLink}</p>\n          \n          <div class=\"warning\">\n            <strong>Important:</strong> This link will expire in 1 hour for security reasons.\n          </div>\n          \n          <p>If you didn't request a password reset, please ignore this email. Your password will remain unchanged.</p>\n          \n          <div class=\"footer\">\n            <p>For security reasons, please do not share this link with anyone.</p>\n            <p> ${new Date().getFullYear()} WokkahCBT. All rights reserved.</p>\n          </div>\n        </div>\n      </body>\n    </html>\n  `;\n\n  try {\n    console.log(`[EMAIL] Attempting to send password reset email to: ${email}`);\n    const result = await transporter.sendMail({\n      from: SMTP_FROM_EMAIL,\n      to: email,\n      subject: \"Password Reset Request - WokkahCBT\",\n      html: htmlContent,\n    });\n    console.log(`[EMAIL] Password reset email sent successfully to ${email}. Message ID: ${result.messageId}`);\n    return true;\n  } catch (error: any) {\n    console.error(\"[EMAIL] Failed to send password reset email:\", {\n      to: email,\n      from: SMTP_FROM_EMAIL,\n      error: error.message,\n      code: error.code,\n      response: error.response,\n    });\n    return false;\n  }\n}\n\nfunction getPasswordResetLink(token: string): string {\n  const baseUrl = process.env.APP_URL || \"http://localhost:5000\";\n  return `${baseUrl}/admin/reset-password?token=${token}`;\n}\n\nexport interface CandidateEmailData {\n  email: string;\n  firstName: string;\n  lastName: string;\n  password: string;\n  examTitle: string;\n  examDuration: number;\n}\n\nexport async function sendCandidateCredentials(data: CandidateEmailData): Promise<boolean> {\n  if (!transporter) {\n    console.warn(\"SMTP not configured. Email would be sent to:\", data.email);\n    console.log(\"Login credentials - Email:\", data.email, \"Password:\", data.password);\n    return false;\n  }\n\n  const loginUrl = process.env.APP_URL \n    ? `${process.env.APP_URL}/login`\n    : \"http://localhost:5000/login\";\n\n  const emailHtml = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset=\"utf-8\">\n      <style>\n        body {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n          line-height: 1.6;\n          color: #333;\n          max-width: 600px;\n          margin: 0 auto;\n          padding: 20px;\n          background-color: #f5f5f5;\n        }\n        .container {\n          background-color: white;\n          border-radius: 8px;\n          overflow: hidden;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n        }\n        .header {\n          background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);\n          color: white;\n          padding: 30px;\n          text-align: center;\n        }\n        .header h1 {\n          margin: 0;\n          font-size: 24px;\n        }\n        .content {\n          padding: 30px;\n        }\n        .credentials-box {\n          background-color: #f0f9ff;\n          border: 2px solid #2563eb;\n          border-radius: 8px;\n          padding: 20px;\n          margin: 20px 0;\n        }\n        .credentials-box h3 {\n          margin-top: 0;\n          color: #2563eb;\n        }\n        .credential-item {\n          margin: 12px 0;\n        }\n        .credential-label {\n          font-weight: 600;\n          color: #4b5563;\n        }\n        .credential-value {\n          font-family: 'Courier New', monospace;\n          background-color: white;\n          padding: 8px 12px;\n          border-radius: 4px;\n          display: inline-block;\n          margin-left: 8px;\n          font-size: 16px;\n          border: 1px solid #e5e7eb;\n        }\n        .rules-box {\n          background-color: #fef2f2;\n          border-left: 4px solid #dc2626;\n          padding: 20px;\n          margin: 25px 0;\n        }\n        .rules-box h3 {\n          color: #dc2626;\n          margin-top: 0;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n        .rules-box ol {\n          margin: 15px 0;\n          padding-left: 20px;\n        }\n        .rules-box li {\n          margin: 10px 0;\n          color: #374151;\n        }\n        .warning {\n          background-color: #fef3c7;\n          border: 2px solid #f59e0b;\n          padding: 15px;\n          border-radius: 6px;\n          margin: 20px 0;\n          font-weight: 500;\n          color: #92400e;\n        }\n        .login-button {\n          display: inline-block;\n          background-color: #2563eb;\n          color: white;\n          padding: 14px 32px;\n          text-decoration: none;\n          border-radius: 6px;\n          margin: 20px 0;\n          font-weight: 600;\n          text-align: center;\n        }\n        .footer {\n          text-align: center;\n          padding: 20px;\n          background-color: #f9fafb;\n          color: #6b7280;\n          font-size: 14px;\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        <div class=\"header\">\n          <h1>WokkahCBT - Exam Invitation</h1>\n        </div>\n        \n        <div class=\"content\">\n          <p>Dear <strong>${data.firstName} ${data.lastName}</strong>,</p>\n          \n          <p>You have been assigned to take the following exam:</p>\n          \n          <div class=\"credentials-box\">\n            <h3>Exam Details</h3>\n            <div class=\"credential-item\">\n              <span class=\"credential-label\">Exam Title:</span>\n              <span class=\"credential-value\">${data.examTitle}</span>\n            </div>\n            <div class=\"credential-item\">\n              <span class=\"credential-label\">Duration:</span>\n              <span class=\"credential-value\">${data.examDuration} minutes</span>\n            </div>\n            \n            <h3 style=\"margin-top: 25px;\">Your Login Credentials</h3>\n            <div class=\"credential-item\">\n              <span class=\"credential-label\">Email:</span>\n              <span class=\"credential-value\">${data.email}</span>\n            </div>\n            <div class=\"credential-item\">\n              <span class=\"credential-label\">Password:</span>\n              <span class=\"credential-value\">${data.password}</span>\n            </div>\n          </div>\n\n          <div class=\"rules-box\">\n            <h3>Assessment Instructions - PLEASE READ CAREFULLY</h3>\n            <ol>\n              <li>You must stay in the assessment browser window at all times</li>\n              <li>Your webcam must stay on and your face visible throughout</li>\n              <li>No other people should be visible in the webcam frame</li>\n              <li>Do not switch tabs or minimize the browser window</li>\n              <li>Maintain a quiet environment during the assessment</li>\n              <li>Do not use any external resources or assistance</li>\n            </ol>\n          </div>\n\n          <div class=\"warning\">\n            <strong>WARNING:</strong> If any of this is detected by the system it will log participant out and wont be able to continue the assessment.\n          </div>\n\n          <p style=\"text-align: center;\">\n            <a href=\"${loginUrl}\" class=\"login-button\">Login to Take Exam</a>\n          </p>\n\n          <p style=\"color: #6b7280; font-size: 14px;\">\n            Please keep your login credentials secure and do not share them with anyone.\n          </p>\n          \n          <p style=\"margin-top: 30px;\">\n            Good luck with your exam!\n          </p>\n          \n          <p>\n            Best regards,<br>\n            <strong>WokkahCBT Team</strong>\n          </p>\n        </div>\n\n        <div class=\"footer\">\n          <p>This is an automated email. Please do not reply to this message.</p>\n          <p> ${new Date().getFullYear()} WokkahCBT. All rights reserved.</p>\n        </div>\n      </div>\n    </body>\n    </html>\n  `;\n\n  const emailText = `\nWokkahCBT - Exam Invitation\n\nDear ${data.firstName} ${data.lastName},\n\nYou have been assigned to take the following exam:\n\nEXAM DETAILS\n\nExam Title: ${data.examTitle}\nDuration: ${data.examDuration} minutes\n\nYOUR LOGIN CREDENTIALS\n\nEmail: ${data.email}\nPassword: ${data.password}\n\nLogin URL: ${loginUrl}\n\nASSESSMENT INSTRUCTIONS - PLEASE READ CAREFULLY\n\n\n1. You must stay in the assessment browser window at all times\n2. Your webcam must stay on and your face visible throughout\n3. No other people should be visible in the webcam frame\n4. Do not switch tabs or minimize the browser window\n5. Maintain a quiet environment during the assessment\n6. Do not use any external resources or assistance\n\nWARNING: If any of this is detected by the system it will log participant out and wont be able to continue the assessment.\n\nPlease keep your login credentials secure and do not share them with anyone.\n\nGood luck with your exam!\n\nBest regards,\nWokkahCBT Team\n\n\nThis is an automated email. Please do not reply to this message.\n ${new Date().getFullYear()} WokkahCBT. All rights reserved.\n  `;\n\n  try {\n    await transporter.sendMail({\n      from: SMTP_FROM_EMAIL,\n      to: data.email,\n      subject: `Exam Invitation: ${data.examTitle}`,\n      text: emailText,\n      html: emailHtml,\n    });\n    console.log(`Credentials email sent to ${data.email} for exam: ${data.examTitle}`);\n    return true;\n  } catch (error) {\n    console.error(\"Failed to send credentials email:\", error);\n    return false;\n  }\n}\n","size_bytes":16985},"client/src/pages/set-password.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useLocation, useSearch } from \"wouter\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst setPasswordSchema = z.object({\n  password: z.string().min(6, \"Password must be at least 6 characters\"),\n  confirmPassword: z.string(),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype SetPasswordForm = z.infer<typeof setPasswordSchema>;\n\nexport default function SetPasswordPage() {\n  const [, setLocation] = useLocation();\n  const searchParams = new URLSearchParams(useSearch());\n  const token = searchParams.get(\"token\");\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [firstName, setFirstName] = useState(\"\");\n  const [lastName, setLastName] = useState(\"\");\n\n  const form = useForm<SetPasswordForm>({\n    resolver: zodResolver(setPasswordSchema),\n    defaultValues: {\n      password: \"\",\n      confirmPassword: \"\",\n    },\n  });\n\n  useEffect(() => {\n    if (!token) {\n      toast({\n        title: \"Invalid Link\",\n        description: \"This password setup link is invalid or has expired\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/\");\n    }\n  }, [token, toast, setLocation]);\n\n  const setPasswordMutation = useMutation({\n    mutationFn: async (data: { password: string; firstName?: string; lastName?: string }) => {\n      return await apiRequest(\"POST\", \"/api/auth/set-password\", {\n        invitationToken: token,\n        password: data.password,\n        firstName: data.firstName,\n        lastName: data.lastName,\n      });\n    },\n    onSuccess: (user) => {\n      queryClient.setQueryData([\"/api/auth/user\"], user);\n      toast({\n        title: \"Success\",\n        description: \"Your password has been set successfully\",\n      });\n      setLocation(\"/\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to set password\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: SetPasswordForm) => {\n    setPasswordMutation.mutate({\n      password: data.password,\n      firstName: firstName.trim() || undefined,\n      lastName: lastName.trim() || undefined,\n    });\n  };\n\n  if (!token) {\n    return null;\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/30\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader>\n          <CardTitle>Welcome to WokkahCBT</CardTitle>\n          <CardDescription>\n            Set up your password to access your assigned exams\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <label htmlFor=\"firstName\" className=\"text-sm font-medium\">\n                    First Name (Optional)\n                  </label>\n                  <Input\n                    id=\"firstName\"\n                    type=\"text\"\n                    placeholder=\"John\"\n                    value={firstName}\n                    onChange={(e) => setFirstName(e.target.value)}\n                    data-testid=\"input-firstname\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <label htmlFor=\"lastName\" className=\"text-sm font-medium\">\n                    Last Name (Optional)\n                  </label>\n                  <Input\n                    id=\"lastName\"\n                    type=\"text\"\n                    placeholder=\"Doe\"\n                    value={lastName}\n                    onChange={(e) => setLastName(e.target.value)}\n                    data-testid=\"input-lastname\"\n                  />\n                </div>\n              </div>\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"\"\n                        {...field}\n                        data-testid=\"input-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"confirmPassword\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Confirm Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"\"\n                        {...field}\n                        data-testid=\"input-confirm-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={setPasswordMutation.isPending}\n                data-testid=\"button-submit\"\n              >\n                {setPasswordMutation.isPending ? \"Setting up...\" : \"Set Password & Continue\"}\n              </Button>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":6129},"client/src/pages/candidate-login.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { FileText } from \"lucide-react\";\n\nconst candidateLoginSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(6, \"Password must be at least 6 characters\"),\n});\n\ntype CandidateLoginForm = z.infer<typeof candidateLoginSchema>;\n\nexport default function CandidateLoginPage() {\n  const { toast } = useToast();\n\n  const form = useForm<CandidateLoginForm>({\n    resolver: zodResolver(candidateLoginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (data: CandidateLoginForm) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/login\", { ...data, requiredRole: \"candidate\" });\n      return response;\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Logged in successfully\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/\";\n      }, 100);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Login failed\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: CandidateLoginForm) => {\n    loginMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/30\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <FileText className=\"h-6 w-6 text-primary\" />\n            <CardTitle className=\"text-2xl\">Candidate Login</CardTitle>\n          </div>\n          <CardDescription>\n            Enter your credentials to access your assigned exams\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"email\"\n                        placeholder=\"candidate@example.com\"\n                        {...field}\n                        data-testid=\"input-candidate-email\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"\"\n                        {...field}\n                        data-testid=\"input-candidate-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={loginMutation.isPending}\n                data-testid=\"button-candidate-submit\"\n              >\n                {loginMutation.isPending ? \"Signing in...\" : \"Sign In\"}\n              </Button>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":4113},"client/src/pages/admin/analytics.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { \n  BarChart, \n  Bar, \n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  Legend, \n  ResponsiveContainer,\n  LineChart,\n  Line,\n  PieChart,\n  Pie,\n  Cell\n} from \"recharts\";\nimport { TrendingUp, Users, FileText, AlertTriangle, Clock, CheckCircle, FileDown } from \"lucide-react\";\nimport { exportAnalyticsCSV, exportAnalyticsPDF } from \"@/lib/exportReports\";\n\nexport default function AnalyticsPage() {\n  const { data: analytics, isLoading } = useQuery({\n    queryKey: [\"/api/analytics\"],\n  });\n\n  const COLORS = ['hsl(var(--chart-1))', 'hsl(var(--chart-2))', 'hsl(var(--chart-3))', 'hsl(var(--chart-4))', 'hsl(var(--chart-5))'];\n\n  if (isLoading) {\n    return (\n      <div className=\"p-6 space-y-6\">\n        <Skeleton className=\"h-32\" />\n        <div className=\"grid gap-6 md:grid-cols-2\">\n          <Skeleton className=\"h-80\" />\n          <Skeleton className=\"h-80\" />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-semibold mb-2\" data-testid=\"text-page-title\">Analytics Dashboard</h1>\n          <p className=\"text-muted-foreground\" data-testid=\"text-page-description\">\n            Comprehensive exam performance and proctoring analytics\n          </p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button onClick={() => analytics && exportAnalyticsCSV(analytics)} variant=\"outline\" data-testid=\"button-export-analytics-csv\">\n            <FileDown className=\"h-4 w-4 mr-2\" />\n            Export CSV\n          </Button>\n          <Button onClick={() => analytics && exportAnalyticsPDF(analytics)} variant=\"outline\" data-testid=\"button-export-analytics-pdf\">\n            <FileDown className=\"h-4 w-4 mr-2\" />\n            Export PDF\n          </Button>\n        </div>\n      </div>\n\n      {/* Key Metrics */}\n      <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-4\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Exams</CardTitle>\n            <FileText className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{analytics?.totalExams || 0}</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {analytics?.activeExams || 0} active\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Candidates</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{analytics?.totalCandidates || 0}</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {analytics?.completedCandidates || 0} completed\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Average Score</CardTitle>\n            <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{analytics?.averageScore?.toFixed(1) || 0}%</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Across all completed exams\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Violations</CardTitle>\n            <AlertTriangle className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{analytics?.totalViolations || 0}</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {analytics?.highSeverityViolations || 0} high severity\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Charts */}\n      <div className=\"grid gap-6 lg:grid-cols-2\">\n        {/* Exam Status Distribution */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Exam Status Distribution</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <PieChart>\n                <Pie\n                  data={analytics?.statusDistribution || []}\n                  cx=\"50%\"\n                  cy=\"50%\"\n                  labelLine={false}\n                  label={({ name, value }) => `${name}: ${value}`}\n                  outerRadius={80}\n                  fill=\"#8884d8\"\n                  dataKey=\"value\"\n                >\n                  {(analytics?.statusDistribution || []).map((entry: any, index: number) => (\n                    <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                  ))}\n                </Pie>\n                <Tooltip />\n              </PieChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n\n        {/* Score Distribution */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Score Distribution</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <BarChart data={analytics?.scoreDistribution || []}>\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis dataKey=\"range\" />\n                <YAxis />\n                <Tooltip />\n                <Legend />\n                <Bar dataKey=\"count\" fill=\"hsl(var(--chart-1))\" />\n              </BarChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n\n        {/* Exam Completions Over Time */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Exam Completions Over Time</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <LineChart data={analytics?.completionsOverTime || []}>\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis dataKey=\"date\" />\n                <YAxis />\n                <Tooltip />\n                <Legend />\n                <Line type=\"monotone\" dataKey=\"completions\" stroke=\"hsl(var(--chart-2))\" strokeWidth={2} />\n              </LineChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n\n        {/* Violation Types */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Violation Types</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <BarChart data={analytics?.violationTypes || []} layout=\"horizontal\">\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis type=\"number\" />\n                <YAxis dataKey=\"type\" type=\"category\" width={120} />\n                <Tooltip />\n                <Legend />\n                <Bar dataKey=\"count\" fill=\"hsl(var(--destructive))\" />\n              </BarChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Exam Performance Table */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Exam Performance Summary</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead>\n                <tr className=\"border-b\">\n                  <th className=\"text-left py-3 px-4\">Exam Title</th>\n                  <th className=\"text-left py-3 px-4\">Candidates</th>\n                  <th className=\"text-left py-3 px-4\">Completed</th>\n                  <th className=\"text-left py-3 px-4\">Avg Score</th>\n                  <th className=\"text-left py-3 px-4\">Pass Rate</th>\n                  <th className=\"text-left py-3 px-4\">Violations</th>\n                </tr>\n              </thead>\n              <tbody>\n                {(analytics?.examPerformance || []).map((exam: any) => (\n                  <tr key={exam.examId} className=\"border-b\">\n                    <td className=\"py-3 px-4\">{exam.title}</td>\n                    <td className=\"py-3 px-4\">{exam.totalCandidates}</td>\n                    <td className=\"py-3 px-4\">{exam.completed}</td>\n                    <td className=\"py-3 px-4\">{exam.avgScore?.toFixed(1)}%</td>\n                    <td className=\"py-3 px-4\">\n                      <span className={exam.passRate >= 70 ? \"text-chart-2\" : \"text-destructive\"}>\n                        {exam.passRate?.toFixed(1)}%\n                      </span>\n                    </td>\n                    <td className=\"py-3 px-4\">{exam.violations}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":9351},"client/src/lib/exportReports.ts":{"content":"import jsPDF from 'jspdf';\nimport autoTable from 'jspdf-autotable';\nimport Papa from 'papaparse';\n\nexport const exportExamResultsCSV = (candidates: any[]) => {\n  const data = candidates.map(c => ({\n    'Candidate Name': c.user?.firstName && c.user?.lastName \n      ? `${c.user.firstName} ${c.user.lastName}`\n      : c.user?.email || 'Unknown',\n    'Email': c.user?.email || 'N/A',\n    'Exam': c.exam?.title || 'N/A',\n    'Status': c.status,\n    'Score': c.score !== null ? `${c.score}%` : 'N/A',\n    'Started At': c.startedAt ? new Date(c.startedAt).toLocaleString() : 'N/A',\n    'Completed At': c.completedAt ? new Date(c.completedAt).toLocaleString() : 'N/A',\n  }));\n\n  const csv = Papa.unparse(data);\n  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n  const url = URL.createObjectURL(blob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = `exam_results_${new Date().toISOString().split('T')[0]}.csv`;\n  link.click();\n  URL.revokeObjectURL(url);\n};\n\nexport const exportProctorLogsCSV = (logs: any[]) => {\n  const data = logs.map(log => ({\n    'Candidate': log.candidate?.user?.email || 'Unknown',\n    'Exam': log.candidate?.exam?.title || 'Unknown',\n    'Event Type': log.eventType,\n    'Severity': log.severity,\n    'Timestamp': new Date(log.timestamp).toLocaleString(),\n    'Metadata': log.metadata ? JSON.stringify(log.metadata) : '',\n  }));\n\n  const csv = Papa.unparse(data);\n  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n  const url = URL.createObjectURL(blob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = `proctor_logs_${new Date().toISOString().split('T')[0]}.csv`;\n  link.click();\n  URL.revokeObjectURL(url);\n};\n\nexport const exportExamResultsPDF = (candidates: any[]) => {\n  const doc = new jsPDF();\n  \n  // Add title\n  doc.setFontSize(16);\n  doc.text('Exam Results Report', 14, 15);\n  \n  // Add date\n  doc.setFontSize(10);\n  doc.text(`Generated: ${new Date().toLocaleString()}`, 14, 22);\n  \n  // Prepare table data\n  const tableData = candidates.map(c => [\n    c.user?.firstName && c.user?.lastName \n      ? `${c.user.firstName} ${c.user.lastName}`\n      : c.user?.email || 'Unknown',\n    c.exam?.title || 'N/A',\n    c.status,\n    c.score !== null ? `${c.score}%` : 'N/A',\n    c.completedAt ? new Date(c.completedAt).toLocaleDateString() : 'N/A',\n  ]);\n  \n  // Add table\n  autoTable(doc, {\n    head: [['Candidate', 'Exam', 'Status', 'Score', 'Completed']],\n    body: tableData,\n    startY: 30,\n    theme: 'grid',\n    headStyles: { fillColor: [41, 128, 185] },\n  });\n  \n  doc.save(`exam_results_${new Date().toISOString().split('T')[0]}.pdf`);\n};\n\nexport const exportProctorLogsPDF = (logs: any[]) => {\n  const doc = new jsPDF();\n  \n  // Add title\n  doc.setFontSize(16);\n  doc.text('Proctoring Logs Report', 14, 15);\n  \n  // Add date\n  doc.setFontSize(10);\n  doc.text(`Generated: ${new Date().toLocaleString()}`, 14, 22);\n  \n  // Prepare table data\n  const tableData = logs.map(log => [\n    log.candidate?.user?.email || 'Unknown',\n    log.eventType,\n    log.severity,\n    new Date(log.timestamp).toLocaleString(),\n  ]);\n  \n  // Add table\n  autoTable(doc, {\n    head: [['Candidate', 'Event Type', 'Severity', 'Timestamp']],\n    body: tableData,\n    startY: 30,\n    theme: 'grid',\n    headStyles: { fillColor: [192, 57, 43] },\n  });\n  \n  doc.save(`proctor_logs_${new Date().toISOString().split('T')[0]}.pdf`);\n};\n\nexport const exportAnalyticsCSV = (analytics: any) => {\n  const data = [\n    { metric: 'Total Exams', value: analytics.totalExams },\n    { metric: 'Active Exams', value: analytics.activeExams },\n    { metric: 'Total Candidates', value: analytics.totalCandidates },\n    { metric: 'Completed Candidates', value: analytics.completedCandidates },\n    { metric: 'Average Score', value: `${analytics.averageScore?.toFixed(1)}%` },\n    { metric: 'Total Violations', value: analytics.totalViolations },\n    { metric: 'High Severity Violations', value: analytics.highSeverityViolations },\n  ];\n\n  const csv = Papa.unparse(data);\n  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n  const url = URL.createObjectURL(blob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = `analytics_${new Date().toISOString().split('T')[0]}.csv`;\n  link.click();\n  URL.revokeObjectURL(url);\n};\n\nexport const exportAnalyticsPDF = (analytics: any) => {\n  const doc = new jsPDF();\n  \n  // Add title\n  doc.setFontSize(18);\n  doc.text('Analytics Report', 14, 15);\n  \n  // Add date\n  doc.setFontSize(10);\n  doc.text(`Generated: ${new Date().toLocaleString()}`, 14, 25);\n  \n  // Summary statistics\n  doc.setFontSize(14);\n  doc.text('Summary Statistics', 14, 40);\n  \n  doc.setFontSize(10);\n  doc.text(`Total Exams: ${analytics.totalExams}`, 20, 50);\n  doc.text(`Active Exams: ${analytics.activeExams}`, 20, 57);\n  doc.text(`Total Candidates: ${analytics.totalCandidates}`, 20, 64);\n  doc.text(`Completed Candidates: ${analytics.completedCandidates}`, 20, 71);\n  doc.text(`Average Score: ${analytics.averageScore?.toFixed(1)}%`, 20, 78);\n  doc.text(`Total Violations: ${analytics.totalViolations}`, 20, 85);\n  doc.text(`High Severity Violations: ${analytics.highSeverityViolations}`, 20, 92);\n  \n  // Exam Performance Table\n  if (analytics.examPerformance && analytics.examPerformance.length > 0) {\n    doc.setFontSize(14);\n    doc.text('Exam Performance', 14, 110);\n    \n    const tableData = analytics.examPerformance.map((exam: any) => [\n      exam.title,\n      exam.totalCandidates.toString(),\n      exam.completed.toString(),\n      exam.avgScore?.toFixed(1) + '%',\n      exam.passRate?.toFixed(1) + '%',\n      exam.violations.toString(),\n    ]);\n    \n    autoTable(doc, {\n      head: [['Exam', 'Candidates', 'Completed', 'Avg Score', 'Pass Rate', 'Violations']],\n      body: tableData,\n      startY: 115,\n      theme: 'grid',\n      headStyles: { fillColor: [41, 128, 185] },\n    });\n  }\n  \n  doc.save(`analytics_report_${new Date().toISOString().split('T')[0]}.pdf`);\n};\n","size_bytes":6027},"server/ai.ts":{"content":"// Reference: blueprint:javascript_openai\n// the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\n\nimport OpenAI from \"openai\";\nimport type { InsertQuestion } from \"@shared/schema\";\n\nfunction getOpenAIClient() {\n  if (!process.env.OPENAI_API_KEY) {\n    throw new Error(\"OPENAI_API_KEY is not configured\");\n  }\n  return new OpenAI({ apiKey: process.env.OPENAI_API_KEY });\n}\n\ninterface GenerateQuestionsParams {\n  domainId: number;\n  examTitle: string;\n  examDescription: string;\n  domainName: string;\n  questionCount: number;\n  documentContent?: string; // Optional document content for context\n}\n\ninterface AIQuestion {\n  type: \"multiple_choice\" | \"true_false\";\n  content: string;\n  options: string[];\n  correctAnswer: string;\n}\n\nexport async function generateQuestionsWithAI(\n  params: GenerateQuestionsParams\n): Promise<InsertQuestion[]> {\n  const { domainId, examTitle, examDescription, domainName, questionCount, documentContent } = params;\n\n  let contextInfo = `Exam Title: ${examTitle}\nDomain: ${domainName}\nDescription: ${examDescription}`;\n\n  // Add document content if provided\n  if (documentContent) {\n    contextInfo += `\n\nDocument Content:\n${documentContent}\n\nGenerate questions strictly based on the content provided in the document above.`;\n  }\n\n  const prompt = `You are an expert exam question generator. Generate ${questionCount} exam questions based on the following information:\n\n${contextInfo}\n\nRequirements:\n1. Generate a mix of multiple choice and true/false questions\n2. For multiple choice questions, provide 3-4 options with one correct answer\n3. Questions should be relevant to the domain and exam topic\n4. Ensure questions are clear, concise, and academically sound\n5. Vary difficulty levels appropriately\n\nRespond with a JSON object in this exact format:\n{\n  \"questions\": [\n    {\n      \"type\": \"multiple_choice\",\n      \"content\": \"question text here\",\n      \"options\": [\"option1\", \"option2\", \"option3\", \"option4\"],\n      \"correctAnswer\": \"the correct option text\"\n    },\n    {\n      \"type\": \"true_false\",\n      \"content\": \"question text here\",\n      \"options\": [\"True\", \"False\"],\n      \"correctAnswer\": \"True\" or \"False\"\n    }\n  ]\n}`;\n\n  try {\n    const openai = getOpenAIClient();\n    \n    const response = await openai.chat.completions.create({\n      model: \"gpt-5\",\n      messages: [\n        {\n          role: \"system\",\n          content: \"You are an expert educational assessment creator. Generate high-quality exam questions in JSON format.\",\n        },\n        {\n          role: \"user\",\n          content: prompt,\n        },\n      ],\n      response_format: { type: \"json_object\" },\n      max_completion_tokens: 8192,\n    });\n\n    const result = JSON.parse(response.choices[0].message.content || \"{}\");\n    \n    if (!result.questions || !Array.isArray(result.questions)) {\n      throw new Error(\"Invalid response format from AI\");\n    }\n\n    // Convert AI questions to database format\n    // Note: options must be JSON string for database schema\n    const questions: InsertQuestion[] = result.questions.map((q: AIQuestion) => ({\n      domainId,\n      type: q.type,\n      content: q.content,\n      options: JSON.stringify(q.options),\n      correctAnswer: q.correctAnswer,\n    }));\n\n    return questions;\n  } catch (error) {\n    console.error(\"AI question generation error:\", error);\n    throw new Error(`Failed to generate questions with AI: ${error instanceof Error ? error.message : 'Unknown error'}`);\n  }\n}\n","size_bytes":3519},"client/src/pages/admin/exam-manage.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useRoute, useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { ArrowLeft, Plus, Save, Upload, Download, X, Sparkles, Pencil, Trash2, FileText, Camera, Eye, AlertTriangle } from \"lucide-react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport type { Exam, Domain, ProctorLog, Candidate, User } from \"@shared/schema\";\nimport Papa from \"papaparse\";\nimport * as XLSX from \"xlsx\";\nimport jsPDF from \"jspdf\";\nimport \"jspdf-autotable\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\n\ntype QuestionInput = {\n  type: \"multiple_choice\" | \"true_false\";\n  content: string;\n  options: string[];\n  correctAnswer: string;\n};\n\ninterface ProctorLogWithDetails extends ProctorLog {\n  candidate?: Candidate & { user?: User };\n}\n\nexport default function ExamManagePage() {\n  const [, params] = useRoute(\"/exams/:id/manage\");\n  const [, setLocation] = useLocation();\n  const examId = params?.id ? parseInt(params.id) : null;\n  const { toast } = useToast();\n  const [newQuestions, setNewQuestions] = useState<QuestionInput[]>([]);\n  const [useAI, setUseAI] = useState(false);\n  const [aiQuestionCount, setAiQuestionCount] = useState(5);\n  const [documentContent, setDocumentContent] = useState<string>(\"\");\n  const [isUploadingDoc, setIsUploadingDoc] = useState(false);\n  const [uploadedDocName, setUploadedDocName] = useState<string>(\"\");\n  const [importResults, setImportResults] = useState<any>(null);\n  const [importedCandidates, setImportedCandidates] = useState<any[]>([]);\n  const [editingQuestion, setEditingQuestion] = useState<any>(null);\n  const [deletingQuestionId, setDeletingQuestionId] = useState<number | null>(null);\n  const [manualCandidateForm, setManualCandidateForm] = useState({\n    firstName: \"\",\n    lastName: \"\",\n    email: \"\",\n    department: \"\",\n    matricNo: \"\",\n  });\n  const [candidateToDelete, setCandidateToDelete] = useState<number | null>(null);\n  const [videoFeeds, setVideoFeeds] = useState<Map<number, string>>(new Map());\n  const wsRef = useRef<WebSocket | null>(null);\n  \n  // Form state for settings\n  const [formData, setFormData] = useState({\n    title: \"\",\n    description: \"\",\n    domainId: 0,\n    duration: 0,\n    questionCount: 0,\n    showResults: \"delayed\" as \"immediate\" | \"delayed\" | \"hidden\",\n    status: \"draft\" as \"draft\" | \"active\" | \"inactive\",\n    enableWebcam: true,\n    enableTabDetection: true,\n  });\n\n  const { data: exam, isLoading: examLoading } = useQuery<Exam>({\n    queryKey: [\"/api/exams\", examId],\n    enabled: !!examId,\n  });\n\n  const { data: domains } = useQuery<Domain[]>({\n    queryKey: [\"/api/domains\"],\n  });\n\n  const { data: examQuestions, refetch: refetchQuestions } = useQuery<any[]>({\n    queryKey: [\"/api/exams\", examId, \"questions\"],\n    enabled: !!examId,\n  });\n\n  const { data: examCandidates, refetch: refetchCandidates } = useQuery<any[]>({\n    queryKey: [\"/api/exams\", examId, \"candidates\"],\n    enabled: !!examId,\n  });\n\n  const { data: activeSessions, isLoading: sessionsLoading } = useQuery({\n    queryKey: [\"/api/monitoring/active\", examId],\n    queryFn: () => fetch(`/api/monitoring/active?examId=${examId}`).then(res => res.json()),\n    enabled: !!examId,\n    refetchInterval: 5000, // Refresh every 5 seconds\n  });\n\n  const { data: logs, isLoading: logsLoading } = useQuery<ProctorLogWithDetails[]>({\n    queryKey: [\"/api/monitoring/logs\", examId],\n    queryFn: () => fetch(`/api/monitoring/logs?examId=${examId}`).then(res => res.json()),\n    enabled: !!examId,\n    refetchInterval: 5000, // Refresh every 5 seconds\n  });\n\n  // Helper functions for monitoring\n  const getSeverityColor = (severity: string) => {\n    switch (severity) {\n      case \"high\":\n        return \"bg-destructive/10 text-destructive\";\n      case \"medium\":\n        return \"bg-chart-4/10 text-chart-4\";\n      default:\n        return \"bg-chart-2/10 text-chart-2\";\n    }\n  };\n\n  const getEventIcon = (eventType: string) => {\n    switch (eventType) {\n      case \"face_absent\":\n      case \"multiple_faces\":\n        return Camera;\n      case \"tab_switch\":\n        return Eye;\n      default:\n        return AlertTriangle;\n    }\n  };\n\n  // Generate cryptographically secure password for candidates\n  const generatePassword = () => {\n    const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789';\n    const array = new Uint8Array(8);\n    crypto.getRandomValues(array);\n    let password = '';\n    for (let i = 0; i < 8; i++) {\n      password += chars.charAt(array[i] % chars.length);\n    }\n    return password;\n  };\n\n  // Initialize form data when exam loads\n  useEffect(() => {\n    if (exam) {\n      setFormData({\n        title: exam.title,\n        description: exam.description || \"\",\n        domainId: exam.domainId,\n        duration: exam.duration,\n        questionCount: exam.questionCount,\n        showResults: exam.showResults as \"immediate\" | \"delayed\" | \"hidden\",\n        status: exam.status as \"draft\" | \"active\" | \"inactive\",\n        enableWebcam: exam.enableWebcam ?? true,\n        enableTabDetection: exam.enableTabDetection ?? true,\n      });\n    }\n  }, [exam]);\n\n  // WebSocket connection for receiving video feeds\n  useEffect(() => {\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n    const wsUrl = `${protocol}//${window.location.host}/ws`;\n    \n    const ws = new WebSocket(wsUrl);\n    wsRef.current = ws;\n\n    ws.onopen = () => {\n      console.log('Admin WebSocket connected for video monitoring (per-exam)');\n      ws.send(JSON.stringify({\n        type: 'register',\n        clientType: 'admin'\n      }));\n    };\n\n    ws.onmessage = (event) => {\n      try {\n        const data = JSON.parse(event.data);\n        \n        if (data.type === 'video_frame' && data.candidateId && data.frame) {\n          setVideoFeeds(prev => {\n            const updated = new Map(prev);\n            updated.set(data.candidateId, data.frame);\n            return updated;\n          });\n        }\n      } catch (error) {\n        console.error('WebSocket message error:', error);\n      }\n    };\n\n    ws.onerror = (error) => {\n      console.error('Admin WebSocket error:', error);\n    };\n\n    ws.onclose = () => {\n      console.log('Admin WebSocket disconnected');\n    };\n\n    return () => {\n      if (ws.readyState === WebSocket.OPEN) {\n        ws.close();\n      }\n    };\n  }, []);\n\n  const updateExamMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"PATCH\", `/api/exams/${examId}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\", examId] });\n      toast({\n        title: \"Success\",\n        description: \"Exam updated successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const addQuestionsMutation = useMutation({\n    mutationFn: async ({ examId, questions }: { examId: number; questions: any[] }) => {\n      return await apiRequest(\"POST\", `/api/exams/${examId}/questions`, { questions });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\", examId, \"questions\"] });\n      setNewQuestions([]);\n      refetchQuestions();\n      toast({\n        title: \"Success\",\n        description: \"Questions added successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const generateAIQuestionsMutation = useMutation({\n    mutationFn: async () => {\n      if (!exam) throw new Error(\"Exam not found\");\n      \n      const response = await apiRequest(\"POST\", \"/api/ai/generate-questions\", {\n        examTitle: exam.title,\n        domainId: exam.domainId,\n        description: exam.description || \"\",\n        count: aiQuestionCount,\n        documentContent: documentContent || undefined,\n      });\n      \n      if (!response?.questions || !Array.isArray(response.questions)) {\n        throw new Error(\"Invalid response from AI service\");\n      }\n      \n      // Convert AI response to proper format\n      // AI service returns options as JSON string, but backend expects array\n      const generatedQuestions = response.questions.map((q: any) => ({\n        domainId: exam!.domainId,\n        type: q.type,\n        content: q.content,\n        options: typeof q.options === 'string' ? JSON.parse(q.options) : q.options,\n        correctAnswer: q.correctAnswer,\n      }));\n      \n      await apiRequest(\"POST\", `/api/exams/${examId}/questions`, { questions: generatedQuestions });\n      \n      return response;\n    },\n    onSuccess: (data: any) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\", examId, \"questions\"] });\n      refetchQuestions();\n      setUseAI(false);\n      setAiQuestionCount(5);\n      toast({\n        title: \"Success\",\n        description: `${data?.questions?.length || 0} questions generated and added successfully`,\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to generate AI questions\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateQuestionMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: number; data: any }) => {\n      return await apiRequest(\"PUT\", `/api/questions/${id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\", examId, \"questions\"] });\n      refetchQuestions();\n      setEditingQuestion(null);\n      toast({\n        title: \"Success\",\n        description: \"Question updated successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteQuestionMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return await apiRequest(\"DELETE\", `/api/questions/${id}`, undefined);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\", examId, \"questions\"] });\n      refetchQuestions();\n      setDeletingQuestionId(null);\n      toast({\n        title: \"Success\",\n        description: \"Question deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const resetPasswordMutation = useMutation({\n    mutationFn: async ({ userId, candidateId }: { userId: string; candidateId: number }) => {\n      const password = generatePassword();\n      const response = await apiRequest(\"POST\", \"/api/users/reset-password\", {\n        userId,\n        password,\n      });\n      return { ...response, password, candidateId };\n    },\n    onSuccess: (data) => {\n      toast({\n        title: \"Password Reset Successfully\",\n        description: `New Password: ${data.password}`,\n        duration: 15000,\n      });\n      \n      // Add to imported candidates list for download\n      const candidate = examCandidates?.find(c => c.id === data.candidateId);\n      if (candidate) {\n        const resetCandidate = {\n          fullName: `${candidate.user?.firstName} ${candidate.user?.lastName}`,\n          email: candidate.user?.email,\n          department: candidate.user?.department,\n          matricNo: candidate.user?.matricNo,\n          password: data.password,\n        };\n        setImportedCandidates(prev => [...prev, resetCandidate]);\n      }\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const allowRetakeMutation = useMutation({\n    mutationFn: async (candidateId: number) => {\n      return await apiRequest(\"POST\", `/api/candidates/${candidateId}/allow-retake`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\", examId, \"candidates\"] });\n      refetchCandidates();\n      toast({\n        title: \"Retake Allowed\",\n        description: \"Candidate can now retake the exam\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteCandidateMutation = useMutation({\n    mutationFn: async (candidateId: number) => {\n      return await apiRequest(\"DELETE\", `/api/candidates/${candidateId}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\", examId, \"candidates\"] });\n      refetchCandidates();\n      setCandidateToDelete(null);\n      toast({\n        title: \"Success\",\n        description: \"Candidate deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const addManualCandidateMutation = useMutation({\n    mutationFn: async (candidateData: any) => {\n      // Check if user already exists\n      const checkResponse = await apiRequest(\"GET\", `/api/users/check-email?email=${encodeURIComponent(candidateData.email)}`);\n      const userExists = checkResponse?.exists;\n      \n      // Only generate password for new users\n      const password = userExists ? null : generatePassword();\n      \n      // Use bulk import endpoint with single candidate\n      const response = await apiRequest(\"POST\", \"/api/candidates/bulk-import\", {\n        candidates: [{\n          email: candidateData.email,\n          firstName: candidateData.firstName,\n          lastName: candidateData.lastName,\n          department: candidateData.department,\n          matricNo: candidateData.matricNo,\n          examId: examId,\n          password: password || undefined, // Don't send password if user exists\n        }]\n      });\n\n      return { response, password, candidateData, userExists };\n    },\n    onSuccess: (data: any) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/exams\", examId, \"candidates\"] });\n      refetchCandidates();\n      \n      // Only add to imported candidates if it's a new user with a password\n      if (data.password && !data.userExists) {\n        const newCandidate = {\n          fullName: `${data.candidateData.firstName} ${data.candidateData.lastName}`,\n          email: data.candidateData.email,\n          department: data.candidateData.department,\n          matricNo: data.candidateData.matricNo,\n          password: data.password,\n        };\n        setImportedCandidates(prev => [...prev, newCandidate]);\n      }\n      \n      setManualCandidateForm({\n        firstName: \"\",\n        lastName: \"\",\n        email: \"\",\n        department: \"\",\n        matricNo: \"\",\n      });\n      \n      // Different toast message for existing vs new users\n      if (data.userExists) {\n        toast({\n          title: \"Candidate Assigned to Exam\",\n          description: `${data.candidateData.email} has been assigned to this exam. They will use their existing password.`,\n          duration: 5000,\n        });\n      } else {\n        toast({\n          title: \"New Candidate Created\",\n          description: `Email: ${data.candidateData.email} | Password: ${data.password}`,\n          duration: 10000,\n        });\n      }\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSettingsSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    updateExamMutation.mutate(formData);\n  };\n\n  const addNewQuestion = () => {\n    setNewQuestions([...newQuestions, {\n      type: \"multiple_choice\",\n      content: \"\",\n      options: [\"\", \"\", \"\", \"\"],\n      correctAnswer: \"\",\n    }]);\n  };\n\n  const removeNewQuestion = (index: number) => {\n    setNewQuestions(newQuestions.filter((_, i) => i !== index));\n  };\n\n  const updateNewQuestion = (index: number, field: keyof QuestionInput, value: any) => {\n    const updated = [...newQuestions];\n    if (field === \"type\") {\n      if (value === \"true_false\") {\n        updated[index] = { \n          ...updated[index], \n          type: value, \n          options: [\"True\", \"False\"],\n          correctAnswer: \"True\"\n        };\n      } else {\n        updated[index] = { \n          ...updated[index], \n          type: value, \n          options: [\"\", \"\", \"\", \"\"],\n          correctAnswer: \"\" \n        };\n      }\n    } else {\n      updated[index] = { ...updated[index], [field]: value };\n    }\n    setNewQuestions(updated);\n  };\n\n  const updateNewQuestionOption = (questionIndex: number, optionIndex: number, value: string) => {\n    const updated = [...newQuestions];\n    updated[questionIndex].options[optionIndex] = value;\n    setNewQuestions(updated);\n  };\n\n  const handleAddQuestionsSubmit = () => {\n    if (!exam || newQuestions.length === 0) return;\n    \n    const questionsData = newQuestions.map(q => ({\n      domainId: exam.domainId,\n      type: q.type,\n      content: q.content,\n      options: q.options.filter(opt => opt.trim() !== \"\"),\n      correctAnswer: q.correctAnswer,\n    }));\n\n    addQuestionsMutation.mutate({ examId: exam.id, questions: questionsData });\n  };\n\n  const handleFileUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file || !exam) return;\n\n    const isExcel = file.name.endsWith('.xlsx') || file.name.endsWith('.xls');\n    \n    const processData = async (rows: any[]) => {\n      const candidatesData = rows.map((row: any) => {\n        const fullName = row['FULL NAME'] || row['Full Name'] || row['full name'] || '';\n        const nameParts = fullName.trim().split(/\\s+/);\n        const firstName = nameParts[0] || '';\n        const lastName = nameParts.slice(1).join(' ') || '';\n        const password = generatePassword();\n\n        return {\n          email: row['EMAIL'] || row['Email'] || row['email'] || '',\n          firstName,\n          lastName,\n          fullName,\n          department: row['DEPT'] || row['Dept'] || row['dept'] || '',\n          matricNo: row['MATRIC NO'] || row['Matric No'] || row['matric no'] || '',\n          examId: exam.id,\n          password,\n        };\n      }).filter(c => c.email); // Filter out rows without email\n\n      if (candidatesData.length === 0) {\n        toast({\n          title: \"Error\",\n          description: \"No valid candidates found in file\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n\n      try {\n        const response = await apiRequest(\"POST\", \"/api/candidates/bulk-import\", {\n          candidates: candidatesData,\n        });\n\n        setImportResults(response);\n        setImportedCandidates(candidatesData);\n        \n        toast({\n          title: \"Import Complete\",\n          description: `Successfully imported ${response.successful} candidates`,\n        });\n      } catch (error: any) {\n        toast({\n          title: \"Import Failed\",\n          description: error.message || \"Failed to import candidates\",\n          variant: \"destructive\",\n        });\n      }\n    };\n\n    if (isExcel) {\n      // Handle Excel files\n      const reader = new FileReader();\n      reader.onload = (evt) => {\n        const data = evt.target?.result;\n        const workbook = XLSX.read(data, { type: 'binary' });\n        const sheetName = workbook.SheetNames[0];\n        const worksheet = workbook.Sheets[sheetName];\n        const jsonData = XLSX.utils.sheet_to_json(worksheet);\n        processData(jsonData);\n      };\n      reader.readAsBinaryString(file);\n    } else {\n      // Handle CSV files\n      Papa.parse(file, {\n        header: true,\n        skipEmptyLines: true,\n        complete: async (results) => {\n          processData(results.data);\n        },\n        error: (error) => {\n          toast({\n            title: \"Parse Error\",\n            description: error.message || \"Failed to parse CSV file\",\n            variant: \"destructive\",\n          });\n        },\n      });\n    }\n  };\n\n  const handleDownloadCredentials = () => {\n    if (importedCandidates.length === 0) return;\n\n    const csvContent = Papa.unparse(importedCandidates.map(c => ({\n      'Full Name': c.fullName,\n      'Email': c.email,\n      'Department': c.department,\n      'Matric No': c.matricNo,\n      'Password': c.password,\n    })));\n\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `${exam?.title || 'exam'}-credentials.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  const handleExportResultsCSV = () => {\n    if (!examCandidates) return;\n    \n    const completedCandidates = examCandidates.filter(\n      c => c.status === \"completed\" || c.status === \"auto_submitted\"\n    );\n    \n    if (completedCandidates.length === 0) return;\n\n    const csvData = completedCandidates.map(c => ({\n      'Name': `${c.user?.firstName || ''} ${c.user?.lastName || ''}`.trim(),\n      'Email': c.user?.email || '',\n      'Department': c.user?.department || '-',\n      'Matric No': c.user?.matricNo || '-',\n      'Score': c.score !== null && c.score !== undefined ? `${c.score}%` : 'N/A',\n      'Status': c.status === 'auto_submitted' ? 'Auto-Submitted' : 'Completed',\n      'Completed At': c.completedAt ? new Date(c.completedAt).toLocaleString() : '-',\n    }));\n\n    const csvContent = Papa.unparse(csvData);\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `${exam?.title || 'exam'}-results.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n    \n    toast({\n      title: \"Export Successful\",\n      description: \"Results exported to CSV successfully\",\n    });\n  };\n\n  const handleExportResultsPDF = () => {\n    if (!examCandidates || !exam) return;\n    \n    const completedCandidates = examCandidates.filter(\n      c => c.status === \"completed\" || c.status === \"auto_submitted\"\n    );\n    \n    if (completedCandidates.length === 0) return;\n\n    const doc = new jsPDF();\n    \n    // Add title\n    doc.setFontSize(18);\n    doc.text(`Exam Results: ${exam.title}`, 14, 20);\n    \n    // Add exam info\n    doc.setFontSize(10);\n    doc.text(`Generated on: ${new Date().toLocaleString()}`, 14, 30);\n    doc.text(`Total Candidates: ${completedCandidates.length}`, 14, 36);\n    \n    // Prepare table data\n    const tableData = completedCandidates.map(c => [\n      `${c.user?.firstName || ''} ${c.user?.lastName || ''}`.trim(),\n      c.user?.email || '',\n      c.user?.department || '-',\n      c.user?.matricNo || '-',\n      c.score !== null && c.score !== undefined ? `${c.score}%` : 'N/A',\n      c.status === 'auto_submitted' ? 'Auto-Submitted' : 'Completed',\n      c.completedAt ? new Date(c.completedAt).toLocaleString() : '-',\n    ]);\n    \n    // Add table\n    (doc as any).autoTable({\n      head: [['Name', 'Email', 'Department', 'Matric No', 'Score', 'Status', 'Completed At']],\n      body: tableData,\n      startY: 45,\n      styles: { fontSize: 8 },\n      headStyles: { fillColor: [66, 139, 202] },\n      alternateRowStyles: { fillColor: [245, 245, 245] },\n      margin: { top: 45 },\n    });\n    \n    // Save PDF\n    doc.save(`${exam.title || 'exam'}-results.pdf`);\n    \n    toast({\n      title: \"Export Successful\",\n      description: \"Results exported to PDF successfully\",\n    });\n  };\n\n  const handleExportLogs = async () => {\n    if (!examId) return;\n\n    try {\n      const response = await fetch(`/api/monitoring/logs/export?examId=${examId}`);\n      \n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ message: 'Unknown error' }));\n        throw new Error(errorData.message || 'Failed to export logs');\n      }\n\n      const logsData: ProctorLogWithDetails[] = await response.json();\n\n      if (!Array.isArray(logsData) || logsData.length === 0) {\n        toast({\n          title: \"No Logs\",\n          description: \"There are no proctoring logs to export for this exam\",\n        });\n        return;\n      }\n\n      const csvData = logsData.map(log => ({\n        'Timestamp': log.timestamp ? new Date(log.timestamp).toLocaleString() : 'N/A',\n        'Candidate Name': log.candidate?.user?.firstName && log.candidate?.user?.lastName\n          ? `${log.candidate.user.firstName} ${log.candidate.user.lastName}`\n          : 'Unknown',\n        'Email': log.candidate?.user?.email || 'Unknown',\n        'Event Type': log.eventType ? log.eventType.replace(\"_\", \" \").replace(/\\b\\w/g, l => l.toUpperCase()) : 'Unknown',\n        'Severity': log.severity || 'N/A',\n        'Metadata': log.metadata ? JSON.stringify(log.metadata) : '-',\n      }));\n\n      const csvContent = Papa.unparse(csvData);\n      const blob = new Blob([csvContent], { type: 'text/csv' });\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `${exam?.title || 'exam'}-proctoring-logs.csv`;\n      a.click();\n      window.URL.revokeObjectURL(url);\n\n      toast({\n        title: \"Export Successful\",\n        description: `Exported ${logsData.length} proctoring log(s) to CSV`,\n      });\n    } catch (error) {\n      console.error('Error exporting logs:', error);\n      toast({\n        title: \"Export Failed\",\n        description: error instanceof Error ? error.message : \"Failed to export proctoring logs\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleDocumentUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Validate file type\n    const allowedTypes = [\n      'application/pdf',\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n      'application/msword',\n      'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n      'application/vnd.ms-powerpoint'\n    ];\n    \n    if (!allowedTypes.includes(file.type)) {\n      toast({\n        title: \"Invalid File\",\n        description: \"Please upload a PDF, Word, or PowerPoint document\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsUploadingDoc(true);\n    try {\n      const formData = new FormData();\n      formData.append('document', file);\n\n      const response = await fetch('/api/ai/extract-document', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to extract document text');\n      }\n\n      const data = await response.json();\n      setDocumentContent(data.text);\n      setUploadedDocName(file.name);\n      \n      toast({\n        title: \"Document Uploaded\",\n        description: `Successfully extracted text from ${file.name}`,\n      });\n    } catch (error) {\n      toast({\n        title: \"Upload Failed\",\n        description: error instanceof Error ? error.message : \"Failed to upload document\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsUploadingDoc(false);\n    }\n  };\n\n  const clearDocument = () => {\n    setDocumentContent(\"\");\n    setUploadedDocName(\"\");\n  };\n\n  if (!examId || examLoading) {\n    return (\n      <div className=\"p-6\">\n        <Skeleton className=\"h-8 w-64 mb-6\" />\n        <Skeleton className=\"h-96\" />\n      </div>\n    );\n  }\n\n  if (!exam) {\n    return (\n      <div className=\"p-6\">\n        <p className=\"text-destructive\">Exam not found</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center gap-4\">\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={() => setLocation(\"/exams\")}\n          data-testid=\"button-back-to-exams\"\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n        </Button>\n        <div className=\"flex-1\">\n          <h1 className=\"text-3xl font-semibold\" data-testid=\"text-exam-title\">\n            {exam.title}\n          </h1>\n          <p className=\"text-muted-foreground\">Manage exam settings, questions, and candidates</p>\n        </div>\n        <Badge variant={exam.status === \"active\" ? \"default\" : \"secondary\"} data-testid=\"badge-exam-status\">\n          {exam.status}\n        </Badge>\n      </div>\n\n      <Tabs defaultValue=\"settings\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-6\">\n          <TabsTrigger value=\"settings\" data-testid=\"tab-settings\">Settings</TabsTrigger>\n          <TabsTrigger value=\"questions\" data-testid=\"tab-questions\">Questions</TabsTrigger>\n          <TabsTrigger value=\"candidates\" data-testid=\"tab-candidates\">Candidates</TabsTrigger>\n          <TabsTrigger value=\"results\" data-testid=\"tab-results\">Results</TabsTrigger>\n          <TabsTrigger value=\"monitoring\" data-testid=\"tab-monitoring\">Live Monitoring</TabsTrigger>\n          <TabsTrigger value=\"logs\" data-testid=\"tab-logs\">Logs</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"settings\" className=\"space-y-4\">\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">Exam Settings</h3>\n            <form onSubmit={handleSettingsSubmit} className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"title\">Exam Title *</Label>\n                <Input\n                  id=\"title\"\n                  value={formData.title}\n                  onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                  required\n                  data-testid=\"input-exam-title\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"description\">Description</Label>\n                <Textarea\n                  id=\"description\"\n                  value={formData.description}\n                  onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                  rows={3}\n                  data-testid=\"input-exam-description\"\n                />\n              </div>\n\n              <div className=\"grid gap-4 md:grid-cols-2\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"domainId\">Domain *</Label>\n                  <Select \n                    value={formData.domainId.toString()} \n                    onValueChange={(value) => setFormData({ ...formData, domainId: parseInt(value) })}\n                  >\n                    <SelectTrigger data-testid=\"select-domain\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {domains?.map((domain) => (\n                        <SelectItem key={domain.id} value={domain.id.toString()}>\n                          {domain.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"duration\">Duration (minutes) *</Label>\n                  <Input\n                    id=\"duration\"\n                    type=\"number\"\n                    min=\"1\"\n                    value={formData.duration}\n                    onChange={(e) => setFormData({ ...formData, duration: parseInt(e.target.value) || 0 })}\n                    required\n                    data-testid=\"input-duration\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"grid gap-4 md:grid-cols-3\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"questionCount\">Number of Questions *</Label>\n                  <Input\n                    id=\"questionCount\"\n                    type=\"number\"\n                    min=\"1\"\n                    value={formData.questionCount}\n                    onChange={(e) => setFormData({ ...formData, questionCount: parseInt(e.target.value) || 0 })}\n                    required\n                    data-testid=\"input-question-count\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"showResults\">Result Visibility *</Label>\n                  <Select \n                    value={formData.showResults} \n                    onValueChange={(value: any) => setFormData({ ...formData, showResults: value })}\n                  >\n                    <SelectTrigger data-testid=\"select-show-results\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"immediate\">Immediate</SelectItem>\n                      <SelectItem value=\"delayed\">Delayed</SelectItem>\n                      <SelectItem value=\"hidden\">Hidden</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"status\">Status *</Label>\n                  <Select \n                    value={formData.status} \n                    onValueChange={(value: any) => setFormData({ ...formData, status: value })}\n                  >\n                    <SelectTrigger data-testid=\"select-status\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"draft\">Draft</SelectItem>\n                      <SelectItem value=\"active\">Active</SelectItem>\n                      <SelectItem value=\"inactive\">Archived</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              <div className=\"space-y-4 pt-4 border-t\">\n                <h4 className=\"font-medium\">Proctoring Settings</h4>\n                \n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-0.5\">\n                    <Label htmlFor=\"enableWebcam\">Webcam Monitoring</Label>\n                    <p className=\"text-sm text-muted-foreground\">\n                      Enable face detection and presence monitoring\n                    </p>\n                  </div>\n                  <Switch \n                    id=\"enableWebcam\" \n                    checked={formData.enableWebcam}\n                    onCheckedChange={(checked) => setFormData({ ...formData, enableWebcam: checked })}\n                    data-testid=\"switch-webcam\" \n                  />\n                </div>\n\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"space-y-0.5\">\n                    <Label htmlFor=\"enableTabDetection\">Tab Switch Detection</Label>\n                    <p className=\"text-sm text-muted-foreground\">\n                      Monitor and log when candidates switch tabs\n                    </p>\n                  </div>\n                  <Switch \n                    id=\"enableTabDetection\" \n                    checked={formData.enableTabDetection}\n                    onCheckedChange={(checked) => setFormData({ ...formData, enableTabDetection: checked })}\n                    data-testid=\"switch-tab-detection\" \n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4\">\n                <Button type=\"submit\" disabled={updateExamMutation.isPending} data-testid=\"button-save-settings\">\n                  <Save className=\"h-4 w-4 mr-2\" />\n                  {updateExamMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n                </Button>\n              </div>\n            </form>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"questions\" className=\"space-y-4\">\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">Exam Questions</h3>\n            \n            <div className=\"space-y-4 pb-4 border-b\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"space-y-0.5\">\n                  <Label htmlFor=\"useAI\">Generate Questions with AI</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Use AI to automatically generate exam questions\n                  </p>\n                </div>\n                <Switch \n                  id=\"useAI\" \n                  checked={useAI}\n                  onCheckedChange={setUseAI}\n                  data-testid=\"switch-use-ai-questions\" \n                />\n              </div>\n\n              {useAI && (\n                <div className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"aiQuestionCount\">Number of AI Questions</Label>\n                    <Input\n                      id=\"aiQuestionCount\"\n                      type=\"number\"\n                      min=\"1\"\n                      max=\"50\"\n                      value={aiQuestionCount}\n                      onChange={(e) => setAiQuestionCount(parseInt(e.target.value) || 5)}\n                      placeholder=\"5\"\n                      data-testid=\"input-ai-question-count\"\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"document-manage\">Upload Document (Optional)</Label>\n                    <p className=\"text-sm text-muted-foreground mb-2\">\n                      Upload a PDF, Word, or PowerPoint document to generate questions based on its content\n                    </p>\n                    {!uploadedDocName ? (\n                      <div className=\"flex items-center gap-2\">\n                        <Input\n                          id=\"document-manage\"\n                          type=\"file\"\n                          accept=\".pdf,.doc,.docx,.ppt,.pptx\"\n                          onChange={handleDocumentUpload}\n                          disabled={isUploadingDoc}\n                          data-testid=\"input-document-upload-manage\"\n                        />\n                        {isUploadingDoc && <span className=\"text-sm text-muted-foreground\">Uploading...</span>}\n                      </div>\n                    ) : (\n                      <div className=\"flex items-center gap-2 p-2 border rounded-md bg-muted\">\n                        <FileText className=\"h-4 w-4 text-muted-foreground\" />\n                        <span className=\"text-sm flex-1\">{uploadedDocName}</span>\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={clearDocument}\n                          data-testid=\"button-clear-document-manage\"\n                        >\n                          <X className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    )}\n                    <p className=\"text-sm text-muted-foreground\">\n                      {documentContent \n                        ? \"Questions will be generated from the uploaded document content\" \n                        : \"Without a document, AI will generate questions based on exam title, domain, and description\"}\n                    </p>\n                  </div>\n                  <Button\n                    onClick={() => generateAIQuestionsMutation.mutate()}\n                    disabled={generateAIQuestionsMutation.isPending}\n                    data-testid=\"button-generate-ai-questions\"\n                  >\n                    <Sparkles className=\"h-4 w-4 mr-2\" />\n                    {generateAIQuestionsMutation.isPending ? \"Generating...\" : \"Generate AI Questions\"}\n                  </Button>\n                </div>\n              )}\n            </div>\n\n            <div className=\"flex items-center justify-between my-4\">\n              <h4 className=\"font-medium\">Manual Questions</h4>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={addNewQuestion}\n                data-testid=\"button-add-question\"\n              >\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Add Question\n              </Button>\n            </div>\n\n            {examQuestions && examQuestions.length > 0 ? (\n              <div className=\"space-y-4 mb-6\">\n                <h4 className=\"font-medium text-sm text-muted-foreground\">\n                  Existing Questions ({examQuestions.length})\n                </h4>\n                {examQuestions.map((q, index) => (\n                  <Card key={q.id} className=\"p-4\" data-testid={`existing-question-${index}`}>\n                    <div className=\"space-y-3\">\n                      <div className=\"flex items-start justify-between gap-4\">\n                        <div className=\"flex items-start gap-2 flex-1\">\n                          <Badge variant=\"outline\" className=\"mt-1\">{q.type === \"multiple_choice\" ? \"Multiple Choice\" : \"True/False\"}</Badge>\n                          <p className=\"font-medium flex-1\">{q.content}</p>\n                        </div>\n                        <div className=\"flex gap-2\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"icon\"\n                            onClick={() => setEditingQuestion(q)}\n                            disabled={updateQuestionMutation.isPending || deleteQuestionMutation.isPending}\n                            data-testid={`button-edit-question-${index}`}\n                          >\n                            <Pencil className=\"h-4 w-4\" />\n                          </Button>\n                          <Button\n                            variant=\"outline\"\n                            size=\"icon\"\n                            onClick={() => setDeletingQuestionId(q.id)}\n                            disabled={updateQuestionMutation.isPending || deleteQuestionMutation.isPending}\n                            data-testid={`button-delete-question-${index}`}\n                          >\n                            <Trash2 className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                      \n                      <div className=\"border-t pt-3\">\n                        <p className=\"text-xs text-muted-foreground mb-2 font-medium\">Answer Options:</p>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">\n                          {(q.options as string[]).map((option, oIndex) => (\n                            <div\n                              key={oIndex}\n                              className={`text-sm p-2 rounded-md border ${\n                                option === q.correctAnswer\n                                  ? \"bg-chart-2/10 border-chart-2 text-chart-2 font-medium\"\n                                  : \"bg-muted/30 border-border\"\n                              }`}\n                              data-testid={`existing-option-${index}-${oIndex}`}\n                            >\n                              <span className=\"font-semibold\">{String.fromCharCode(65 + oIndex)}.</span> {option}\n                            </div>\n                          ))}\n                        </div>\n                        <p className=\"text-xs text-muted-foreground mt-2\">\n                           Correct Answer: <span className=\"font-medium text-chart-2\">{q.correctAnswer}</span>\n                        </p>\n                      </div>\n                    </div>\n                  </Card>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-sm text-muted-foreground mb-6\">No questions added yet</p>\n            )}\n\n            {newQuestions.length > 0 && (\n              <div className=\"space-y-4 border-t pt-6\">\n                <h4 className=\"font-medium\">New Questions</h4>\n                {newQuestions.map((question, qIndex) => (\n                  <Card key={qIndex} className=\"p-4\" data-testid={`new-question-${qIndex}`}>\n                    <div className=\"space-y-4\">\n                      <div className=\"flex items-start justify-between\">\n                        <h5 className=\"font-medium\">Question {qIndex + 1}</h5>\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => removeNewQuestion(qIndex)}\n                          data-testid={`button-remove-new-question-${qIndex}`}\n                        >\n                          <X className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n\n                      <div className=\"space-y-2\">\n                        <Label>Question Type</Label>\n                        <Select\n                          value={question.type}\n                          onValueChange={(value) => updateNewQuestion(qIndex, \"type\", value)}\n                        >\n                          <SelectTrigger data-testid={`select-new-question-type-${qIndex}`}>\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"multiple_choice\">Multiple Choice</SelectItem>\n                            <SelectItem value=\"true_false\">True/False</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n\n                      <div className=\"space-y-2\">\n                        <Label>Question Content</Label>\n                        <Textarea\n                          value={question.content}\n                          onChange={(e) => updateNewQuestion(qIndex, \"content\", e.target.value)}\n                          placeholder=\"Enter your question here\"\n                          rows={2}\n                          data-testid={`textarea-new-question-content-${qIndex}`}\n                        />\n                      </div>\n\n                      {question.type === \"multiple_choice\" ? (\n                        <div className=\"space-y-2\">\n                          <Label>Options</Label>\n                          {question.options.map((option, oIndex) => (\n                            <Input\n                              key={oIndex}\n                              value={option}\n                              onChange={(e) => updateNewQuestionOption(qIndex, oIndex, e.target.value)}\n                              placeholder={`Option ${oIndex + 1}`}\n                              data-testid={`input-new-question-option-${qIndex}-${oIndex}`}\n                            />\n                          ))}\n                        </div>\n                      ) : null}\n\n                      <div className=\"space-y-2\">\n                        <Label>Correct Answer</Label>\n                        <Select\n                          value={question.correctAnswer}\n                          onValueChange={(value) => updateNewQuestion(qIndex, \"correctAnswer\", value)}\n                        >\n                          <SelectTrigger data-testid={`select-new-correct-answer-${qIndex}`}>\n                            <SelectValue placeholder=\"Select correct answer\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {question.type === \"true_false\" ? (\n                              <>\n                                <SelectItem value=\"True\">True</SelectItem>\n                                <SelectItem value=\"False\">False</SelectItem>\n                              </>\n                            ) : (\n                              question.options\n                                .filter(opt => opt.trim() !== \"\")\n                                .map((opt, idx) => (\n                                  <SelectItem key={idx} value={opt}>{opt}</SelectItem>\n                                ))\n                            )}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                    </div>\n                  </Card>\n                ))}\n\n                <div className=\"flex justify-end gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setNewQuestions([])}\n                    data-testid=\"button-cancel-new-questions\"\n                  >\n                    Cancel\n                  </Button>\n                  <Button\n                    onClick={handleAddQuestionsSubmit}\n                    disabled={addQuestionsMutation.isPending}\n                    data-testid=\"button-submit-new-questions\"\n                  >\n                    {addQuestionsMutation.isPending ? \"Adding...\" : \"Add Questions\"}\n                  </Button>\n                </div>\n              </div>\n            )}\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"candidates\" className=\"space-y-4\">\n          {/* Manual Candidate Addition */}\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">Add Candidate Manually</h3>\n            <form\n              onSubmit={(e) => {\n                e.preventDefault();\n                addManualCandidateMutation.mutate(manualCandidateForm);\n              }}\n              className=\"space-y-4\"\n            >\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"firstName\">First Name *</Label>\n                  <Input\n                    id=\"firstName\"\n                    value={manualCandidateForm.firstName}\n                    onChange={(e) => setManualCandidateForm({ ...manualCandidateForm, firstName: e.target.value })}\n                    placeholder=\"John\"\n                    required\n                    data-testid=\"input-candidate-firstname\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"lastName\">Last Name *</Label>\n                  <Input\n                    id=\"lastName\"\n                    value={manualCandidateForm.lastName}\n                    onChange={(e) => setManualCandidateForm({ ...manualCandidateForm, lastName: e.target.value })}\n                    placeholder=\"Doe\"\n                    required\n                    data-testid=\"input-candidate-lastname\"\n                  />\n                </div>\n              </div>\n              \n              <div className=\"space-y-2\">\n                <Label htmlFor=\"email\">Email *</Label>\n                <Input\n                  id=\"email\"\n                  type=\"email\"\n                  value={manualCandidateForm.email}\n                  onChange={(e) => setManualCandidateForm({ ...manualCandidateForm, email: e.target.value })}\n                  placeholder=\"john.doe@example.com\"\n                  required\n                  data-testid=\"input-candidate-email\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"department\">Department</Label>\n                  <Input\n                    id=\"department\"\n                    value={manualCandidateForm.department}\n                    onChange={(e) => setManualCandidateForm({ ...manualCandidateForm, department: e.target.value })}\n                    placeholder=\"Computer Science\"\n                    data-testid=\"input-candidate-department\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"matricNo\">Matric No</Label>\n                  <Input\n                    id=\"matricNo\"\n                    value={manualCandidateForm.matricNo}\n                    onChange={(e) => setManualCandidateForm({ ...manualCandidateForm, matricNo: e.target.value })}\n                    placeholder=\"CS/2024/001\"\n                    data-testid=\"input-candidate-matricno\"\n                  />\n                </div>\n              </div>\n\n              <Button\n                type=\"submit\"\n                disabled={addManualCandidateMutation.isPending}\n                data-testid=\"button-add-candidate\"\n              >\n                <Plus className=\"h-4 w-4 mr-2\" />\n                {addManualCandidateMutation.isPending ? \"Adding...\" : \"Add Candidate\"}\n              </Button>\n            </form>\n          </Card>\n\n          {/* Bulk Import */}\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">Import Candidates (Bulk)</h3>\n            <div className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"csv-upload\">Upload CSV or Excel File</Label>\n                <Input\n                  id=\"csv-upload\"\n                  type=\"file\"\n                  accept=\".csv,.xlsx,.xls\"\n                  onChange={handleFileUpload}\n                  data-testid=\"input-csv-upload\"\n                />\n                <p className=\"text-sm text-muted-foreground\">\n                  File should have columns: FULL NAME, EMAIL, DEPT, MATRIC NO\n                </p>\n              </div>\n              \n              {importResults && (\n                <div className=\"space-y-2 p-4 bg-muted rounded-lg\">\n                  <h4 className=\"font-medium\">Import Results</h4>\n                  <p className=\"text-sm\">\n                     Successfully imported: <span className=\"font-semibold\">{importResults.successful}</span>\n                  </p>\n                  {importResults.failed > 0 && (\n                    <p className=\"text-sm text-destructive\">\n                       Failed: <span className=\"font-semibold\">{importResults.failed}</span>\n                    </p>\n                  )}\n                  {importResults.errors.length > 0 && (\n                    <div className=\"space-y-1 mt-2\">\n                      <p className=\"text-sm font-medium\">Errors:</p>\n                      {importResults.errors.map((error: string, idx: number) => (\n                        <p key={idx} className=\"text-sm text-destructive\"> {error}</p>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )}\n              \n              {importedCandidates.length > 0 && (\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-medium\">Successfully Imported Candidates ({importedCandidates.length})</h4>\n                  <div className=\"border rounded-lg overflow-hidden\">\n                    <table className=\"w-full\">\n                      <thead className=\"bg-muted\">\n                        <tr>\n                          <th className=\"px-4 py-2 text-left text-sm font-medium\">Full Name</th>\n                          <th className=\"px-4 py-2 text-left text-sm font-medium\">Email</th>\n                          <th className=\"px-4 py-2 text-left text-sm font-medium\">Department</th>\n                          <th className=\"px-4 py-2 text-left text-sm font-medium\">Matric No</th>\n                          <th className=\"px-4 py-2 text-left text-sm font-medium\">Password</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        {importedCandidates.map((candidate: any, idx: number) => (\n                          <tr key={idx} className=\"border-t\" data-testid={`imported-candidate-${idx}`}>\n                            <td className=\"px-4 py-2 text-sm\">{candidate.fullName}</td>\n                            <td className=\"px-4 py-2 text-sm\">{candidate.email}</td>\n                            <td className=\"px-4 py-2 text-sm\">{candidate.department}</td>\n                            <td className=\"px-4 py-2 text-sm\">{candidate.matricNo}</td>\n                            <td className=\"px-4 py-2 text-sm font-mono\">{candidate.password}</td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                  <Button\n                    variant=\"outline\"\n                    onClick={handleDownloadCredentials}\n                    data-testid=\"button-download-credentials\"\n                  >\n                    <Download className=\"h-4 w-4 mr-2\" />\n                    Download Credentials\n                  </Button>\n                </div>\n              )}\n            </div>\n          </Card>\n\n          {/* Existing Candidates for this Exam */}\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">\n              Enrolled Candidates ({examCandidates?.length || 0})\n            </h3>\n            {examCandidates && examCandidates.length > 0 ? (\n              <div className=\"border rounded-lg overflow-hidden\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-muted\">\n                    <tr>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Name</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Email</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Department</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Matric No</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Status</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {examCandidates.map((candidate: any, idx: number) => (\n                      <tr key={candidate.id} className=\"border-t\" data-testid={`enrolled-candidate-${idx}`}>\n                        <td className=\"px-4 py-2 text-sm\">\n                          {candidate.user?.firstName} {candidate.user?.lastName}\n                        </td>\n                        <td className=\"px-4 py-2 text-sm\">{candidate.user?.email}</td>\n                        <td className=\"px-4 py-2 text-sm\">{candidate.user?.department || \"-\"}</td>\n                        <td className=\"px-4 py-2 text-sm\">{candidate.user?.matricNo || \"-\"}</td>\n                        <td className=\"px-4 py-2 text-sm\">\n                          <Badge variant={\n                            candidate.status === \"completed\" ? \"default\" :\n                            candidate.status === \"in_progress\" ? \"secondary\" : \"outline\"\n                          }>\n                            {candidate.status}\n                          </Badge>\n                        </td>\n                        <td className=\"px-4 py-2 text-sm\">\n                          <div className=\"flex gap-2\">\n                            <Button\n                              size=\"sm\"\n                              variant=\"outline\"\n                              onClick={() => resetPasswordMutation.mutate({ \n                                userId: candidate.user?.id, \n                                candidateId: candidate.id \n                              })}\n                              disabled={resetPasswordMutation.isPending}\n                              data-testid={`button-reset-password-${idx}`}\n                            >\n                              Reset Password\n                            </Button>\n                            {candidate.status === \"completed\" && (\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                onClick={() => allowRetakeMutation.mutate(candidate.id)}\n                                disabled={allowRetakeMutation.isPending}\n                                data-testid={`button-allow-retake-${idx}`}\n                              >\n                                Allow Retake\n                              </Button>\n                            )}\n                            <Button\n                              size=\"sm\"\n                              variant=\"outline\"\n                              onClick={() => setCandidateToDelete(candidate.id)}\n                              data-testid={`button-delete-candidate-${idx}`}\n                            >\n                              <Trash2 className=\"h-4 w-4\" />\n                            </Button>\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            ) : (\n              <p className=\"text-sm text-muted-foreground\">No candidates enrolled yet</p>\n            )}\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"results\" className=\"space-y-4\">\n          <Card className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg font-semibold\">Exam Results</h3>\n              {examCandidates && examCandidates.filter(c => c.status === \"completed\" || c.status === \"auto_submitted\").length > 0 && (\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={handleExportResultsCSV}\n                    data-testid=\"button-export-csv\"\n                  >\n                    <Download className=\"h-4 w-4 mr-2\" />\n                    Export CSV\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={handleExportResultsPDF}\n                    data-testid=\"button-export-pdf\"\n                  >\n                    <Download className=\"h-4 w-4 mr-2\" />\n                    Export PDF\n                  </Button>\n                </div>\n              )}\n            </div>\n            \n            {examCandidates && examCandidates.filter(c => c.status === \"completed\" || c.status === \"auto_submitted\").length > 0 ? (\n              <div className=\"border rounded-lg overflow-hidden\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-muted\">\n                    <tr>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Name</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Email</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Department</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Matric No</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Score</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Status</th>\n                      <th className=\"px-4 py-2 text-left text-sm font-medium\">Completed At</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {examCandidates\n                      .filter(c => c.status === \"completed\" || c.status === \"auto_submitted\")\n                      .map((candidate: any, idx: number) => (\n                        <tr key={candidate.id} className=\"border-t\" data-testid={`result-row-${idx}`}>\n                          <td className=\"px-4 py-2 text-sm\">\n                            {candidate.user?.firstName} {candidate.user?.lastName}\n                          </td>\n                          <td className=\"px-4 py-2 text-sm\">{candidate.user?.email}</td>\n                          <td className=\"px-4 py-2 text-sm\">{candidate.user?.department || \"-\"}</td>\n                          <td className=\"px-4 py-2 text-sm\">{candidate.user?.matricNo || \"-\"}</td>\n                          <td className=\"px-4 py-2 text-sm\">\n                            <Badge variant={\n                              candidate.score !== null && candidate.score !== undefined && candidate.score >= 70 ? \"default\" : \"destructive\"\n                            }>\n                              {candidate.score !== null && candidate.score !== undefined ? `${candidate.score}%` : \"N/A\"}\n                            </Badge>\n                          </td>\n                          <td className=\"px-4 py-2 text-sm\">\n                            <Badge variant={\n                              candidate.status === \"completed\" ? \"default\" : \"secondary\"\n                            }>\n                              {candidate.status === \"auto_submitted\" ? \"Auto-Submitted\" : \"Completed\"}\n                            </Badge>\n                          </td>\n                          <td className=\"px-4 py-2 text-sm\">\n                            {candidate.completedAt \n                              ? new Date(candidate.completedAt).toLocaleString()\n                              : \"-\"\n                            }\n                          </td>\n                        </tr>\n                      ))}\n                  </tbody>\n                </table>\n              </div>\n            ) : (\n              <p className=\"text-sm text-muted-foreground\">\n                No completed exams yet\n              </p>\n            )}\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"monitoring\" className=\"space-y-4\">\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">Active Exam Sessions</h3>\n            {sessionsLoading ? (\n              <div className=\"grid gap-4 md:grid-cols-2\">\n                {[1, 2].map((i) => (\n                  <Skeleton key={i} className=\"h-48\" />\n                ))}\n              </div>\n            ) : activeSessions && activeSessions.length > 0 ? (\n              <div className=\"grid gap-4 md:grid-cols-2\">\n                {activeSessions.map((session: any) => {\n                  const user = session.user;\n                  const initials = user?.firstName && user?.lastName \n                    ? `${user.firstName[0]}${user.lastName[0]}`.toUpperCase()\n                    : user?.email?.[0]?.toUpperCase() || \"U\";\n\n                  return (\n                    <div\n                      key={session.id}\n                      className=\"p-4 rounded-lg border border-border bg-card\"\n                      data-testid={`session-${session.id}`}\n                    >\n                      <div className=\"flex items-start gap-3 mb-3\">\n                        <Avatar className=\"h-10 w-10\">\n                          <AvatarImage src={user?.profileImageUrl || undefined} className=\"object-cover\" />\n                          <AvatarFallback>{initials}</AvatarFallback>\n                        </Avatar>\n                        <div className=\"flex-1\">\n                          <p className=\"font-medium text-sm\">\n                            {user?.firstName && user?.lastName \n                              ? `${user.firstName} ${user.lastName}`\n                              : user?.email || \"Unknown\"}\n                          </p>\n                          <p className=\"text-xs text-muted-foreground\">{session.exam?.title}</p>\n                        </div>\n                        <Badge variant=\"outline\" className=\"bg-chart-2/10 text-chart-2\">\n                          <div className=\"h-2 w-2 rounded-full bg-chart-2 mr-1.5 animate-pulse\" />\n                          Live\n                        </Badge>\n                      </div>\n\n                      <div className=\"aspect-video bg-muted rounded-md flex items-center justify-center mb-3 relative overflow-hidden\" data-testid={`camera-feed-${session.id}`}>\n                        {videoFeeds.get(session.id) ? (\n                          <img \n                            src={videoFeeds.get(session.id)} \n                            alt=\"Live camera feed\"\n                            className=\"w-full h-full object-cover\"\n                          />\n                        ) : (\n                          <>\n                            <Camera className=\"h-8 w-8 text-muted-foreground\" />\n                            <span className=\"ml-2 text-sm text-muted-foreground\">Waiting for feed...</span>\n                          </>\n                        )}\n                      </div>\n\n                      <div className=\"flex items-center justify-between text-sm\">\n                        <span className=\"text-muted-foreground\">Time Remaining:</span>\n                        <span className=\"font-medium font-mono\" data-testid={`time-remaining-${session.id}`}>\n                          {session.timeRemaining || \"00:00\"}\n                        </span>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            ) : (\n              <p className=\"text-sm text-muted-foreground text-center py-8\" data-testid=\"text-no-active-sessions\">\n                No active exam sessions\n              </p>\n            )}\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"logs\" className=\"space-y-4\">\n          <Card className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg font-semibold\">Proctoring Events</h3>\n              <Button\n                onClick={handleExportLogs}\n                variant=\"outline\"\n                size=\"sm\"\n                data-testid=\"button-export-logs\"\n              >\n                <Download className=\"h-4 w-4 mr-2\" />\n                Download CSV\n              </Button>\n            </div>\n            {logsLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3, 4].map((i) => (\n                  <Skeleton key={i} className=\"h-20\" />\n                ))}\n              </div>\n            ) : logs && logs.length > 0 ? (\n              <div className=\"space-y-3 max-h-[600px] overflow-y-auto\">\n                {logs.map((log) => {\n                  const EventIcon = getEventIcon(log.eventType);\n                  const user = log.candidate?.user;\n\n                  return (\n                    <div\n                      key={log.id}\n                      className=\"p-3 rounded-lg border border-border\"\n                      data-testid={`log-${log.id}`}\n                    >\n                      <div className=\"flex items-start gap-3\">\n                        <div className={`h-8 w-8 rounded-lg ${getSeverityColor(log.severity)} flex items-center justify-center flex-shrink-0`}>\n                          <EventIcon className=\"h-4 w-4\" />\n                        </div>\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-2 mb-1\">\n                            <Badge variant=\"outline\" className={getSeverityColor(log.severity)}>\n                              {log.severity}\n                            </Badge>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {new Date(log.timestamp).toLocaleTimeString()}\n                            </p>\n                          </div>\n                          <p className=\"text-sm font-medium mb-1\">\n                            {log.eventType.replace(\"_\", \" \").replace(/\\b\\w/g, l => l.toUpperCase())}\n                          </p>\n                          <p className=\"text-xs text-muted-foreground truncate\">\n                            {user?.firstName && user?.lastName \n                              ? `${user.firstName} ${user.lastName}`\n                              : user?.email || \"Unknown User\"}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            ) : (\n              <p className=\"text-sm text-muted-foreground text-center py-8\" data-testid=\"text-no-events\">\n                No proctoring events\n              </p>\n            )}\n          </Card>\n        </TabsContent>\n      </Tabs>\n\n      {/* Edit Question Dialog */}\n      <Dialog open={!!editingQuestion} onOpenChange={(open) => !open && setEditingQuestion(null)}>\n        <DialogContent className=\"max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle>Edit Question</DialogTitle>\n            <DialogDescription>\n              Update the question details below\n            </DialogDescription>\n          </DialogHeader>\n          {editingQuestion && (\n            <div className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label>Question Type</Label>\n                <Select\n                  value={editingQuestion.type}\n                  onValueChange={(value) => setEditingQuestion({ ...editingQuestion, type: value })}\n                >\n                  <SelectTrigger data-testid=\"select-edit-question-type\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"multiple_choice\">Multiple Choice</SelectItem>\n                    <SelectItem value=\"true_false\">True/False</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Question Content</Label>\n                <Textarea\n                  value={editingQuestion.content}\n                  onChange={(e) => setEditingQuestion({ ...editingQuestion, content: e.target.value })}\n                  placeholder=\"Enter question text\"\n                  data-testid=\"input-edit-question-content\"\n                />\n              </div>\n\n              {editingQuestion.type === \"multiple_choice\" && (\n                <div className=\"space-y-2\">\n                  <Label>Options</Label>\n                  {(editingQuestion.options as string[]).map((option, idx) => (\n                    <Input\n                      key={idx}\n                      value={option}\n                      onChange={(e) => {\n                        const newOptions = [...(editingQuestion.options as string[])];\n                        newOptions[idx] = e.target.value;\n                        setEditingQuestion({ ...editingQuestion, options: newOptions });\n                      }}\n                      placeholder={`Option ${String.fromCharCode(65 + idx)}`}\n                      data-testid={`input-edit-option-${idx}`}\n                    />\n                  ))}\n                </div>\n              )}\n\n              <div className=\"space-y-2\">\n                <Label>Correct Answer</Label>\n                <Select\n                  value={editingQuestion.correctAnswer}\n                  onValueChange={(value) => setEditingQuestion({ ...editingQuestion, correctAnswer: value })}\n                >\n                  <SelectTrigger data-testid=\"select-edit-correct-answer\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {editingQuestion.type === \"true_false\" ? (\n                      <>\n                        <SelectItem value=\"True\">True</SelectItem>\n                        <SelectItem value=\"False\">False</SelectItem>\n                      </>\n                    ) : (\n                      (editingQuestion.options as string[])\n                        .filter(opt => opt.trim() !== \"\")\n                        .map((opt, idx) => (\n                          <SelectItem key={idx} value={opt}>{opt}</SelectItem>\n                        ))\n                    )}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"flex justify-end gap-2\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setEditingQuestion(null)}\n                  data-testid=\"button-cancel-edit\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  onClick={() => {\n                    updateQuestionMutation.mutate({\n                      id: editingQuestion.id,\n                      data: {\n                        type: editingQuestion.type,\n                        content: editingQuestion.content,\n                        options: editingQuestion.options,\n                        correctAnswer: editingQuestion.correctAnswer,\n                        domainId: editingQuestion.domainId,\n                      },\n                    });\n                  }}\n                  disabled={updateQuestionMutation.isPending}\n                  data-testid=\"button-save-edit\"\n                >\n                  {updateQuestionMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n                </Button>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Question Confirmation */}\n      <AlertDialog open={!!deletingQuestionId} onOpenChange={(open) => !open && setDeletingQuestionId(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Question</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete this question? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel data-testid=\"button-cancel-delete\">Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => {\n                if (deletingQuestionId) {\n                  deleteQuestionMutation.mutate(deletingQuestionId);\n                }\n              }}\n              data-testid=\"button-confirm-delete\"\n            >\n              {deleteQuestionMutation.isPending ? \"Deleting...\" : \"Delete\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      {/* Delete Candidate Confirmation */}\n      <AlertDialog open={!!candidateToDelete} onOpenChange={(open) => !open && setCandidateToDelete(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Candidate</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete this candidate? This action cannot be undone.\n              All associated responses and proctoring logs will also be deleted.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel data-testid=\"button-cancel-delete-candidate\">Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => {\n                if (candidateToDelete) {\n                  deleteCandidateMutation.mutate(candidateToDelete);\n                }\n              }}\n              data-testid=\"button-confirm-delete-candidate\"\n            >\n              {deleteCandidateMutation.isPending ? \"Deleting...\" : \"Delete\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}\n","size_bytes":79915},"client/src/pages/admin/forgot-password.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Shield, ArrowLeft } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nconst forgotPasswordSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n});\n\ntype ForgotPasswordForm = z.infer<typeof forgotPasswordSchema>;\n\nexport default function ForgotPasswordPage() {\n  const { toast } = useToast();\n\n  const form = useForm<ForgotPasswordForm>({\n    resolver: zodResolver(forgotPasswordSchema),\n    defaultValues: {\n      email: \"\",\n    },\n  });\n\n  const forgotPasswordMutation = useMutation({\n    mutationFn: async (data: ForgotPasswordForm) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/forgot-password\", data);\n      return response;\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"If an account exists, a password reset link has been sent to your email\",\n      });\n      form.reset();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to process request\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ForgotPasswordForm) => {\n    forgotPasswordMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/30\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <Shield className=\"h-6 w-6 text-primary\" />\n            <CardTitle className=\"text-2xl\">Forgot Password</CardTitle>\n          </div>\n          <CardDescription>\n            Enter your email address and we'll send you a password reset link\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"email\"\n                        placeholder=\"admin@example.com\"\n                        {...field}\n                        data-testid=\"input-forgot-password-email\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={forgotPasswordMutation.isPending}\n                data-testid=\"button-send-reset-link\"\n              >\n                {forgotPasswordMutation.isPending ? \"Sending...\" : \"Send Reset Link\"}\n              </Button>\n            </form>\n          </Form>\n          \n          <div className=\"text-center\">\n            <Link href=\"/admin\" className=\"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors\" data-testid=\"link-back-to-login\">\n              <ArrowLeft className=\"h-4 w-4\" />\n              Back to Login\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":3816},"client/src/pages/admin/reset-password.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Shield } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useEffect, useState } from \"react\";\n\nconst resetPasswordSchema = z.object({\n  password: z.string().min(8, \"Password must be at least 8 characters\"),\n  confirmPassword: z.string(),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype ResetPasswordForm = z.infer<typeof resetPasswordSchema>;\n\nexport default function ResetPasswordPage() {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const [token, setToken] = useState<string | null>(null);\n\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const tokenParam = params.get(\"token\");\n    if (!tokenParam) {\n      toast({\n        title: \"Error\",\n        description: \"Invalid or missing reset token\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/admin\");\n    } else {\n      setToken(tokenParam);\n    }\n  }, []);\n\n  const form = useForm<ResetPasswordForm>({\n    resolver: zodResolver(resetPasswordSchema),\n    defaultValues: {\n      password: \"\",\n      confirmPassword: \"\",\n    },\n  });\n\n  const resetPasswordMutation = useMutation({\n    mutationFn: async (data: ResetPasswordForm) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/reset-password\", {\n        token,\n        password: data.password,\n      });\n      return response;\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Password reset successful. You can now log in with your new password.\",\n      });\n      setTimeout(() => {\n        setLocation(\"/admin\");\n      }, 1500);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to reset password\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ResetPasswordForm) => {\n    resetPasswordMutation.mutate(data);\n  };\n\n  if (!token) {\n    return null;\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/30\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <Shield className=\"h-6 w-6 text-primary\" />\n            <CardTitle className=\"text-2xl\">Reset Password</CardTitle>\n          </div>\n          <CardDescription>\n            Enter your new password below\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>New Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"Enter new password\"\n                        {...field}\n                        data-testid=\"input-new-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"confirmPassword\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Confirm Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"Confirm new password\"\n                        {...field}\n                        data-testid=\"input-confirm-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={resetPasswordMutation.isPending}\n                data-testid=\"button-reset-password\"\n              >\n                {resetPasswordMutation.isPending ? \"Resetting...\" : \"Reset Password\"}\n              </Button>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":4922},"client/src/pages/admin/administrators.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Plus, UserCog, Pencil, Trash2 } from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport type { User } from \"@shared/schema\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\nexport default function AdministratorsPage() {\n  const [isCreateOpen, setIsCreateOpen] = useState(false);\n  const [isEditOpen, setIsEditOpen] = useState(false);\n  const [isDeleteOpen, setIsDeleteOpen] = useState(false);\n  const [selectedAdmin, setSelectedAdmin] = useState<User | null>(null);\n  const { toast } = useToast();\n\n  const { data: admins, isLoading } = useQuery<User[]>({\n    queryKey: [\"/api/administrators\"],\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/administrators\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/administrators\"] });\n      setIsCreateOpen(false);\n      toast({\n        title: \"Success\",\n        description: \"Administrator created successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: any }) => {\n      return await apiRequest(\"PUT\", `/api/administrators/${id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/administrators\"] });\n      setIsEditOpen(false);\n      setSelectedAdmin(null);\n      toast({\n        title: \"Success\",\n        description: \"Administrator updated successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"DELETE\", `/api/administrators/${id}`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/administrators\"] });\n      setIsDeleteOpen(false);\n      setSelectedAdmin(null);\n      toast({\n        title: \"Success\",\n        description: \"Administrator deleted successfully\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCreateSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const formData = new FormData(e.currentTarget);\n    \n    const data = {\n      email: formData.get(\"email\") as string,\n      firstName: formData.get(\"firstName\") as string,\n      lastName: formData.get(\"lastName\") as string,\n      password: formData.get(\"password\") as string,\n    };\n\n    createMutation.mutate(data);\n  };\n\n  const handleEditSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    if (!selectedAdmin) return;\n\n    const formData = new FormData(e.currentTarget);\n    \n    const data = {\n      email: formData.get(\"email\") as string,\n      firstName: formData.get(\"firstName\") as string,\n      lastName: formData.get(\"lastName\") as string,\n      password: formData.get(\"password\") as string || undefined,\n    };\n\n    updateMutation.mutate({ id: selectedAdmin.id, data });\n  };\n\n  const handleEdit = (admin: User) => {\n    setSelectedAdmin(admin);\n    setIsEditOpen(true);\n  };\n\n  const handleDelete = (admin: User) => {\n    setSelectedAdmin(admin);\n    setIsDeleteOpen(true);\n  };\n\n  const confirmDelete = () => {\n    if (selectedAdmin) {\n      deleteMutation.mutate(selectedAdmin.id);\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-semibold mb-2\" data-testid=\"text-page-title\">Administrators</h1>\n          <p className=\"text-muted-foreground\" data-testid=\"text-page-description\">\n            Manage administrator accounts and permissions\n          </p>\n        </div>\n        <Button onClick={() => setIsCreateOpen(true)} data-testid=\"button-create-admin\">\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Add Administrator\n        </Button>\n      </div>\n\n      {isLoading ? (\n        <Card className=\"p-6\">\n          <div className=\"space-y-4\">\n            {[1, 2, 3].map((i) => (\n              <Skeleton key={i} className=\"h-16\" />\n            ))}\n          </div>\n        </Card>\n      ) : admins && admins.length > 0 ? (\n        <Card className=\"p-6\">\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>Name</TableHead>\n                <TableHead>Email</TableHead>\n                <TableHead>Created</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {admins.map((admin) => (\n                <TableRow key={admin.id} data-testid={`admin-row-${admin.id}`}>\n                  <TableCell className=\"font-medium\" data-testid={`text-admin-name-${admin.id}`}>\n                    {admin.firstName} {admin.lastName}\n                  </TableCell>\n                  <TableCell data-testid={`text-admin-email-${admin.id}`}>\n                    {admin.email}\n                  </TableCell>\n                  <TableCell data-testid={`text-admin-created-${admin.id}`}>\n                    {admin.createdAt ? new Date(admin.createdAt).toLocaleDateString() : \"N/A\"}\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    <div className=\"flex items-center justify-end gap-2\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleEdit(admin)}\n                        data-testid={`button-edit-admin-${admin.id}`}\n                      >\n                        <Pencil className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleDelete(admin)}\n                        data-testid={`button-delete-admin-${admin.id}`}\n                      >\n                        <Trash2 className=\"h-4 w-4 text-destructive\" />\n                      </Button>\n                    </div>\n                  </TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        </Card>\n      ) : (\n        <Card className=\"p-12\">\n          <div className=\"text-center\">\n            <UserCog className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-semibold mb-2\" data-testid=\"text-no-admins\">No administrators yet</h3>\n            <p className=\"text-sm text-muted-foreground mb-6\">\n              Create administrator accounts to manage the platform\n            </p>\n            <Button onClick={() => setIsCreateOpen(true)} data-testid=\"button-create-first-admin\">\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Create First Administrator\n            </Button>\n          </div>\n        </Card>\n      )}\n\n      {/* Create Administrator Dialog */}\n      <Dialog open={isCreateOpen} onOpenChange={setIsCreateOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Create New Administrator</DialogTitle>\n            <DialogDescription>\n              Add a new administrator account with full access privileges\n            </DialogDescription>\n          </DialogHeader>\n\n          <form onSubmit={handleCreateSubmit} className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"firstName\">First Name *</Label>\n              <Input\n                id=\"firstName\"\n                name=\"firstName\"\n                placeholder=\"John\"\n                required\n                data-testid=\"input-first-name\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"lastName\">Last Name *</Label>\n              <Input\n                id=\"lastName\"\n                name=\"lastName\"\n                placeholder=\"Doe\"\n                required\n                data-testid=\"input-last-name\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"email\">Email *</Label>\n              <Input\n                id=\"email\"\n                name=\"email\"\n                type=\"email\"\n                placeholder=\"admin@example.com\"\n                required\n                data-testid=\"input-email\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Password *</Label>\n              <Input\n                id=\"password\"\n                name=\"password\"\n                type=\"password\"\n                placeholder=\"Minimum 8 characters\"\n                minLength={8}\n                required\n                data-testid=\"input-password\"\n              />\n            </div>\n\n            <DialogFooter>\n              <Button type=\"button\" variant=\"outline\" onClick={() => setIsCreateOpen(false)} data-testid=\"button-cancel\">\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={createMutation.isPending} data-testid=\"button-submit-admin\">\n                {createMutation.isPending ? \"Creating...\" : \"Create Administrator\"}\n              </Button>\n            </DialogFooter>\n          </form>\n        </DialogContent>\n      </Dialog>\n\n      {/* Edit Administrator Dialog */}\n      <Dialog open={isEditOpen} onOpenChange={setIsEditOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Edit Administrator</DialogTitle>\n            <DialogDescription>\n              Update administrator details. Leave password blank to keep current password.\n            </DialogDescription>\n          </DialogHeader>\n\n          <form onSubmit={handleEditSubmit} className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"edit-firstName\">First Name *</Label>\n              <Input\n                id=\"edit-firstName\"\n                name=\"firstName\"\n                defaultValue={selectedAdmin?.firstName || \"\"}\n                placeholder=\"John\"\n                required\n                data-testid=\"input-edit-first-name\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"edit-lastName\">Last Name *</Label>\n              <Input\n                id=\"edit-lastName\"\n                name=\"lastName\"\n                defaultValue={selectedAdmin?.lastName || \"\"}\n                placeholder=\"Doe\"\n                required\n                data-testid=\"input-edit-last-name\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"edit-email\">Email *</Label>\n              <Input\n                id=\"edit-email\"\n                name=\"email\"\n                type=\"email\"\n                defaultValue={selectedAdmin?.email || \"\"}\n                placeholder=\"admin@example.com\"\n                required\n                data-testid=\"input-edit-email\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"edit-password\">New Password (optional)</Label>\n              <Input\n                id=\"edit-password\"\n                name=\"password\"\n                type=\"password\"\n                placeholder=\"Leave blank to keep current password\"\n                minLength={8}\n                data-testid=\"input-edit-password\"\n              />\n            </div>\n\n            <DialogFooter>\n              <Button type=\"button\" variant=\"outline\" onClick={() => setIsEditOpen(false)} data-testid=\"button-cancel-edit\">\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={updateMutation.isPending} data-testid=\"button-submit-edit\">\n                {updateMutation.isPending ? \"Updating...\" : \"Update Administrator\"}\n              </Button>\n            </DialogFooter>\n          </form>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation Dialog */}\n      <AlertDialog open={isDeleteOpen} onOpenChange={setIsDeleteOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Administrator</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete {selectedAdmin?.firstName} {selectedAdmin?.lastName}? \n              This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel data-testid=\"button-cancel-delete\">Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={confirmDelete}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              disabled={deleteMutation.isPending}\n              data-testid=\"button-confirm-delete\"\n            >\n              {deleteMutation.isPending ? \"Deleting...\" : \"Delete\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}\n","size_bytes":14098},"server/document-parser.ts":{"content":"import mammoth from 'mammoth';\nimport { createRequire } from 'module';\nconst require = createRequire(import.meta.url);\nconst pdfParseModule = require('pdf-parse');\n// Handle both default and named exports\nconst pdfParse = pdfParseModule.default || pdfParseModule;\nconst officeParser = require('officeparser');\n\n/**\n * Extract text from PDF buffer\n */\nexport async function extractTextFromPDF(buffer: Buffer): Promise<string> {\n  try {\n    // pdf-parse is invoked as a function with the buffer\n    const result = await pdfParse(buffer);\n    return result.text;\n  } catch (error) {\n    console.error('PDF parsing error:', error);\n    throw new Error('Failed to extract text from PDF');\n  }\n}\n\n/**\n * Extract text from Word document buffer\n */\nexport async function extractTextFromWord(buffer: Buffer): Promise<string> {\n  try {\n    const result = await mammoth.extractRawText({ buffer });\n    return result.value;\n  } catch (error) {\n    console.error('Word document parsing error:', error);\n    throw new Error('Failed to extract text from Word document');\n  }\n}\n\n/**\n * Extract text from PowerPoint buffer\n */\nexport async function extractTextFromPowerPoint(buffer: Buffer): Promise<string> {\n  try {\n    const text = await officeParser.parseOfficeAsync(buffer);\n    return text;\n  } catch (error) {\n    console.error('PowerPoint parsing error:', error);\n    throw new Error('Failed to extract text from PowerPoint');\n  }\n}\n\n/**\n * Extract text from uploaded file based on file type\n */\nexport async function extractTextFromDocument(\n  buffer: Buffer,\n  mimetype: string\n): Promise<string> {\n  if (mimetype === 'application/pdf') {\n    return extractTextFromPDF(buffer);\n  } else if (\n    mimetype === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' ||\n    mimetype === 'application/msword'\n  ) {\n    return extractTextFromWord(buffer);\n  } else if (\n    mimetype === 'application/vnd.openxmlformats-officedocument.presentationml.presentation' ||\n    mimetype === 'application/vnd.ms-powerpoint'\n  ) {\n    return extractTextFromPowerPoint(buffer);\n  } else {\n    throw new Error('Unsupported file type. Please upload a PDF, Word, or PowerPoint document.');\n  }\n}\n","size_bytes":2189},"LOCAL_DEPLOYMENT.md":{"content":"# WokkahCBT - Local Deployment Guide\n\nThis guide will help you set up and run WokkahCBT on your local machine.\n\n## Prerequisites\n\nBefore you begin, ensure you have the following installed:\n\n- **Node.js** (v20.x or higher) - [Download here](https://nodejs.org/)\n- **PostgreSQL** (v12 or higher) - [Download here](https://www.postgresql.org/download/)\n- **npm** (comes with Node.js)\n\n## Quick Start\n\n### 1. Clone the Repository\n\n```bash\ngit clone <your-repository-url>\ncd wokkahcbt\n```\n\n### 2. Install Dependencies\n\n```bash\nnpm install\n```\n\n### 3. Set Up PostgreSQL Database\n\nCreate a new PostgreSQL database:\n\n```bash\n# Login to PostgreSQL\npsql -U postgres\n\n# Create database\nCREATE DATABASE wokkahcbt;\n\n# Create user (optional)\nCREATE USER wokkah_user WITH PASSWORD 'your_password';\nGRANT ALL PRIVILEGES ON DATABASE wokkahcbt TO wokkah_user;\n\n# Exit PostgreSQL\n\\q\n```\n\n### 4. Configure Environment Variables\n\nCopy the example environment file and update it with your settings:\n\n```bash\ncp .env.example .env\n```\n\nEdit `.env` and configure the following variables:\n\n```env\n# Database Configuration\nDATABASE_URL=postgresql://wokkah_user:your_password@localhost:5432/wokkahcbt\n\n# Session Secret (generate a random string)\nSESSION_SECRET=generate-a-random-secret-key-here\n\n# Application URL (for email links)\nAPP_URL=http://localhost:5000\n\n# OpenAI API Key (for AI question generation)\nOPENAI_API_KEY=your-openai-api-key\n\n# SMTP Configuration (optional - for email notifications)\nSMTP_HOST=smtp.example.com\nSMTP_PORT=587\nSMTP_USER=your-email@example.com\nSMTP_PASSWORD=your-smtp-password\nSMTP_FROM_EMAIL=noreply@wokkahcbt.com\n\n# Node Environment\nNODE_ENV=development\n```\n\n**Important Environment Variables:**\n\n- **DATABASE_URL**: Your PostgreSQL connection string\n- **SESSION_SECRET**: A random string for session encryption (use a strong random value)\n- **APP_URL**: Your application URL (used in email links)\n- **OPENAI_API_KEY**: Required for AI question generation from documents\n- **SMTP_\\***: Optional - only needed if you want to send email invitations\n\n### 5. Initialize Database Schema\n\nPush the database schema to your PostgreSQL database:\n\n```bash\nnpm run db:push\n```\n\nThis command uses Drizzle ORM to create all necessary tables.\n\n### 6. Start the Development Server\n\n```bash\nnpm run dev\n```\n\nThe application will be available at: `http://localhost:5000`\n\n## Production Deployment\n\n### 1. Build the Application\n\n```bash\nnpm run build\n```\n\nThis creates optimized production builds in the `dist/` directory.\n\n### 2. Set Production Environment Variables\n\nUpdate your `.env` file or set environment variables:\n\n```env\nNODE_ENV=production\nAPP_URL=https://your-domain.com\nDATABASE_URL=postgresql://user:password@host:5432/dbname\nSESSION_SECRET=your-production-secret\n```\n\n### 3. Start the Production Server\n\n```bash\nnpm start\n```\n\nOr use a process manager like PM2:\n\n```bash\nnpm install -g pm2\npm2 start npm --name \"wokkahcbt\" -- start\n```\n\n## Database Management\n\n### Viewing Database Schema\n\nThe database schema is defined in `shared/schema.ts` using Drizzle ORM.\n\n### Making Schema Changes\n\n1. Edit `shared/schema.ts`\n2. Run `npm run db:push` to apply changes\n\n### Reset Database (Development Only)\n\n```sql\nDROP DATABASE wokkahcbt;\nCREATE DATABASE wokkahcbt;\n```\n\nThen run `npm run db:push` again.\n\n## Email Configuration (Optional)\n\nWokkahCBT can send email notifications for:\n- Candidate invitations\n- Password reset requests\n- Exam notifications\n\nTo enable email functionality:\n\n1. Configure SMTP settings in `.env`\n2. Supported providers: Gmail, SendGrid, Amazon SES, Resend, etc.\n\n**Gmail Example:**\n\n```env\nSMTP_HOST=smtp.gmail.com\nSMTP_PORT=587\nSMTP_USER=your-email@gmail.com\nSMTP_PASSWORD=your-app-password\nSMTP_FROM_EMAIL=noreply@wokkahcbt.com\n```\n\n**Note:** For Gmail, you need to use an [App Password](https://support.google.com/accounts/answer/185833).\n\n## AI Question Generation Setup\n\nTo use AI-powered question generation from PDF/Word/PowerPoint documents:\n\n1. Get an OpenAI API key from [OpenAI Platform](https://platform.openai.com/api-keys)\n2. Add it to your `.env` file:\n\n```env\nOPENAI_API_KEY=sk-...your-key...\n```\n\nSupported document formats:\n- PDF (.pdf)\n- Word (.doc, .docx)\n- PowerPoint (.ppt, .pptx)\n\n## Initial Admin Account\n\nThe first administrator account should be created through the admin registration page:\n\n1. Navigate to `http://localhost:5000/admin`\n2. Click \"Create Admin Account\" (only available when no admins exist)\n3. Fill in your details and create your account\n\n## Troubleshooting\n\n### Database Connection Issues\n\nIf you see \"DATABASE_URL must be set\" error:\n- Ensure `.env` file exists in the project root\n- Verify DATABASE_URL is correctly formatted\n- Test PostgreSQL connection: `psql $DATABASE_URL`\n\n### Port Already in Use\n\nIf port 5000 is in use, you can change it:\n```bash\nPORT=3000 npm run dev\n```\n\n### SMTP/Email Issues\n\nIf emails aren't sending:\n- Check SMTP credentials\n- Verify firewall/network settings\n- Check console logs for error messages\n- In development, email links are printed to console even if SMTP fails\n\n### AI Question Generation Issues\n\nIf AI generation fails:\n- Verify OPENAI_API_KEY is set correctly\n- Check OpenAI API quota/billing\n- Ensure document file size is under 10MB\n\n## File Structure\n\n```\nwokkahcbt/\n client/              # React frontend\n    src/\n server/              # Express backend\n    index.ts        # Server entry point\n    routes.ts       # API routes\n    storage.ts      # Database operations\n    db.ts           # Database connection\n    email.ts        # Email functionality\n    ai.ts           # AI question generation\n shared/              # Shared types/schemas\n    schema.ts       # Database schema (Drizzle)\n .env                 # Environment variables (create from .env.example)\n package.json         # Dependencies\n drizzle.config.ts    # Drizzle ORM config\n```\n\n## Security Considerations\n\n1. **Session Secret**: Use a strong random string in production\n2. **Database Credentials**: Never commit `.env` file to version control\n3. **HTTPS**: Use HTTPS in production (configure reverse proxy like Nginx)\n4. **API Keys**: Keep OpenAI and SMTP credentials secure\n5. **Passwords**: Use strong passwords for PostgreSQL and admin accounts\n\n## Tech Stack\n\n- **Frontend**: React, TypeScript, Tailwind CSS, Shadcn UI\n- **Backend**: Express.js, TypeScript\n- **Database**: PostgreSQL with Drizzle ORM\n- **Authentication**: Password-based with bcrypt + express-session\n- **AI**: OpenAI GPT-4 for question generation\n- **Proctoring**: TensorFlow.js with BlazeFace for face detection\n- **Email**: Nodemailer\n- **Real-time**: WebSockets for live monitoring\n\n## Support\n\nFor issues or questions:\n- Check the main README.md\n- Review replit.md for technical architecture details\n- Check console logs for error messages\n\n## License\n\nMIT License - See LICENSE file for details\n","size_bytes":7013}},"version":2}